(()=>{"use strict";const t="720d2150cf09bfa61e28a5042cd7468f",e="720d2150cf09bfa61e28a5042cd7468f";async function n(t){try{const n=await fetch(`https://api.themoviedb.org/3/movie/${t}?api_key=${e}&language=en-US`,{mode:"cors"}),a=await n.json(),o=a.genres.reduce(((t,e)=>[...t,e.name]),[]);return{mName:a.original_title,summary:a.overview,tagline:a.tagline,popularity:a.popularity,vote_average:a.vote_average,vote_count:a.vote_count,genres:o,video:a.video,runtime:a.runtime,poster_path:a.poster_path,backdrop_path:a.backdrop_path}}catch(t){alert(t)}}async function a(t){try{const n=await fetch(`https://api.themoviedb.org/3/movie/${t}/recommendations?api_key=${e}&language=en-US&page=1`,{mode:"cors"}),a=await n.json(),o={};if(a.results){let t=1;for(let e of a.results){if(o[e.original_title]={mName:e.original_title,id:e.id,poster_path:e.poster_path,backdrop_path:e.backdrop_path},5===t)break;t++}}return o}catch(t){alert(t)}}async function o(t){const n={};try{const o=await fetch(`https://api.themoviedb.org/3/movie/${t}/watch/providers?api_key=${e}`,{mode:"cors"}),r=await o.json();for(const t in r.results){const e=(a=t,new Intl.DisplayNames(["en"],{type:"region"}).of(a));n[e]={stream:[],rent:[],buy:[]};const o=(t,e)=>{t&&t.forEach((t=>{const n={provider_name:t.provider_name,provider_logo_path:t.logo_path};e.push(n)}))};o(r.results[t].flatrate,n[e].stream),o(r.results[t].rent,n[e].rent),o(r.results[t].buy,n[e].buy)}return console.log(n),n}catch(t){alert(t)}var a}async function r(t){try{let a;const o=await fetch(`https://api.themoviedb.org/3/movie/${t}/videos?api_key=${e}`,{mode:"cors"}),r=(await o.json()).results.filter((t=>"Trailer"===t.type));if(0===r.length)return!1;const i=r.filter((t=>{t.official}));return a=0!==i.length?i[0]:r[0],{mName:a.name,key:a.key,site:a.site,type:a.type,lang:(n=a.iso_639_1,new Intl.DisplayNames(["en"],{type:"language"}).of(n))}}catch(t){alert(t)}var n}async function i(t){try{let n=[];const a=await fetch(`https://api.themoviedb.org/3/movie/${t}/reviews?api_key=${e}&language=en-US&page=1`,{mode:"cors"}),o=await a.json();if(console.log(o),0===o.results.length)return!1;let r=1;return o.results.forEach((t=>{n.push({author:t.author,rating:t.author_details.rating,pic_path:t.author_details.avatar_path,content:t.content,url:t.url,last_updated:t.updated_at}),r++})),n.slice(0,5)}catch(t){alert(t)}}const c=async(t,e)=>{const c=document.createElement("section"),s=await u(t,n),d=(await u(t,a),await u(t,o));function l(t){c.appendChild(t)}async function u(t,n,a){return"movie"===e?await n(t):""}await u(t,r),await u(t,i);const p=t=>{const e=document.createElement("div");e.classList.add("intro"),e.appendChild(function(){const t=document.createElement("h1");return t.textContent=s.mName,t.classList.add("title"),t}()),s.tagline&&e.appendChild(function(){const t=document.createElement("p");return t.textContent=s.tagline,t.classList.add("tagline"),t}());const n=function(t=""){const e=document.createElement("img"),n="https://image.tmdb.org/t/p";let a;if(e.classList.add("poster"),s.poster_path)a=s.poster_path;else{if(!s.backdrop_path)return;a=s.backdrop_path}return e.src=t?`${n}/w${t}/${a}`:`${n}/original/${a}`,e.alt="Movie picture poster",e}(t);return n&&e.appendChild(n),e.appendChild(function(){const t=document.createElement("p");return t.textContent=s.summary,t.classList.add("summary"),t}()),e};return{section:c,addToSection:l,drawAll:function(){l(p())},drawIntro:p,drawSubInfos:()=>{const t=document.createElement("div");function e(t,e){const n=document.createElement("div"),a=document.createElement("span"),o=document.createElement("span");return n.classList.add("sub-info"),a.classList.add("category-name"),o.classList.add("category-info"),a.textContent=t,o.textContent=e,[a,o].forEach((t=>n.appendChild(t))),n}return t.classList.add("subinfo-container"),[e("Genres:",s.genres.join(", ")),e("Runtime:",function(t){const e=t/60,n=Math.floor(e),a=60*(e-n);return`${n}h ${Math.round(a)}min`}(s.runtime)),e("Vote Average:",s.vote_average),e("Vote Count:",s.vote_count),e("Popularity:",s.popularity)].forEach((e=>t.appendChild(e))),t},drawProviders:()=>{function t(t,e){const n=document.createElement(t);return n.classList.add(e),n}const e=t("div","provider-container"),n=t("button","country-btn"),a=t("div","house-provider-container");return[n,a].forEach((t=>{e.appendChild(t)})),function(e="Australia"){n.textContent=e;[d[e].stream,d[e].buy,d[e].rent].forEach((e=>{const n=t("div","service-container"),o=t("div","service-name"),r=t("div","provider-service-container");e.forEach((e=>{const n=t("div","provider-service"),a=t("img","provider-img"),o=t("span","provider-name");e.provider_logo_path&&(a.src=`https://image.tmdb.org/t/p/original/${e.provider_logo_path}`,a.alt=`${e.provider_name} picture.`,o.textContent=e.provider_name),[a,o].forEach((t=>{n.appendChild(t)})),r.appendChild(n)})),o.textContent=`${e}`,n.appendChild(o),n.appendChild(r),a.appendChild(n)}))}(),e}}};async function s(e){const n=await async function(e){const n=function(t){return t.split(" ").join("+")}(e);try{const a=await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${t}&language=en-US&query=${n}&page=1`,{mode:"cors"}),o=await a.json();let r={},i=o.results;if(i.length){if(i.length>4)for(let t=0;t<5;t++)r[i[t].id]=i[t].media_type;else for(let t=0;t<i.length;t++)r[i[t].id]=i[t].media_type;return console.log(r),r}return void alert(`No results found for ${e}`)}catch(t){alert(t)}}(e),a=document.querySelector(".main-container");let o=[];for(let t in n)"movie"===n[t]&&o.push([t,n[t]]);async function r(t,e){const n=await c(t,e);return n.addToSection(n.drawIntro("300")),n.addToSection(n.drawSubInfos()),n.addToSection(n.drawProviders()),a.appendChild(n.section),r}o.forEach((async t=>await r(t[0],t[1])))}console.log("Hello World"),async function(){document.querySelector(".search-query").addEventListener("click",(async t=>{t.preventDefault();const e=document.getElementById("input-search").value.split(" ").join("+");e?(document.querySelector(".main-container").innerHTML="",await s(e),document.querySelector(".search-query").value=""):alert("Please enter a valid movie/tv show")}))}(),s("iron man")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFRLEdBQUlBLEVBQVEsS0FXN0QsQ0MxQkEzQixRQUFRQyxJQUFJLGVDREd6RCxpQkFDSW9GLFNBQVMwRSxjQUFjLGlCQUMvQkcsaUJBQWlCLFNBQVNqSyxNQUFPa0ssSUFDMUNBLEVBQUVDLGlCQUNGLE1BQU1iLEVBQ0xsRSxTQUFTZ0YsZUFBZSxnQkFBZ0JDLE1BYzlCZCxNQUFNLEtBQUs3QixLQUFLLEtBWnRCNEIsR0Z1Qk9sRSxTQUFTMEUsY0FBYyxtQkFDL0JRLFVBQVksU0VuQlZsQixFQUFhRSxHQUVuQmxFLFNBQVMwRSxjQUFjLGlCQUFpQk8sTUFBUSxJQU4vQzNJLE1BQU0scUNBTTJDLEdBRXBELENEUUE2SSxHQUNBbkIsRUFBYSxXIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbW92aWVtYXRlLy4vc3JjL2pzL2FwaUZ1bmN0aW9ucy9mZXRjaElkLmpzIiwid2VicGFjazovL21vdmllbWF0ZS8uL3NyYy9qcy9hcGlGdW5jdGlvbnMvZmV0Y2hNb3ZpZUluZm8uanMiLCJ3ZWJwYWNrOi8vbW92aWVtYXRlLy4vc3JjL2pzL0RPTUZ1bmN0aW9ucy9kcmF3U2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9tb3ZpZW1hdGUvLi9zcmMvanMvRE9NRnVuY3Rpb25zL2RyYXdTZWN0aW9ucy5qcyIsIndlYnBhY2s6Ly9tb3ZpZW1hdGUvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vbW92aWVtYXRlLy4vc3JjL2pzL1VJL3N1Ym1pdFNlYXJjaC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBBUElfS0VZID0gXCI3MjBkMjE1MGNmMDliZmE2MWUyOGE1MDQyY2Q3NDY4ZlwiO1xuLypcbkZldGNoZXMgdGhlIGZpcnN0IDUgbW92aWUvc2hvdyBpZHMgYW5kIHJldHVybiBpdCBpbiBhbiBhcnJheS5cbiovXG5hc3luYyBmdW5jdGlvbiBmZXRjaElkcyhuYW1lKSB7XG5cdGNvbnN0IHF1ZXJ5ID0gaW50ZXJwcmV0VG9RdWVyeShuYW1lKTtcblx0dHJ5IHtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuXHRcdFx0YGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvc2VhcmNoL211bHRpP2FwaV9rZXk9JHtBUElfS0VZfSZsYW5ndWFnZT1lbi1VUyZxdWVyeT0ke3F1ZXJ5fSZwYWdlPTFgLFxuXHRcdFx0eyBtb2RlOiBcImNvcnNcIiB9XG5cdFx0KTtcblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXHRcdGxldCBpZHMgPSB7fTtcblx0XHRsZXQgcmVzdWx0ID0gZGF0YS5yZXN1bHRzO1xuXHRcdGlmIChyZXN1bHQubGVuZ3RoKSB7XG5cdFx0XHRpZiAocmVzdWx0Lmxlbmd0aCA+IDQpIHtcblx0XHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCA1OyBpKyspIHtcblx0XHRcdFx0XHRpZHNbcmVzdWx0W2ldLmlkXSA9IHJlc3VsdFtpXS5tZWRpYV90eXBlO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHJlc3VsdC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlkc1tyZXN1bHRbaV0uaWRdID0gcmVzdWx0W2ldLm1lZGlhX3R5cGU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGNvbnNvbGUubG9nKGlkcyk7XG5cdFx0XHRyZXR1cm4gaWRzO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRhbGVydChgTm8gcmVzdWx0cyBmb3VuZCBmb3IgJHtuYW1lfWApO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0YWxlcnQoZXJyKTtcblx0fVxufVxuXG5mdW5jdGlvbiBpbnRlcnByZXRUb1F1ZXJ5KG5hbWUpIHtcblx0cmV0dXJuIG5hbWUuc3BsaXQoXCIgXCIpLmpvaW4oXCIrXCIpO1xufVxuXG5leHBvcnQgeyBmZXRjaElkcyB9O1xuIiwiY29uc3QgQVBJX0tFWSA9IFwiNzIwZDIxNTBjZjA5YmZhNjFlMjhhNTA0MmNkNzQ2OGZcIjtcblxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hNb3ZpZURldGFpbHMobW92aWVfaWQpIHtcblx0dHJ5IHtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuXHRcdFx0YGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvbW92aWUvJHttb3ZpZV9pZH0/YXBpX2tleT0ke0FQSV9LRVl9Jmxhbmd1YWdlPWVuLVVTYCxcblx0XHRcdHsgbW9kZTogXCJjb3JzXCIgfVxuXHRcdCk7XG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuXHRcdGNvbnN0IGdlbnJlcyA9IGRhdGEuZ2VucmVzLnJlZHVjZSgoYWNjLCB2YWwpID0+IFsuLi5hY2MsIHZhbC5uYW1lXSwgW10pO1xuXG5cdFx0Y29uc3QgZ2VuZXJhbEluZm8gPSB7XG5cdFx0XHRtTmFtZTogZGF0YS5vcmlnaW5hbF90aXRsZSxcblx0XHRcdHN1bW1hcnk6IGRhdGEub3ZlcnZpZXcsXG5cdFx0XHR0YWdsaW5lOiBkYXRhLnRhZ2xpbmUsXG5cdFx0XHRwb3B1bGFyaXR5OiBkYXRhLnBvcHVsYXJpdHksXG5cdFx0XHR2b3RlX2F2ZXJhZ2U6IGRhdGEudm90ZV9hdmVyYWdlLFxuXHRcdFx0dm90ZV9jb3VudDogZGF0YS52b3RlX2NvdW50LFxuXHRcdFx0Z2VucmVzOiBnZW5yZXMsXG5cdFx0XHR2aWRlbzogZGF0YS52aWRlbyxcblx0XHRcdHJ1bnRpbWU6IGRhdGEucnVudGltZSxcblx0XHRcdHBvc3Rlcl9wYXRoOiBkYXRhLnBvc3Rlcl9wYXRoLFxuXHRcdFx0YmFja2Ryb3BfcGF0aDogZGF0YS5iYWNrZHJvcF9wYXRoLFxuXHRcdH07XG5cdFx0cmV0dXJuIGdlbmVyYWxJbmZvO1xuXHR9IGNhdGNoIChlcnIpIHtcblx0XHRhbGVydChlcnIpO1xuXHR9XG59XG5cbi8qXG5SZXR1cm5zIGFuIGFycmF5IG9mIHJlY29tbWVuZGVkIG1vdmllcyB3aXRoIHRoZWlyIG5hbWUsIGlkLCBwb3N0ZXJfcGF0aCBhbmRcbmJhY2tkcm9wX3BhdGggcmVjb3JkZWQuIFxuSWYgbm8gbW92aWVzIGFyZSByZWNvbW1lbmRlZCwgcmV0dXJuIG51bGw7XG4qL1xuYXN5bmMgZnVuY3Rpb24gZmV0Y2hNb3ZpZVJlY2Nvcyhtb3ZpZV9pZCkge1xuXHR0cnkge1xuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG5cdFx0XHRgaHR0cHM6Ly9hcGkudGhlbW92aWVkYi5vcmcvMy9tb3ZpZS8ke21vdmllX2lkfS9yZWNvbW1lbmRhdGlvbnM/YXBpX2tleT0ke0FQSV9LRVl9Jmxhbmd1YWdlPWVuLVVTJnBhZ2U9MWAsXG5cdFx0XHR7IG1vZGU6IFwiY29yc1wiIH1cblx0XHQpO1xuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cblx0XHRjb25zdCByZWNNb3ZpZXMgPSB7fTtcblx0XHRpZiAoZGF0YS5yZXN1bHRzKSB7XG5cdFx0XHRsZXQgY291bnQgPSAxO1xuXHRcdFx0Zm9yIChsZXQgbW92aWUgb2YgZGF0YS5yZXN1bHRzKSB7XG5cdFx0XHRcdHJlY01vdmllc1ttb3ZpZS5vcmlnaW5hbF90aXRsZV0gPSB7XG5cdFx0XHRcdFx0bU5hbWU6IG1vdmllLm9yaWdpbmFsX3RpdGxlLFxuXHRcdFx0XHRcdGlkOiBtb3ZpZS5pZCxcblx0XHRcdFx0XHRwb3N0ZXJfcGF0aDogbW92aWUucG9zdGVyX3BhdGgsXG5cdFx0XHRcdFx0YmFja2Ryb3BfcGF0aDogbW92aWUuYmFja2Ryb3BfcGF0aCxcblx0XHRcdFx0fTtcblx0XHRcdFx0aWYgKGNvdW50ID09PSA1KSB7XG5cdFx0XHRcdFx0Ly8gTWF4IDUgbW92aWVzIHRvIGJlIHJlY29tbWVuZGVkXG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdFx0Y291bnQrKztcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHJlY01vdmllcztcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0YWxlcnQoZXJyKTtcblx0fVxufVxuXG4vKlxuUmV0dXJucyBhbiBvYmplY3Qgd2l0aCBjb3VudHJpZXMgYW5kIHRoZSBhdmFpbGFibGUgc3RyZWFtaW5nIHNlcnZpY2VzLCBidXlcbm9yIHJlbnQgaXQgY29tZXMgd2l0aCBFQUNIIGluZGl2aWR1YWwgY291bnRyeS5cbiovXG5hc3luYyBmdW5jdGlvbiBmZXRjaE1vdmllUHJvdmlkZXJzKG1vdmllX2lkKSB7XG5cdGNvbnN0IHByb3ZpZGVyc0J5Q291bnRyeSA9IHt9O1xuXHR0cnkge1xuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG5cdFx0XHRgaHR0cHM6Ly9hcGkudGhlbW92aWVkYi5vcmcvMy9tb3ZpZS8ke21vdmllX2lkfS93YXRjaC9wcm92aWRlcnM/YXBpX2tleT0ke0FQSV9LRVl9YCxcblx0XHRcdHsgbW9kZTogXCJjb3JzXCIgfVxuXHRcdCk7XG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuXHRcdGZvciAoY29uc3QgY291bnRyeUNvZGUgaW4gZGF0YS5yZXN1bHRzKSB7XG5cdFx0XHRjb25zdCBjb3VudHJ5ID0gZ2V0Q291bnRyeU5hbWUoY291bnRyeUNvZGUpO1xuXHRcdFx0cHJvdmlkZXJzQnlDb3VudHJ5W2NvdW50cnldID0ge1xuXHRcdFx0XHRzdHJlYW06IFtdLFxuXHRcdFx0XHRyZW50OiBbXSxcblx0XHRcdFx0YnV5OiBbXSxcblx0XHRcdH07XG5cblx0XHRcdC8qXG5cdFx0XHRTb3J0cyBwcm92aWRlcnMgYmFzZWQgb24gY291bnRyeSBhbmQgc2VydmljZXMgdGhleSBwcm92aWRlLlxuXG5cdFx0XHRUYWtlcyBpbiB0eXBlIG9mIHNlcnZpY2VzIGFzIHBhcmFtID0+IFtcImZsYXRyYXRlIChzdHJlYW1pbmcpXCIsIFxuXHRcdFx0XCJyZW50XCIsIFwiYnV5XCJdIGFuZCBhbiBhcnJheSB0byBhcHBlbmQgaXQgdG8uXG5cdFx0XHQqL1xuXHRcdFx0Y29uc3Qgc29ydFByb3ZpZGVycyA9IChzZXJ2aWNlcywgY29sbGVjdGlvbikgPT4ge1xuXHRcdFx0XHRpZiAoc2VydmljZXMpIHtcblx0XHRcdFx0XHRzZXJ2aWNlcy5mb3JFYWNoKChzZXJ2aWNlKSA9PiB7XG5cdFx0XHRcdFx0XHRjb25zdCBwcm92aWRlckluZm8gPSB7XG5cdFx0XHRcdFx0XHRcdHByb3ZpZGVyX25hbWU6IHNlcnZpY2UucHJvdmlkZXJfbmFtZSxcblx0XHRcdFx0XHRcdFx0cHJvdmlkZXJfbG9nb19wYXRoOiBzZXJ2aWNlLmxvZ29fcGF0aCxcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRjb2xsZWN0aW9uLnB1c2gocHJvdmlkZXJJbmZvKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblxuXHRcdFx0Ly8gQWRkIHN0cmVhbWluZyBzZXJ2aWNlcyBmb3Igc3BlY2lmaWVkIG1vdmllIGluIGVhY2ggY291bnRyeS5cblx0XHRcdHNvcnRQcm92aWRlcnMoXG5cdFx0XHRcdGRhdGEucmVzdWx0c1tjb3VudHJ5Q29kZV0uZmxhdHJhdGUsXG5cdFx0XHRcdHByb3ZpZGVyc0J5Q291bnRyeVtjb3VudHJ5XS5zdHJlYW1cblx0XHRcdCk7XG5cblx0XHRcdC8vIEFkZCByZW50aW5nIHNlcnZpY2VzIGZvciBzcGVpY2lmaWVkIG1vdmllIGluIGVhY2ggY291bnRyeS5cblx0XHRcdHNvcnRQcm92aWRlcnMoXG5cdFx0XHRcdGRhdGEucmVzdWx0c1tjb3VudHJ5Q29kZV0ucmVudCxcblx0XHRcdFx0cHJvdmlkZXJzQnlDb3VudHJ5W2NvdW50cnldLnJlbnRcblx0XHRcdCk7XG5cblx0XHRcdC8vIEFkZCBidXlpbmcgc2VydmljZXMgZm9yIHNwZWNpZmllZCBtb3ZpZSBpbiBlYWNoIGNvdW50cnkuXG5cdFx0XHRzb3J0UHJvdmlkZXJzKFxuXHRcdFx0XHRkYXRhLnJlc3VsdHNbY291bnRyeUNvZGVdLmJ1eSxcblx0XHRcdFx0cHJvdmlkZXJzQnlDb3VudHJ5W2NvdW50cnldLmJ1eVxuXHRcdFx0KTtcblx0XHR9XG5cdFx0Y29uc29sZS5sb2cocHJvdmlkZXJzQnlDb3VudHJ5KVxuXHRcdHJldHVybiBwcm92aWRlcnNCeUNvdW50cnk7XG5cdH0gY2F0Y2ggKGVycikge1xuXHRcdGFsZXJ0KGVycik7XG5cdH1cbn1cblxuLy8gRmluZCBtb3ZpZSB0cmFpbGVyIGFuZCByZXR1cm4gZmFsc2UgaWYgbm9uZSBjYW4gYmUgZm91bmQuXG4vLyBPZmZpY2lhbCB0cmFpbGVyIHdpbGwgYmUgcHJpb3JpdGlzZWQuXG5hc3luYyBmdW5jdGlvbiBmZXRjaE1vdmllVHJhaWxlcihtb3ZpZV9pZCkge1xuXHR0cnkge1xuXHRcdGxldCBtb3ZpZVRyYWlsZXI7XG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcblx0XHRcdGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL21vdmllLyR7bW92aWVfaWR9L3ZpZGVvcz9hcGlfa2V5PSR7QVBJX0tFWX1gLFxuXHRcdFx0eyBtb2RlOiBcImNvcnNcIiB9XG5cdFx0KTtcblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG5cdFx0Y29uc3QgdHJhaWxlcnMgPSBkYXRhLnJlc3VsdHMuZmlsdGVyKCh2aWRlbykgPT4gdmlkZW8udHlwZSA9PT0gXCJUcmFpbGVyXCIpO1xuXG5cdFx0aWYgKHRyYWlsZXJzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuXHRcdC8vIEZpbmQgb2ZmaWNpYWwgdHJhaWxlci5cblx0XHRjb25zdCBvZmZpY2lhbCA9IHRyYWlsZXJzLmZpbHRlcigodmlkZW8pID0+IHtcblx0XHRcdHZpZGVvLm9mZmljaWFsID09PSB0cnVlO1xuXHRcdH0pO1xuXG5cdFx0b2ZmaWNpYWwubGVuZ3RoICE9PSAwXG5cdFx0XHQ/IChtb3ZpZVRyYWlsZXIgPSBvZmZpY2lhbFswXSlcblx0XHRcdDogKG1vdmllVHJhaWxlciA9IHRyYWlsZXJzWzBdKTtcblxuXHRcdHJldHVybiB7XG5cdFx0XHRtTmFtZTogbW92aWVUcmFpbGVyLm5hbWUsXG5cdFx0XHRrZXk6IG1vdmllVHJhaWxlci5rZXksXG5cdFx0XHRzaXRlOiBtb3ZpZVRyYWlsZXIuc2l0ZSxcblx0XHRcdHR5cGU6IG1vdmllVHJhaWxlci50eXBlLFxuXHRcdFx0bGFuZzogZ2V0TGFuZ3VhZ2UobW92aWVUcmFpbGVyLmlzb182MzlfMSksXG5cdFx0fTtcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0YWxlcnQoZXJyKTtcblx0fVxufVxuXG4vLyBSZXR1cm5zIGFuIGFyciBvZiBhIG1heGltdW0gb2YgNSByZXZpZXdzIGJhc2VkIG9uIHRoZSBtb3ZpZSBmcm9tIHJhbmRvbSBzb3VyY2VzLlxuLy8gSWYgbm8gcmV2aWV3cyBhcmUgZm91bmQsIHRoaXMgZm5jIHJldHVybnMgZmFsc2UuXG5hc3luYyBmdW5jdGlvbiBmZXRjaE1vdmllUmV2aWV3cyhtb3ZpZV9pZCkge1xuXHR0cnkge1xuXHRcdGxldCByZXZpZXdzID0gW107XG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcblx0XHRcdGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL21vdmllLyR7bW92aWVfaWR9L3Jldmlld3M/YXBpX2tleT0ke0FQSV9LRVl9Jmxhbmd1YWdlPWVuLVVTJnBhZ2U9MWAsXG5cdFx0XHR7IG1vZGU6IFwiY29yc1wiIH1cblx0XHQpO1xuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0Y29uc29sZS5sb2coZGF0YSk7XG5cdFx0aWYgKGRhdGEucmVzdWx0cy5sZW5ndGggPT09IDApIHJldHVybiBmYWxzZTtcblxuXHRcdGxldCBjb3VudCA9IDE7XG5cdFx0ZGF0YS5yZXN1bHRzLmZvckVhY2goKHJldmlldykgPT4ge1xuXHRcdFx0cmV2aWV3cy5wdXNoKHtcblx0XHRcdFx0YXV0aG9yOiByZXZpZXcuYXV0aG9yLFxuXHRcdFx0XHRyYXRpbmc6IHJldmlldy5hdXRob3JfZGV0YWlscy5yYXRpbmcsXG5cdFx0XHRcdHBpY19wYXRoOiByZXZpZXcuYXV0aG9yX2RldGFpbHMuYXZhdGFyX3BhdGgsXG5cdFx0XHRcdGNvbnRlbnQ6IHJldmlldy5jb250ZW50LFxuXHRcdFx0XHR1cmw6IHJldmlldy51cmwsXG5cdFx0XHRcdGxhc3RfdXBkYXRlZDogcmV2aWV3LnVwZGF0ZWRfYXQsXG5cdFx0XHR9KTtcblx0XHRcdGNvdW50Kys7XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHJldmlld3Muc2xpY2UoMCwgNSk7XG5cdH0gY2F0Y2ggKGVycikge1xuXHRcdGFsZXJ0KGVycik7XG5cdH1cbn1cblxuZnVuY3Rpb24gZ2V0Q291bnRyeU5hbWUoY29kZSkge1xuXHRsZXQgcmVnaW9uTmFtZXMgPSBuZXcgSW50bC5EaXNwbGF5TmFtZXMoW1wiZW5cIl0sIHsgdHlwZTogXCJyZWdpb25cIiB9KTtcblx0cmV0dXJuIHJlZ2lvbk5hbWVzLm9mKGNvZGUpO1xufVxuXG5mdW5jdGlvbiBnZXRMYW5ndWFnZShjb2RlKSB7XG5cdGNvbnN0IGxhbmcgPSBuZXcgSW50bC5EaXNwbGF5TmFtZXMoW1wiZW5cIl0sIHsgdHlwZTogXCJsYW5ndWFnZVwiIH0pO1xuXHRyZXR1cm4gbGFuZy5vZihjb2RlKTtcbn1cbmV4cG9ydCB7XG5cdGZldGNoTW92aWVEZXRhaWxzLFxuXHRmZXRjaE1vdmllUmVjY29zLFxuXHRmZXRjaE1vdmllUHJvdmlkZXJzLFxuXHRmZXRjaE1vdmllVHJhaWxlcixcblx0ZmV0Y2hNb3ZpZVJldmlld3MsXG5cdGdldENvdW50cnlOYW1lLFxufTtcbiIsImltcG9ydCAqIGFzIG1vdmllIGZyb20gXCIuLi9hcGlGdW5jdGlvbnMvZmV0Y2hNb3ZpZUluZm9cIjtcblxuLypcbkRyYXcgYW4gaW5kaXZpZHVhbCBzZWN0aW9uIGJhc2VkIG9uIHVzZXIgaW5wdXQgcXVlcnkuXG5UaGlzIHNlY3Rpb24gd2lsbCBjb25zdHMgb2YgdGhlIG92ZXJhbGwgbW92aWUvdHYncyBcbiAgICAtIERldGFpbHMsXG4gICAgLSBUaGUgd2F0Y2ggcHJvdmlkZXJzIGJhc2VkIG9uIHNwZWNpZmljIGNvdW50cmllc1xuICAgIC0gQXZhaWxhYmxlIHRyYWlsZXJzLFxuICAgIC0gT3RoZXIgcmVjb21tZW5kYXRpb25zLlxuICAgIC0gUmV2aWV3cyBieSBlc3RhYmxpc2hlZCBhdXRob3JzIGJhc2VkIGZyb20gcmFuZG9tIHNvdXJjZXMuXG4qL1xuXG5jb25zdCBkcmF3U2VjdGlvbiA9IGFzeW5jIChpZCwgbWVkaWEpID0+IHtcblx0Y29uc3Qgc2VjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzZWN0aW9uXCIpO1xuXHRjb25zdCBkZXRhaWxzID0gYXdhaXQgZ2V0SW5mbyhpZCwgbW92aWUuZmV0Y2hNb3ZpZURldGFpbHMsIFwiXCIpO1xuXHRjb25zdCByZWNzID0gYXdhaXQgZ2V0SW5mbyhpZCwgbW92aWUuZmV0Y2hNb3ZpZVJlY2NvcywgXCJcIik7XG5cdGNvbnN0IHByb3ZpZGVycyA9IGF3YWl0IGdldEluZm8oaWQsIG1vdmllLmZldGNoTW92aWVQcm92aWRlcnMsIFwiXCIpO1xuXHRjb25zdCB0cmFpbGVyID0gYXdhaXQgZ2V0SW5mbyhpZCwgbW92aWUuZmV0Y2hNb3ZpZVRyYWlsZXIsIFwiXCIpO1xuXHRjb25zdCByZXZpZXdzID0gYXdhaXQgZ2V0SW5mbyhpZCwgbW92aWUuZmV0Y2hNb3ZpZVJldmlld3MsIFwiXCIpO1xuXG5cdGZ1bmN0aW9uIGRyYXdBbGwoKSB7XG5cdFx0YWRkVG9TZWN0aW9uKGRyYXdJbnRybygpKTtcblx0fVxuXG5cdGZ1bmN0aW9uIGFkZFRvU2VjdGlvbihwYXJ0KSB7XG5cdFx0c2VjdGlvbi5hcHBlbmRDaGlsZChwYXJ0KTtcblx0fVxuXG5cdGFzeW5jIGZ1bmN0aW9uIGdldEluZm8oaWQsIG1vdmllRm5jLCB0dkZuYykge1xuXHRcdHJldHVybiBtZWRpYSA9PT0gXCJtb3ZpZVwiID8gYXdhaXQgbW92aWVGbmMoaWQpIDogXCJcIjtcblx0fVxuXG5cdC8vIERyYXcgKGlmIGFueSkgdGl0bGUsIHBob3RvLCB0YWdsaW5lLCBhbmQgc3VtbWFyeS5cblx0Y29uc3QgZHJhd0ludHJvID0gKGltZ1NpemUpID0+IHtcblx0XHRjb25zdCBpbnRyb0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0aW50cm9Db250YWluZXIuY2xhc3NMaXN0LmFkZChcImludHJvXCIpO1xuXG5cdFx0aW50cm9Db250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlVGl0bGUoKSk7XG5cdFx0ZGV0YWlscy50YWdsaW5lID8gaW50cm9Db250YWluZXIuYXBwZW5kQ2hpbGQod3JpdGVUYWdsaW5lKCkpIDogXCJcIjtcblxuXHRcdGNvbnN0IGltZyA9IHJlbmRlckltZyhpbWdTaXplKTtcblx0XHRpbWcgPyBpbnRyb0NvbnRhaW5lci5hcHBlbmRDaGlsZChpbWcpIDogXCJcIjtcblxuXHRcdGludHJvQ29udGFpbmVyLmFwcGVuZENoaWxkKHdyaXRlU3VtbWFyeSgpKTtcblxuXHRcdGZ1bmN0aW9uIGNyZWF0ZVRpdGxlKCkge1xuXHRcdFx0Y29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDFcIik7XG5cdFx0XHR0aXRsZS50ZXh0Q29udGVudCA9IGRldGFpbHMubU5hbWU7XG5cdFx0XHR0aXRsZS5jbGFzc0xpc3QuYWRkKFwidGl0bGVcIik7XG5cdFx0XHRyZXR1cm4gdGl0bGU7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gcmVuZGVySW1nKGltZ1NpemUgPSBcIlwiKSB7XG5cdFx0XHRjb25zdCBwb3N0ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xuXHRcdFx0Y29uc3QgYmFzZUltZ1VybCA9IFwiaHR0cHM6Ly9pbWFnZS50bWRiLm9yZy90L3BcIjtcblx0XHRcdGxldCBpbWdfcGF0aDtcblx0XHRcdHBvc3Rlci5jbGFzc0xpc3QuYWRkKFwicG9zdGVyXCIpO1xuXG5cdFx0XHRpZiAoZGV0YWlscy5wb3N0ZXJfcGF0aCkge1xuXHRcdFx0XHRpbWdfcGF0aCA9IGRldGFpbHMucG9zdGVyX3BhdGg7XG5cdFx0XHR9IGVsc2UgaWYgKGRldGFpbHMuYmFja2Ryb3BfcGF0aCkge1xuXHRcdFx0XHRpbWdfcGF0aCA9IGRldGFpbHMuYmFja2Ryb3BfcGF0aDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdCFpbWdTaXplXG5cdFx0XHRcdD8gKHBvc3Rlci5zcmMgPSBgJHtiYXNlSW1nVXJsfS9vcmlnaW5hbC8ke2ltZ19wYXRofWApXG5cdFx0XHRcdDogKHBvc3Rlci5zcmMgPSBgJHtiYXNlSW1nVXJsfS93JHtpbWdTaXplfS8ke2ltZ19wYXRofWApO1xuXHRcdFx0cG9zdGVyLmFsdCA9IFwiTW92aWUgcGljdHVyZSBwb3N0ZXJcIjtcblx0XHRcdHJldHVybiBwb3N0ZXI7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gd3JpdGVUYWdsaW5lKCkge1xuXHRcdFx0Y29uc3QgdGFnUGFyYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuXHRcdFx0dGFnUGFyYS50ZXh0Q29udGVudCA9IGRldGFpbHMudGFnbGluZTtcblx0XHRcdHRhZ1BhcmEuY2xhc3NMaXN0LmFkZChcInRhZ2xpbmVcIik7XG5cdFx0XHRyZXR1cm4gdGFnUGFyYTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiB3cml0ZVN1bW1hcnkoKSB7XG5cdFx0XHRjb25zdCBwYXJhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XG5cdFx0XHRwYXJhLnRleHRDb250ZW50ID0gZGV0YWlscy5zdW1tYXJ5O1xuXHRcdFx0cGFyYS5jbGFzc0xpc3QuYWRkKFwic3VtbWFyeVwiKTtcblx0XHRcdHJldHVybiBwYXJhO1xuXHRcdH1cblx0XHRyZXR1cm4gaW50cm9Db250YWluZXI7XG5cdH07XG5cblx0Y29uc3QgZHJhd1N1YkluZm9zID0gKCkgPT4ge1xuXHRcdGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJzdWJpbmZvLWNvbnRhaW5lclwiKTtcblxuXHRcdGNvbnN0IGluZm9ybWF0aW9uID0gW1xuXHRcdFx0Y3JlYXRlU3ViSW5mbyhcIkdlbnJlczpcIiwgZGV0YWlscy5nZW5yZXMuam9pbihcIiwgXCIpKSxcblx0XHRcdGNyZWF0ZVN1YkluZm8oXCJSdW50aW1lOlwiLCBjb252ZXJ0TWluVG9IcihkZXRhaWxzLnJ1bnRpbWUpKSxcblx0XHRcdGNyZWF0ZVN1YkluZm8oXCJWb3RlIEF2ZXJhZ2U6XCIsIGRldGFpbHMudm90ZV9hdmVyYWdlKSxcblx0XHRcdGNyZWF0ZVN1YkluZm8oXCJWb3RlIENvdW50OlwiLCBkZXRhaWxzLnZvdGVfY291bnQpLFxuXHRcdFx0Y3JlYXRlU3ViSW5mbyhcIlBvcHVsYXJpdHk6XCIsIGRldGFpbHMucG9wdWxhcml0eSksXG5cdFx0XTtcblxuXHRcdGluZm9ybWF0aW9uLmZvckVhY2goKGluZm8pID0+IGNvbnRhaW5lci5hcHBlbmRDaGlsZChpbmZvKSk7XG5cblx0XHRmdW5jdGlvbiBjcmVhdGVTdWJJbmZvKGNhdGVnb3J5LCBpbmZvKSB7XG5cdFx0XHRjb25zdCBzdWJJbmZvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcdGNvbnN0IGNhdGVnb3J5TmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuXHRcdFx0Y29uc3QgY2F0ZWdvcnlJbmZvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cblx0XHRcdHN1YkluZm8uY2xhc3NMaXN0LmFkZChcInN1Yi1pbmZvXCIpO1xuXHRcdFx0Y2F0ZWdvcnlOYW1lLmNsYXNzTGlzdC5hZGQoXCJjYXRlZ29yeS1uYW1lXCIpO1xuXHRcdFx0Y2F0ZWdvcnlJbmZvLmNsYXNzTGlzdC5hZGQoXCJjYXRlZ29yeS1pbmZvXCIpO1xuXG5cdFx0XHRjYXRlZ29yeU5hbWUudGV4dENvbnRlbnQgPSBjYXRlZ29yeTtcblx0XHRcdGNhdGVnb3J5SW5mby50ZXh0Q29udGVudCA9IGluZm87XG5cblx0XHRcdFtjYXRlZ29yeU5hbWUsIGNhdGVnb3J5SW5mb10uZm9yRWFjaCgoaW5mbykgPT4gc3ViSW5mby5hcHBlbmRDaGlsZChpbmZvKSk7XG5cdFx0XHRyZXR1cm4gc3ViSW5mbztcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBjb252ZXJ0TWluVG9IcihtaW5zKSB7XG5cdFx0XHRjb25zdCBob3VycyA9IG1pbnMgLyA2MDtcblx0XHRcdGNvbnN0IHJIb3VycyA9IE1hdGguZmxvb3IoaG91cnMpO1xuXHRcdFx0Y29uc3QgbWludXRlcyA9IChob3VycyAtIHJIb3VycykgKiA2MDtcblx0XHRcdGNvbnN0IHJNaW51dGVzID0gTWF0aC5yb3VuZChtaW51dGVzKTtcblx0XHRcdHJldHVybiBgJHtySG91cnN9aCAke3JNaW51dGVzfW1pbmA7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNvbnRhaW5lcjtcblx0fTtcblxuXHRjb25zdCBkcmF3UHJvdmlkZXJzID0gKCkgPT4ge1xuXHRcdC8vIEhvdXNlcyB0aGUgYnRuIHRoYXQgb3BlbnMgdGhlIG1vZGFsIGFuZCBvdmVybGF5LCBhbmQgdGhlIGF2YWlsYWJsZSBwcm92aWRlcnMgZm9yICdzdHJlYW1pbmcnLCAncmVudCcgYW5kICdwdXJjaGFzZScuXG5cdFx0ZnVuY3Rpb24gcmVuZGVyRWxlbWVudCh0YWcsIGNsYXNzTmFtZSkge1xuXHRcdFx0Y29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpO1xuXHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcblx0XHRcdHJldHVybiBjb250YWluZXI7XG5cdFx0fVxuXHRcdGNvbnN0IHByb3ZpZGVyQ29udGFpbmVyID0gcmVuZGVyRWxlbWVudChcImRpdlwiLCBcInByb3ZpZGVyLWNvbnRhaW5lclwiKTtcblx0XHRjb25zdCBjb3VudHJ5QnRuID0gcmVuZGVyRWxlbWVudChcImJ1dHRvblwiLCBcImNvdW50cnktYnRuXCIpO1xuXHRcdGNvbnN0IGhvdXNlQ29udGFpbmVyID0gcmVuZGVyRWxlbWVudChcImRpdlwiLCBcImhvdXNlLXByb3ZpZGVyLWNvbnRhaW5lclwiKTtcblx0XHRbY291bnRyeUJ0biwgaG91c2VDb250YWluZXJdLmZvckVhY2goKGVsZW0pID0+IHtcblx0XHRcdHByb3ZpZGVyQ29udGFpbmVyLmFwcGVuZENoaWxkKGVsZW0pO1xuXHRcdH0pO1xuXHRcdGRyYXdQcm92aWRlcigpOyAvLyBEZWZhdWx0IGNvdW50cnkgXCJBdXN0cmFsaWFcIlxuXHRcdHJldHVybiBwcm92aWRlckNvbnRhaW5lcjtcblxuXHRcdGZ1bmN0aW9uIGRyYXdQcm92aWRlcihjb3VudHJ5TmFtZSA9IFwiQXVzdHJhbGlhXCIpIHtcblx0XHRcdC8vIENoYW5nZSB0ZXh0IG9mIGJ0biB0byBjb3VudHJ5TmFtZVxuXHRcdFx0Y291bnRyeUJ0bi50ZXh0Q29udGVudCA9IGNvdW50cnlOYW1lO1xuXG5cdFx0XHRjb25zdCBzdHJlYW1JbmZvID0gcHJvdmlkZXJzW2NvdW50cnlOYW1lXS5zdHJlYW07XG5cdFx0XHRjb25zdCBidXlJbmZvID0gcHJvdmlkZXJzW2NvdW50cnlOYW1lXS5idXk7XG5cdFx0XHRjb25zdCByZW50SW5mbyA9IHByb3ZpZGVyc1tjb3VudHJ5TmFtZV0ucmVudDtcblxuXHRcdFx0W3N0cmVhbUluZm8sIGJ1eUluZm8sIHJlbnRJbmZvXS5mb3JFYWNoKChpbmZvKSA9PiB7XG5cdFx0XHRcdGNvbnN0IHNlcnZpY2VDb250YWluZXIgPSByZW5kZXJFbGVtZW50KFwiZGl2XCIsIFwic2VydmljZS1jb250YWluZXJcIik7XG5cdFx0XHRcdGNvbnN0IHNlcnZpY2VOYW1lID0gcmVuZGVyRWxlbWVudChcImRpdlwiLCBcInNlcnZpY2UtbmFtZVwiKTtcblx0XHRcdFx0Y29uc3QgcHJvdmlkZXJTZXJ2aWNlQ29udGFpbmVyID0gcmVuZGVyRWxlbWVudChcblx0XHRcdFx0XHRcImRpdlwiLFxuXHRcdFx0XHRcdFwicHJvdmlkZXItc2VydmljZS1jb250YWluZXJcIlxuXHRcdFx0XHQpO1xuXG5cdFx0XHRcdGluZm8uZm9yRWFjaCgocHJvdmlkZXIpID0+IHtcblx0XHRcdFx0XHRjb25zdCBwcm92aWRlclNlcnZpY2UgPSByZW5kZXJFbGVtZW50KFwiZGl2XCIsIFwicHJvdmlkZXItc2VydmljZVwiKTtcblx0XHRcdFx0XHQvLyBBZGQgaW1nIGFuZCBuYW1lIG9mIHByb3ZpZGVyLlxuXHRcdFx0XHRcdGNvbnN0IHByb3ZpZGVySW1nID0gcmVuZGVyRWxlbWVudChcImltZ1wiLCBcInByb3ZpZGVyLWltZ1wiKTtcblx0XHRcdFx0XHRjb25zdCBwcm92aWRlck5hbWUgPSByZW5kZXJFbGVtZW50KFwic3BhblwiLCBcInByb3ZpZGVyLW5hbWVcIik7XG5cblx0XHRcdFx0XHRpZiAocHJvdmlkZXIucHJvdmlkZXJfbG9nb19wYXRoKSB7XG5cdFx0XHRcdFx0XHRwcm92aWRlckltZy5zcmMgPSBgaHR0cHM6Ly9pbWFnZS50bWRiLm9yZy90L3Avb3JpZ2luYWwvJHtwcm92aWRlci5wcm92aWRlcl9sb2dvX3BhdGh9YDtcblx0XHRcdFx0XHRcdHByb3ZpZGVySW1nLmFsdCA9IGAke3Byb3ZpZGVyLnByb3ZpZGVyX25hbWV9IHBpY3R1cmUuYDtcblx0XHRcdFx0XHRcdHByb3ZpZGVyTmFtZS50ZXh0Q29udGVudCA9IHByb3ZpZGVyLnByb3ZpZGVyX25hbWU7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0W3Byb3ZpZGVySW1nLCBwcm92aWRlck5hbWVdLmZvckVhY2goKGVsZW0pID0+IHtcblx0XHRcdFx0XHRcdHByb3ZpZGVyU2VydmljZS5hcHBlbmRDaGlsZChlbGVtKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRwcm92aWRlclNlcnZpY2VDb250YWluZXIuYXBwZW5kQ2hpbGQocHJvdmlkZXJTZXJ2aWNlKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRzZXJ2aWNlTmFtZS50ZXh0Q29udGVudCA9IGAke2luZm99YDtcblx0XHRcdFx0c2VydmljZUNvbnRhaW5lci5hcHBlbmRDaGlsZChzZXJ2aWNlTmFtZSk7XG5cdFx0XHRcdHNlcnZpY2VDb250YWluZXIuYXBwZW5kQ2hpbGQocHJvdmlkZXJTZXJ2aWNlQ29udGFpbmVyKTtcblx0XHRcdFx0aG91c2VDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VydmljZUNvbnRhaW5lcik7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH07XG5cdHJldHVybiB7XG5cdFx0c2VjdGlvbixcblx0XHRhZGRUb1NlY3Rpb24sXG5cdFx0ZHJhd0FsbCxcblx0XHRkcmF3SW50cm8sXG5cdFx0ZHJhd1N1YkluZm9zLFxuXHRcdGRyYXdQcm92aWRlcnMsXG5cdH07XG59O1xuXG5leHBvcnQgeyBkcmF3U2VjdGlvbiB9O1xuIiwiaW1wb3J0IGNvbGxlY3RTZWFyY2hRdWVyeSBmcm9tIFwiLi9zZWFyY2hcIjtcbmltcG9ydCB7IGZldGNoSWRzIH0gZnJvbSBcIi4uL2FwaUZ1bmN0aW9ucy9mZXRjaElkXCI7XG5pbXBvcnQgKiBhcyBtb3ZpZSBmcm9tIFwiLi4vYXBpRnVuY3Rpb25zL2ZldGNoTW92aWVJbmZvXCI7XG5pbXBvcnQgeyBkcmF3U2VjdGlvbiB9IGZyb20gXCIuL2RyYXdTZWN0aW9uXCI7XG5cbmFzeW5jIGZ1bmN0aW9uIGRyYXdTZWN0aW9ucyh0aXRsZSkge1xuXHRjb25zdCBpZHMgPSBhd2FpdCBmZXRjaElkcyh0aXRsZSk7XG5cdGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4tY29udGFpbmVyXCIpO1xuXHRsZXQgc2VjdGlvbnMgPSBbXTtcblxuXHQvLyBNYWtlIGFuIGFyciB3LyBlbGVtcyBvZiBbaWQsIG1lZGlhXVxuXHRmb3IgKGxldCBpZCBpbiBpZHMpIHtcblx0XHQvLyBUZW1wIG1ha2UgaXQgc28gdGhhdCBpdCBvbmx5IGFjY2VwdHMgbW92aWVzXG5cblx0XHRpZHNbaWRdID09PSBcIm1vdmllXCIgPyBzZWN0aW9ucy5wdXNoKFtpZCwgaWRzW2lkXV0pIDogXCJcIjtcblx0fVxuXG5cdHNlY3Rpb25zLmZvckVhY2goXG5cdFx0YXN5bmMgKHNlY3Rpb24pID0+IGF3YWl0IHJlbmRlclNlY3Rpb24oc2VjdGlvblswXSwgc2VjdGlvblsxXSlcblx0KTtcblxuXHRhc3luYyBmdW5jdGlvbiByZW5kZXJTZWN0aW9uKGlkLCBtZWRpYSkge1xuXHRcdGNvbnN0IHNlY3Rpb24gPSBhd2FpdCBkcmF3U2VjdGlvbihpZCwgbWVkaWEpO1xuXHRcdHNlY3Rpb24uYWRkVG9TZWN0aW9uKHNlY3Rpb24uZHJhd0ludHJvKFwiMzAwXCIpKTtcblx0XHRzZWN0aW9uLmFkZFRvU2VjdGlvbihzZWN0aW9uLmRyYXdTdWJJbmZvcygpKTtcblx0XHRzZWN0aW9uLmFkZFRvU2VjdGlvbihzZWN0aW9uLmRyYXdQcm92aWRlcnMoKSk7XG5cdFx0bWFpbi5hcHBlbmRDaGlsZChzZWN0aW9uLnNlY3Rpb24pO1xuXHRcdHJldHVybiByZW5kZXJTZWN0aW9uO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGNsZWFyU2VjdGlvbnMoKSB7XG5cdGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4tY29udGFpbmVyXCIpO1xuXHRtYWluLmlubmVySFRNTCA9IFwiXCI7XG59XG5cbmV4cG9ydCB7IGRyYXdTZWN0aW9ucywgY2xlYXJTZWN0aW9ucyB9O1xuIiwiaW1wb3J0IHsgZHJhd1NlY3Rpb25zIH0gZnJvbSBcIi4vanMvRE9NRnVuY3Rpb25zL2RyYXdTZWN0aW9uc1wiO1xuaW1wb3J0IGFkZFN1Ym1pdFNlYXJjaEZuYyBmcm9tIFwiLi9qcy9VSS9zdWJtaXRTZWFyY2hcIjtcblxuY29uc29sZS5sb2coXCJIZWxsbyBXb3JsZFwiKTtcbi8vIGZldGNoSWRzKCdJUk9OIE1BTicpO1xuXG4vLyBmZXRjaE1vdmllRHVtbXkoMTcyNik7XG4vLyBmZXRjaE1vdmllRHVtbXkoMzA5Nyk7IC8vIGZhaWwgdG8gZmV0Y2ggYmVjYXVzZSBpdHMgdHYuXG4vLyBmZXRjaE1vdmllRHVtbXkoMTAxMzgpO1xuLy8gZmV0Y2hNb3ZpZUR1bW15KDY4NzIxKTtcblxuLy8gYXN5bmMgZnVuY3Rpb24gZmV0Y2hNb3ZpZUR1bW15KGlkKSB7XG4vLyAgICAgY29uc3QgbW92aWVEZXRhaWxzID0gYXdhaXQgbW92aWUuZmV0Y2hNb3ZpZURldGFpbHMoaWQpO1xuLy8gICAgIGNvbnN0IG1vdmllUmVjY29zID0gYXdhaXQgbW92aWUuZmV0Y2hNb3ZpZVJlY2NvcyhpZCk7XG4vLyAgICAgY29uc3QgbW92aWVQcm92aWRlcnMgPSBhd2FpdCBtb3ZpZS5mZXRjaE1vdmllUHJvdmlkZXJzKGlkKTtcbi8vICAgICBjb25zdCBtb3ZpZVRyYWlsZXIgPSBhd2FpdCBtb3ZpZS5mZXRjaE1vdmllVHJhaWxlcihpZCk7XG4vLyAgICAgY29uc3QgbW92aWVSZXZpZXdzID0gYXdhaXQgbW92aWUuZmV0Y2hNb3ZpZVJldmlld3MoaWQpO1xuLy8gICAgIGNvbnNvbGUubG9nKG1vdmllRGV0YWlscyk7XG4vLyAgICAgY29uc29sZS5sb2cobW92aWVSZWNjb3MpO1xuLy8gICAgIGNvbnNvbGUubG9nKG1vdmllUHJvdmlkZXJzKTtcbi8vICAgICBjb25zb2xlLmxvZyhtb3ZpZVRyYWlsZXIpO1xuLy8gICAgIGNvbnNvbGUubG9nKG1vdmllUmV2aWV3cyk7XG4vLyB9XG5cbi8vIGFkZFN1Ym1pdFNlYXJjaEZ1bmN0aW9uKCk7XG5cbmFkZFN1Ym1pdFNlYXJjaEZuYygpO1xuZHJhd1NlY3Rpb25zKFwiaXJvbiBtYW5cIik7XG4iLCJpbXBvcnQgeyBkcmF3U2VjdGlvbnMsIGNsZWFyU2VjdGlvbnMgfSBmcm9tIFwiLi4vRE9NRnVuY3Rpb25zL2RyYXdTZWN0aW9uc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBhZGRTdWJtaXRTZWFyY2hGbmMoKSB7XG5cdGNvbnN0IHNlYXJjaEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2VhcmNoLXF1ZXJ5XCIpO1xuXHRzZWFyY2hCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFzeW5jIChlKSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGNvbnN0IHF1ZXJ5ID0gaW50ZXJwcmV0VG9RdWVyeShcblx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW5wdXQtc2VhcmNoXCIpLnZhbHVlXG5cdFx0KTtcblx0XHRpZiAoIXF1ZXJ5KSB7XG5cdFx0XHRhbGVydChcIlBsZWFzZSBlbnRlciBhIHZhbGlkIG1vdmllL3R2IHNob3dcIik7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGNsZWFyU2VjdGlvbnMoKTtcblx0XHRhd2FpdCBkcmF3U2VjdGlvbnMocXVlcnkpO1xuXG5cdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zZWFyY2gtcXVlcnlcIikudmFsdWUgPSBcIlwiO1xuXHR9KTtcbn1cblxuZnVuY3Rpb24gaW50ZXJwcmV0VG9RdWVyeShuYW1lKSB7XG5cdHJldHVybiBuYW1lLnNwbGl0KFwiIFwiKS5qb2luKFwiK1wiKTtcbn1cbiJdLCJuYW1lcyI6WyJBUElfS0VZIiwiYXN5bmMiLCJmZXRjaE1vdmllRGV0YWlscyIsIm1vdmllX2lkIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1vZGUiLCJkYXRhIiwianNvbiIsImdlbnJlcyIsInJlZHVjZSIsImFjYyIsInZhbCIsIm5hbWUiLCJtTmFtZSIsIm9yaWdpbmFsX3RpdGxlIiwic3VtbWFyeSIsIm92ZXJ2aWV3IiwidGFnbGluZSIsInBvcHVsYXJpdHkiLCJ2b3RlX2F2ZXJhZ2UiLCJ2b3RlX2NvdW50IiwidmlkZW8iLCJydW50aW1lIiwicG9zdGVyX3BhdGgiLCJiYWNrZHJvcF9wYXRoIiwiZXJyIiwiYWxlcnQiLCJmZXRjaE1vdmllUmVjY29zIiwicmVjTW92aWVzIiwicmVzdWx0cyIsImNvdW50IiwibW92aWUiLCJpZCIsImZldGNoTW92aWVQcm92aWRlcnMiLCJwcm92aWRlcnNCeUNvdW50cnkiLCJjb3VudHJ5Q29kZSIsImNvdW50cnkiLCJjb2RlIiwiSW50bCIsIkRpc3BsYXlOYW1lcyIsInR5cGUiLCJvZiIsInN0cmVhbSIsInJlbnQiLCJidXkiLCJzb3J0UHJvdmlkZXJzIiwic2VydmljZXMiLCJjb2xsZWN0aW9uIiwiZm9yRWFjaCIsInNlcnZpY2UiLCJwcm92aWRlckluZm8iLCJwcm92aWRlcl9uYW1lIiwicHJvdmlkZXJfbG9nb19wYXRoIiwibG9nb19wYXRoIiwicHVzaCIsImZsYXRyYXRlIiwiY29uc29sZSIsImxvZyIsImZldGNoTW92aWVUcmFpbGVyIiwibW92aWVUcmFpbGVyIiwidHJhaWxlcnMiLCJmaWx0ZXIiLCJsZW5ndGgiLCJvZmZpY2lhbCIsImtleSIsInNpdGUiLCJsYW5nIiwiaXNvXzYzOV8xIiwiZmV0Y2hNb3ZpZVJldmlld3MiLCJyZXZpZXdzIiwicmV2aWV3IiwiYXV0aG9yIiwicmF0aW5nIiwiYXV0aG9yX2RldGFpbHMiLCJwaWNfcGF0aCIsImF2YXRhcl9wYXRoIiwiY29udGVudCIsInVybCIsImxhc3RfdXBkYXRlZCIsInVwZGF0ZWRfYXQiLCJzbGljZSIsImRyYXdTZWN0aW9uIiwibWVkaWEiLCJzZWN0aW9uIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiZGV0YWlscyIsImdldEluZm8iLCJwcm92aWRlcnMiLCJhZGRUb1NlY3Rpb24iLCJwYXJ0IiwiYXBwZW5kQ2hpbGQiLCJtb3ZpZUZuYyIsInR2Rm5jIiwiZHJhd0ludHJvIiwiaW1nU2l6ZSIsImludHJvQ29udGFpbmVyIiwiY2xhc3NMaXN0IiwiYWRkIiwidGl0bGUiLCJ0ZXh0Q29udGVudCIsImNyZWF0ZVRpdGxlIiwidGFnUGFyYSIsIndyaXRlVGFnbGluZSIsImltZyIsInBvc3RlciIsImJhc2VJbWdVcmwiLCJpbWdfcGF0aCIsInNyYyIsImFsdCIsInJlbmRlckltZyIsInBhcmEiLCJ3cml0ZVN1bW1hcnkiLCJkcmF3QWxsIiwiZHJhd1N1YkluZm9zIiwiY29udGFpbmVyIiwiY3JlYXRlU3ViSW5mbyIsImNhdGVnb3J5IiwiaW5mbyIsInN1YkluZm8iLCJjYXRlZ29yeU5hbWUiLCJjYXRlZ29yeUluZm8iLCJqb2luIiwibWlucyIsImhvdXJzIiwickhvdXJzIiwiTWF0aCIsImZsb29yIiwibWludXRlcyIsInJvdW5kIiwiY29udmVydE1pblRvSHIiLCJkcmF3UHJvdmlkZXJzIiwicmVuZGVyRWxlbWVudCIsInRhZyIsImNsYXNzTmFtZSIsInByb3ZpZGVyQ29udGFpbmVyIiwiY291bnRyeUJ0biIsImhvdXNlQ29udGFpbmVyIiwiZWxlbSIsImNvdW50cnlOYW1lIiwic2VydmljZUNvbnRhaW5lciIsInNlcnZpY2VOYW1lIiwicHJvdmlkZXJTZXJ2aWNlQ29udGFpbmVyIiwicHJvdmlkZXIiLCJwcm92aWRlclNlcnZpY2UiLCJwcm92aWRlckltZyIsInByb3ZpZGVyTmFtZSIsImRyYXdQcm92aWRlciIsImRyYXdTZWN0aW9ucyIsImlkcyIsInF1ZXJ5Iiwic3BsaXQiLCJpbnRlcnByZXRUb1F1ZXJ5IiwicmVzdWx0IiwiaSIsIm1lZGlhX3R5cGUiLCJmZXRjaElkcyIsIm1haW4iLCJxdWVyeVNlbGVjdG9yIiwic2VjdGlvbnMiLCJyZW5kZXJTZWN0aW9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImdldEVsZW1lbnRCeUlkIiwidmFsdWUiLCJpbm5lckhUTUwiLCJhZGRTdWJtaXRTZWFyY2hGbmMiXSwic291cmNlUm9vdCI6IiJ9