(()=>{"use strict";const t="720d2150cf09bfa61e28a5042cd7468f",e="720d2150cf09bfa61e28a5042cd7468f";async function a(t){try{const a=await fetch(`https://api.themoviedb.org/3/movie/${t}?api_key=${e}&language=en-US`,{mode:"cors"}),n=await a.json(),r=n.genres.reduce(((t,e)=>[...t,e.name]),[]);return{mName:n.original_title,summary:n.overview,tagline:n.tagline,popularity:n.popularity,vote_average:n.vote_average,vote_count:n.vote_count,genres:r,video:n.video,runtime:n.runtime,poster_path:n.poster_path,backdrop_path:n.backdrop_path}}catch(t){alert(t)}}async function n(t){try{const a=await fetch(`https://api.themoviedb.org/3/movie/${t}/recommendations?api_key=${e}&language=en-US&page=1`,{mode:"cors"}),n=await a.json(),r={};if(n.results){let t=1;for(let e of n.results){if(r[e.original_title]={mName:e.original_title,id:e.id,poster_path:e.poster_path,backdrop_path:e.backdrop_path},5===t)break;t++}}return r}catch(t){alert(t)}}async function r(t){const a={};try{const r=await fetch(`https://api.themoviedb.org/3/movie/${t}/watch/providers?api_key=${e}`,{mode:"cors"}),o=await r.json();for(const t in o.results){const e=(n=t,new Intl.DisplayNames(["en"],{type:"region"}).of(n));a[e]={stream:[],rent:[],buy:[]};const r=(t,e)=>{t&&t.forEach((t=>{const a={provider_name:t.provider_name,provider_logo_path:t.logo_path};e.push(a)}))};r(o.results[t].flatrate,a[e].stream),r(o.results[t].rent,a[e].rent),r(o.results[t].buy,a[e].buy)}return a}catch(t){alert(t)}var n}async function o(t){try{let n;const r=await fetch(`https://api.themoviedb.org/3/movie/${t}/videos?api_key=${e}`,{mode:"cors"}),o=(await r.json()).results.filter((t=>"Trailer"===t.type));if(0===o.length)return!1;const i=o.filter((t=>{t.official}));return n=0!==i.length?i[0]:o[0],{mName:n.name,key:n.key,site:n.site,type:n.type,lang:(a=n.iso_639_1,new Intl.DisplayNames(["en"],{type:"language"}).of(a))}}catch(t){alert(t)}var a}async function i(t){try{let a=[];const n=await fetch(`https://api.themoviedb.org/3/movie/${t}/reviews?api_key=${e}&language=en-US&page=1`,{mode:"cors"}),r=await n.json();if(0===r.results.length)return!1;let o=1;return r.results.forEach((t=>{a.push({author:t.author,rating:t.author_details.rating,pic_path:t.author_details.avatar_path,content:t.content,url:t.url,last_updated:t.updated_at}),o++})),a.slice(0,5)}catch(t){alert(t)}}const c=async(t,e)=>{const c=document.createElement("section"),s=await u(t,a),d=(await u(t,n),await u(t,r));function l(t){c.appendChild(t)}async function u(t,a,n){return"movie"===e?await a(t):""}await u(t,o),await u(t,i);const p=t=>{const e=document.createElement("div");e.classList.add("intro"),e.appendChild(function(){const t=document.createElement("h1");return t.textContent=s.mName,t.classList.add("title"),t}()),s.tagline&&e.appendChild(function(){const t=document.createElement("p");return t.textContent=s.tagline,t.classList.add("tagline"),t}());const a=function(t=""){const e=document.createElement("img"),a="https://image.tmdb.org/t/p";let n;if(e.classList.add("poster"),s.poster_path)n=s.poster_path;else{if(!s.backdrop_path)return;n=s.backdrop_path}return e.src=t?`${a}/w${t}/${n}`:`${a}/original/${n}`,e.alt="Movie picture poster",e}(t);return a&&e.appendChild(a),e.appendChild(function(){const t=document.createElement("p");return t.textContent=s.summary,t.classList.add("summary"),t}()),e};return{section:c,addToSection:l,drawAll:function(){l(p())},drawIntro:p,drawSubInfos:()=>{const t=document.createElement("div");function e(t,e){const a=document.createElement("div"),n=document.createElement("span"),r=document.createElement("span");return a.classList.add("sub-info"),n.classList.add("category-name"),r.classList.add("category-info"),n.textContent=t,r.textContent=e,[n,r].forEach((t=>a.appendChild(t))),a}return t.classList.add("subinfo-container"),[e("Genres:",s.genres.join(", ")),e("Runtime:",function(t){const e=t/60,a=Math.floor(e),n=60*(e-a);return`${a}h ${Math.round(n)}min`}(s.runtime)),e("Vote Average:",s.vote_average),e("Vote Count:",s.vote_count),e("Popularity:",s.popularity)].forEach((e=>t.appendChild(e))),t},drawProviders:()=>{function t(t,e){const a=document.createElement(t);return a.classList.add(e),a}const e=t("div","provider-container"),a=t("button","country-btn"),n=t("div","house-provider-container");return[a,n].forEach((t=>{e.appendChild(t)})),Object.keys(d).length?Object.keys(d).includes("Australia")?r("Australia"):r(Object.keys(d)[0]):a.textContent="No countries offer this tv/movie at the moment.",e;function r(e="Australia"){a.textContent=e;const r=d[e].stream,o=d[e].buy,i=d[e].rent,c=["Stream at:","Purchase at:","Rent at:"];let s=0;[r,o,i].forEach((e=>{const a=t("div","service-container"),r=t("div","service-name"),o=t("h2","service-name-bold"),i=t("div","provider-service-container");e.forEach((e=>{const a=t("div","provider-service"),n=t("img","provider-img"),r=t("span","provider-name");e.provider_logo_path&&(n.src=`https://image.tmdb.org/t/p/original/${e.provider_logo_path}`,n.alt=`${e.provider_name} picture.`,r.textContent=e.provider_name),[n,r].forEach((t=>{a.appendChild(t)})),i.appendChild(a)})),e.length&&(o.textContent=`${c[s]}`,r.appendChild(o)),s++,a.appendChild(r),a.appendChild(i),n.appendChild(a)}))}}}};async function s(e){const a=await async function(e){const a=function(t){return t.split(" ").join("+")}(e);try{const n=await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${t}&language=en-US&query=${a}&page=1`,{mode:"cors"}),r=await n.json();let o={},i=r.results.sort(((t,e)=>t.popularity<e.popularity?1:t.popularity>e.popularity?-1:0));if(i.length){for(let t=0;t<i.length;t++)o[i[t].id]=i[t].media_type;return o}return void alert(`No results found for ${e}`)}catch(t){alert(t)}}(e),n=document.querySelector(".main-container");let r=[];for(let t in a)"movie"===a[t]&&r.push([t,a[t]]);async function o(t,e){const a=await c(t,e);return a.addToSection(a.drawIntro("300")),a.addToSection(a.drawSubInfos()),a.addToSection(a.drawProviders()),n.appendChild(a.section),o}r.forEach((async t=>await o(t[0],t[1])))}console.log("Hello World"),async function(){document.querySelector(".search-query").addEventListener("click",(async t=>{t.preventDefault();const e=document.getElementById("input-search").value.split(" ").join("+");e?(document.querySelector(".main-container").innerHTML="",await s(e),document.querySelector(".search-query").value=""):alert("Please enter a valid movie/tv show")}))}(),s("iron man")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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MUksRUFBSWdELEdBQ2hDLE1BQU1DLFFBQWdCRixFQUFZL0MsRUFBSWdELEdBS3RDLE9BSkFDLEVBQVFNLGFBQWFOLEVBQVFXLFVBQVUsUUFDdkNYLEVBQVFNLGFBQWFOLEVBQVErQixnQkFDN0IvQixFQUFRTSxhQUFhTixFQUFRZ0QsaUJBQzdCc0MsRUFBSzlFLFlBQVlSLEVBQVFBLFNBQ2xCeUYsQ0FDUixDQVhBRCxFQUFTekgsU0FDUmhELE1BQU9pRixTQUFrQnlGLEVBQWN6RixFQUFRLEdBQUlBLEVBQVEsS0FXN0QsQ0MxQkEwRixRQUFRQyxJQUFJLGVDREc1SyxpQkFDSWtGLFNBQVNzRixjQUFjLGlCQUMvQkssaUJBQWlCLFNBQVM3SyxNQUFPOEssSUFDMUNBLEVBQUVDLGlCQUNGLE1BQU1sQixFQUNMM0UsU0FBUzhGLGVBQWUsZ0JBQWdCQyxNQWM5Qm5CLE1BQU0sS0FBS3RDLEtBQUssS0FadEJxQyxHRnVCTzNFLFNBQVNzRixjQUFjLG1CQUMvQlUsVUFBWSxTRW5CVnZCLEVBQWFFLEdBRW5CM0UsU0FBU3NGLGNBQWMsaUJBQWlCUyxNQUFRLElBTi9DdkosTUFBTSxxQ0FNMkMsR0FFcEQsQ0RRQXlKLEdBQ0F4QixFQUFhLFciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tb3ZpZW1hdGUvLi9zcmMvanMvYXBpRnVuY3Rpb25zL2ZldGNoSWQuanMiLCJ3ZWJwYWNrOi8vbW92aWVtYXRlLy4vc3JjL2pzL2FwaUZ1bmN0aW9ucy9mZXRjaE1vdmllSW5mby5qcyIsIndlYnBhY2s6Ly9tb3ZpZW1hdGUvLi9zcmMvanMvRE9NRnVuY3Rpb25zL2RyYXdTZWN0aW9uLmpzIiwid2VicGFjazovL21vdmllbWF0ZS8uL3NyYy9qcy9ET01GdW5jdGlvbnMvZHJhd1NlY3Rpb25zLmpzIiwid2VicGFjazovL21vdmllbWF0ZS8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly9tb3ZpZW1hdGUvLi9zcmMvanMvVUkvc3VibWl0U2VhcmNoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IEFQSV9LRVkgPSBcIjcyMGQyMTUwY2YwOWJmYTYxZTI4YTUwNDJjZDc0NjhmXCI7XG4vKlxuRmV0Y2hlcyB0aGUgZmlyc3QgNSBtb3ZpZS9zaG93IGlkcyBhbmQgcmV0dXJuIGl0IGluIGFuIGFycmF5LlxuKi9cbmFzeW5jIGZ1bmN0aW9uIGZldGNoSWRzKG5hbWUpIHtcblx0Y29uc3QgcXVlcnkgPSBpbnRlcnByZXRUb1F1ZXJ5KG5hbWUpO1xuXHR0cnkge1xuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG5cdFx0XHRgaHR0cHM6Ly9hcGkudGhlbW92aWVkYi5vcmcvMy9zZWFyY2gvbXVsdGk/YXBpX2tleT0ke0FQSV9LRVl9Jmxhbmd1YWdlPWVuLVVTJnF1ZXJ5PSR7cXVlcnl9JnBhZ2U9MWAsXG5cdFx0XHR7IG1vZGU6IFwiY29yc1wiIH1cblx0XHQpO1xuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0bGV0IGlkcyA9IHt9O1xuXHRcdC8vIGxldCByZXN1bHQgPSBkYXRhLnJlc3VsdHM7XG5cdFx0bGV0IHJlc3VsdCA9IGRhdGEucmVzdWx0cy5zb3J0KFxuXHRcdFx0KHAxLCBwMikgPT4gKHAxLnBvcHVsYXJpdHkgPCBwMi5wb3B1bGFyaXR5KSA/IDEgOiAocDEucG9wdWxhcml0eSA+IHAyLnBvcHVsYXJpdHkpID8gLTEgOiAwXG5cdFx0KSAvLyBTb3J0IGJ5IHBvcHVsYXJpdHkuXG5cdFx0XG5cdFx0aWYgKHJlc3VsdC5sZW5ndGgpIHtcblx0XHRcdC8vIGlmIChyZXN1bHQubGVuZ3RoID4gNCkge1xuXHRcdFx0Ly8gXHRmb3IgKGxldCBpID0gMDsgaSA8IDU7IGkrKykge1xuXHRcdFx0Ly8gXHRcdGlkc1tyZXN1bHRbaV0uaWRdID0gcmVzdWx0W2ldLm1lZGlhX3R5cGU7XG5cdFx0XHQvLyBcdH1cblx0XHRcdC8vIH0gZWxzZSB7XG5cdFx0XHQvLyBcdGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7XG5cdFx0XHQvLyBcdFx0aWRzW3Jlc3VsdFtpXS5pZF0gPSByZXN1bHRbaV0ubWVkaWFfdHlwZTtcblx0XHRcdC8vIFx0fVxuXHRcdFx0Ly8gfVxuXHRcdFx0Zm9yKGxldCBpID0gMDsgaSA8IHJlc3VsdC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRpZHNbcmVzdWx0W2ldLmlkXSA9IHJlc3VsdFtpXS5tZWRpYV90eXBlO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGlkcztcblx0XHR9IGVsc2Uge1xuXHRcdFx0YWxlcnQoYE5vIHJlc3VsdHMgZm91bmQgZm9yICR7bmFtZX1gKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdH0gY2F0Y2ggKGVycikge1xuXHRcdGFsZXJ0KGVycik7XG5cdH1cbn1cblxuZnVuY3Rpb24gaW50ZXJwcmV0VG9RdWVyeShuYW1lKSB7XG5cdHJldHVybiBuYW1lLnNwbGl0KFwiIFwiKS5qb2luKFwiK1wiKTtcbn1cblxuZXhwb3J0IHsgZmV0Y2hJZHMgfTtcbiIsImNvbnN0IEFQSV9LRVkgPSBcIjcyMGQyMTUwY2YwOWJmYTYxZTI4YTUwNDJjZDc0NjhmXCI7XG5cbmFzeW5jIGZ1bmN0aW9uIGZldGNoTW92aWVEZXRhaWxzKG1vdmllX2lkKSB7XG5cdHRyeSB7XG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcblx0XHRcdGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL21vdmllLyR7bW92aWVfaWR9P2FwaV9rZXk9JHtBUElfS0VZfSZsYW5ndWFnZT1lbi1VU2AsXG5cdFx0XHR7IG1vZGU6IFwiY29yc1wiIH1cblx0XHQpO1xuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cblx0XHRjb25zdCBnZW5yZXMgPSBkYXRhLmdlbnJlcy5yZWR1Y2UoKGFjYywgdmFsKSA9PiBbLi4uYWNjLCB2YWwubmFtZV0sIFtdKTtcblxuXHRcdGNvbnN0IGdlbmVyYWxJbmZvID0ge1xuXHRcdFx0bU5hbWU6IGRhdGEub3JpZ2luYWxfdGl0bGUsXG5cdFx0XHRzdW1tYXJ5OiBkYXRhLm92ZXJ2aWV3LFxuXHRcdFx0dGFnbGluZTogZGF0YS50YWdsaW5lLFxuXHRcdFx0cG9wdWxhcml0eTogZGF0YS5wb3B1bGFyaXR5LFxuXHRcdFx0dm90ZV9hdmVyYWdlOiBkYXRhLnZvdGVfYXZlcmFnZSxcblx0XHRcdHZvdGVfY291bnQ6IGRhdGEudm90ZV9jb3VudCxcblx0XHRcdGdlbnJlczogZ2VucmVzLFxuXHRcdFx0dmlkZW86IGRhdGEudmlkZW8sXG5cdFx0XHRydW50aW1lOiBkYXRhLnJ1bnRpbWUsXG5cdFx0XHRwb3N0ZXJfcGF0aDogZGF0YS5wb3N0ZXJfcGF0aCxcblx0XHRcdGJhY2tkcm9wX3BhdGg6IGRhdGEuYmFja2Ryb3BfcGF0aCxcblx0XHR9O1xuXHRcdHJldHVybiBnZW5lcmFsSW5mbztcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0YWxlcnQoZXJyKTtcblx0fVxufVxuXG4vKlxuUmV0dXJucyBhbiBhcnJheSBvZiByZWNvbW1lbmRlZCBtb3ZpZXMgd2l0aCB0aGVpciBuYW1lLCBpZCwgcG9zdGVyX3BhdGggYW5kXG5iYWNrZHJvcF9wYXRoIHJlY29yZGVkLiBcbklmIG5vIG1vdmllcyBhcmUgcmVjb21tZW5kZWQsIHJldHVybiBudWxsO1xuKi9cbmFzeW5jIGZ1bmN0aW9uIGZldGNoTW92aWVSZWNjb3MobW92aWVfaWQpIHtcblx0dHJ5IHtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuXHRcdFx0YGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvbW92aWUvJHttb3ZpZV9pZH0vcmVjb21tZW5kYXRpb25zP2FwaV9rZXk9JHtBUElfS0VZfSZsYW5ndWFnZT1lbi1VUyZwYWdlPTFgLFxuXHRcdFx0eyBtb2RlOiBcImNvcnNcIiB9XG5cdFx0KTtcblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG5cdFx0Y29uc3QgcmVjTW92aWVzID0ge307XG5cdFx0aWYgKGRhdGEucmVzdWx0cykge1xuXHRcdFx0bGV0IGNvdW50ID0gMTtcblx0XHRcdGZvciAobGV0IG1vdmllIG9mIGRhdGEucmVzdWx0cykge1xuXHRcdFx0XHRyZWNNb3ZpZXNbbW92aWUub3JpZ2luYWxfdGl0bGVdID0ge1xuXHRcdFx0XHRcdG1OYW1lOiBtb3ZpZS5vcmlnaW5hbF90aXRsZSxcblx0XHRcdFx0XHRpZDogbW92aWUuaWQsXG5cdFx0XHRcdFx0cG9zdGVyX3BhdGg6IG1vdmllLnBvc3Rlcl9wYXRoLFxuXHRcdFx0XHRcdGJhY2tkcm9wX3BhdGg6IG1vdmllLmJhY2tkcm9wX3BhdGgsXG5cdFx0XHRcdH07XG5cdFx0XHRcdGlmIChjb3VudCA9PT0gNSkge1xuXHRcdFx0XHRcdC8vIE1heCA1IG1vdmllcyB0byBiZSByZWNvbW1lbmRlZFxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGNvdW50Kys7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiByZWNNb3ZpZXM7XG5cdH0gY2F0Y2ggKGVycikge1xuXHRcdGFsZXJ0KGVycik7XG5cdH1cbn1cblxuLypcblJldHVybnMgYW4gb2JqZWN0IHdpdGggY291bnRyaWVzIGFuZCB0aGUgYXZhaWxhYmxlIHN0cmVhbWluZyBzZXJ2aWNlcywgYnV5XG5vciByZW50IGl0IGNvbWVzIHdpdGggRUFDSCBpbmRpdmlkdWFsIGNvdW50cnkuXG4qL1xuYXN5bmMgZnVuY3Rpb24gZmV0Y2hNb3ZpZVByb3ZpZGVycyhtb3ZpZV9pZCkge1xuXHRjb25zdCBwcm92aWRlcnNCeUNvdW50cnkgPSB7fTtcblx0dHJ5IHtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuXHRcdFx0YGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvbW92aWUvJHttb3ZpZV9pZH0vd2F0Y2gvcHJvdmlkZXJzP2FwaV9rZXk9JHtBUElfS0VZfWAsXG5cdFx0XHR7IG1vZGU6IFwiY29yc1wiIH1cblx0XHQpO1xuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cblx0XHRmb3IgKGNvbnN0IGNvdW50cnlDb2RlIGluIGRhdGEucmVzdWx0cykge1xuXHRcdFx0Y29uc3QgY291bnRyeSA9IGdldENvdW50cnlOYW1lKGNvdW50cnlDb2RlKTtcblx0XHRcdHByb3ZpZGVyc0J5Q291bnRyeVtjb3VudHJ5XSA9IHtcblx0XHRcdFx0c3RyZWFtOiBbXSxcblx0XHRcdFx0cmVudDogW10sXG5cdFx0XHRcdGJ1eTogW10sXG5cdFx0XHR9O1xuXG5cdFx0XHQvKlxuXHRcdFx0U29ydHMgcHJvdmlkZXJzIGJhc2VkIG9uIGNvdW50cnkgYW5kIHNlcnZpY2VzIHRoZXkgcHJvdmlkZS5cblxuXHRcdFx0VGFrZXMgaW4gdHlwZSBvZiBzZXJ2aWNlcyBhcyBwYXJhbSA9PiBbXCJmbGF0cmF0ZSAoc3RyZWFtaW5nKVwiLCBcblx0XHRcdFwicmVudFwiLCBcImJ1eVwiXSBhbmQgYW4gYXJyYXkgdG8gYXBwZW5kIGl0IHRvLlxuXHRcdFx0Ki9cblx0XHRcdGNvbnN0IHNvcnRQcm92aWRlcnMgPSAoc2VydmljZXMsIGNvbGxlY3Rpb24pID0+IHtcblx0XHRcdFx0aWYgKHNlcnZpY2VzKSB7XG5cdFx0XHRcdFx0c2VydmljZXMuZm9yRWFjaCgoc2VydmljZSkgPT4ge1xuXHRcdFx0XHRcdFx0Y29uc3QgcHJvdmlkZXJJbmZvID0ge1xuXHRcdFx0XHRcdFx0XHRwcm92aWRlcl9uYW1lOiBzZXJ2aWNlLnByb3ZpZGVyX25hbWUsXG5cdFx0XHRcdFx0XHRcdHByb3ZpZGVyX2xvZ29fcGF0aDogc2VydmljZS5sb2dvX3BhdGgsXG5cdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0Y29sbGVjdGlvbi5wdXNoKHByb3ZpZGVySW5mbyk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH07XG5cblx0XHRcdC8vIEFkZCBzdHJlYW1pbmcgc2VydmljZXMgZm9yIHNwZWNpZmllZCBtb3ZpZSBpbiBlYWNoIGNvdW50cnkuXG5cdFx0XHRzb3J0UHJvdmlkZXJzKFxuXHRcdFx0XHRkYXRhLnJlc3VsdHNbY291bnRyeUNvZGVdLmZsYXRyYXRlLFxuXHRcdFx0XHRwcm92aWRlcnNCeUNvdW50cnlbY291bnRyeV0uc3RyZWFtXG5cdFx0XHQpO1xuXG5cdFx0XHQvLyBBZGQgcmVudGluZyBzZXJ2aWNlcyBmb3Igc3BlaWNpZmllZCBtb3ZpZSBpbiBlYWNoIGNvdW50cnkuXG5cdFx0XHRzb3J0UHJvdmlkZXJzKFxuXHRcdFx0XHRkYXRhLnJlc3VsdHNbY291bnRyeUNvZGVdLnJlbnQsXG5cdFx0XHRcdHByb3ZpZGVyc0J5Q291bnRyeVtjb3VudHJ5XS5yZW50XG5cdFx0XHQpO1xuXG5cdFx0XHQvLyBBZGQgYnV5aW5nIHNlcnZpY2VzIGZvciBzcGVjaWZpZWQgbW92aWUgaW4gZWFjaCBjb3VudHJ5LlxuXHRcdFx0c29ydFByb3ZpZGVycyhcblx0XHRcdFx0ZGF0YS5yZXN1bHRzW2NvdW50cnlDb2RlXS5idXksXG5cdFx0XHRcdHByb3ZpZGVyc0J5Q291bnRyeVtjb3VudHJ5XS5idXlcblx0XHRcdCk7XG5cdFx0fVxuXHRcdHJldHVybiBwcm92aWRlcnNCeUNvdW50cnk7XG5cdH0gY2F0Y2ggKGVycikge1xuXHRcdGFsZXJ0KGVycik7XG5cdH1cbn1cblxuLy8gRmluZCBtb3ZpZSB0cmFpbGVyIGFuZCByZXR1cm4gZmFsc2UgaWYgbm9uZSBjYW4gYmUgZm91bmQuXG4vLyBPZmZpY2lhbCB0cmFpbGVyIHdpbGwgYmUgcHJpb3JpdGlzZWQuXG5hc3luYyBmdW5jdGlvbiBmZXRjaE1vdmllVHJhaWxlcihtb3ZpZV9pZCkge1xuXHR0cnkge1xuXHRcdGxldCBtb3ZpZVRyYWlsZXI7XG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcblx0XHRcdGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL21vdmllLyR7bW92aWVfaWR9L3ZpZGVvcz9hcGlfa2V5PSR7QVBJX0tFWX1gLFxuXHRcdFx0eyBtb2RlOiBcImNvcnNcIiB9XG5cdFx0KTtcblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG5cdFx0Y29uc3QgdHJhaWxlcnMgPSBkYXRhLnJlc3VsdHMuZmlsdGVyKCh2aWRlbykgPT4gdmlkZW8udHlwZSA9PT0gXCJUcmFpbGVyXCIpO1xuXG5cdFx0aWYgKHRyYWlsZXJzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuXHRcdC8vIEZpbmQgb2ZmaWNpYWwgdHJhaWxlci5cblx0XHRjb25zdCBvZmZpY2lhbCA9IHRyYWlsZXJzLmZpbHRlcigodmlkZW8pID0+IHtcblx0XHRcdHZpZGVvLm9mZmljaWFsID09PSB0cnVlO1xuXHRcdH0pO1xuXG5cdFx0b2ZmaWNpYWwubGVuZ3RoICE9PSAwXG5cdFx0XHQ/IChtb3ZpZVRyYWlsZXIgPSBvZmZpY2lhbFswXSlcblx0XHRcdDogKG1vdmllVHJhaWxlciA9IHRyYWlsZXJzWzBdKTtcblxuXHRcdHJldHVybiB7XG5cdFx0XHRtTmFtZTogbW92aWVUcmFpbGVyLm5hbWUsXG5cdFx0XHRrZXk6IG1vdmllVHJhaWxlci5rZXksXG5cdFx0XHRzaXRlOiBtb3ZpZVRyYWlsZXIuc2l0ZSxcblx0XHRcdHR5cGU6IG1vdmllVHJhaWxlci50eXBlLFxuXHRcdFx0bGFuZzogZ2V0TGFuZ3VhZ2UobW92aWVUcmFpbGVyLmlzb182MzlfMSksXG5cdFx0fTtcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0YWxlcnQoZXJyKTtcblx0fVxufVxuXG4vLyBSZXR1cm5zIGFuIGFyciBvZiBhIG1heGltdW0gb2YgNSByZXZpZXdzIGJhc2VkIG9uIHRoZSBtb3ZpZSBmcm9tIHJhbmRvbSBzb3VyY2VzLlxuLy8gSWYgbm8gcmV2aWV3cyBhcmUgZm91bmQsIHRoaXMgZm5jIHJldHVybnMgZmFsc2UuXG5hc3luYyBmdW5jdGlvbiBmZXRjaE1vdmllUmV2aWV3cyhtb3ZpZV9pZCkge1xuXHR0cnkge1xuXHRcdGxldCByZXZpZXdzID0gW107XG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcblx0XHRcdGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL21vdmllLyR7bW92aWVfaWR9L3Jldmlld3M/YXBpX2tleT0ke0FQSV9LRVl9Jmxhbmd1YWdlPWVuLVVTJnBhZ2U9MWAsXG5cdFx0XHR7IG1vZGU6IFwiY29yc1wiIH1cblx0XHQpO1xuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0aWYgKGRhdGEucmVzdWx0cy5sZW5ndGggPT09IDApIHJldHVybiBmYWxzZTtcblxuXHRcdGxldCBjb3VudCA9IDE7XG5cdFx0ZGF0YS5yZXN1bHRzLmZvckVhY2goKHJldmlldykgPT4ge1xuXHRcdFx0cmV2aWV3cy5wdXNoKHtcblx0XHRcdFx0YXV0aG9yOiByZXZpZXcuYXV0aG9yLFxuXHRcdFx0XHRyYXRpbmc6IHJldmlldy5hdXRob3JfZGV0YWlscy5yYXRpbmcsXG5cdFx0XHRcdHBpY19wYXRoOiByZXZpZXcuYXV0aG9yX2RldGFpbHMuYXZhdGFyX3BhdGgsXG5cdFx0XHRcdGNvbnRlbnQ6IHJldmlldy5jb250ZW50LFxuXHRcdFx0XHR1cmw6IHJldmlldy51cmwsXG5cdFx0XHRcdGxhc3RfdXBkYXRlZDogcmV2aWV3LnVwZGF0ZWRfYXQsXG5cdFx0XHR9KTtcblx0XHRcdGNvdW50Kys7XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHJldmlld3Muc2xpY2UoMCwgNSk7XG5cdH0gY2F0Y2ggKGVycikge1xuXHRcdGFsZXJ0KGVycik7XG5cdH1cbn1cblxuZnVuY3Rpb24gZ2V0Q291bnRyeU5hbWUoY29kZSkge1xuXHRsZXQgcmVnaW9uTmFtZXMgPSBuZXcgSW50bC5EaXNwbGF5TmFtZXMoW1wiZW5cIl0sIHsgdHlwZTogXCJyZWdpb25cIiB9KTtcblx0cmV0dXJuIHJlZ2lvbk5hbWVzLm9mKGNvZGUpO1xufVxuXG5mdW5jdGlvbiBnZXRMYW5ndWFnZShjb2RlKSB7XG5cdGNvbnN0IGxhbmcgPSBuZXcgSW50bC5EaXNwbGF5TmFtZXMoW1wiZW5cIl0sIHsgdHlwZTogXCJsYW5ndWFnZVwiIH0pO1xuXHRyZXR1cm4gbGFuZy5vZihjb2RlKTtcbn1cbmV4cG9ydCB7XG5cdGZldGNoTW92aWVEZXRhaWxzLFxuXHRmZXRjaE1vdmllUmVjY29zLFxuXHRmZXRjaE1vdmllUHJvdmlkZXJzLFxuXHRmZXRjaE1vdmllVHJhaWxlcixcblx0ZmV0Y2hNb3ZpZVJldmlld3MsXG5cdGdldENvdW50cnlOYW1lLFxufTtcbiIsImltcG9ydCAqIGFzIG1vdmllIGZyb20gXCIuLi9hcGlGdW5jdGlvbnMvZmV0Y2hNb3ZpZUluZm9cIjtcblxuLypcbkRyYXcgYW4gaW5kaXZpZHVhbCBzZWN0aW9uIGJhc2VkIG9uIHVzZXIgaW5wdXQgcXVlcnkuXG5UaGlzIHNlY3Rpb24gd2lsbCBjb25zdHMgb2YgdGhlIG92ZXJhbGwgbW92aWUvdHYncyBcbiAgICAtIERldGFpbHMsXG4gICAgLSBUaGUgd2F0Y2ggcHJvdmlkZXJzIGJhc2VkIG9uIHNwZWNpZmljIGNvdW50cmllc1xuICAgIC0gQXZhaWxhYmxlIHRyYWlsZXJzLFxuICAgIC0gT3RoZXIgcmVjb21tZW5kYXRpb25zLlxuICAgIC0gUmV2aWV3cyBieSBlc3RhYmxpc2hlZCBhdXRob3JzIGJhc2VkIGZyb20gcmFuZG9tIHNvdXJjZXMuXG4qL1xuXG5jb25zdCBkcmF3U2VjdGlvbiA9IGFzeW5jIChpZCwgbWVkaWEpID0+IHtcblx0Y29uc3Qgc2VjdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzZWN0aW9uXCIpO1xuXHRjb25zdCBkZXRhaWxzID0gYXdhaXQgZ2V0SW5mbyhpZCwgbW92aWUuZmV0Y2hNb3ZpZURldGFpbHMsIFwiXCIpO1xuXHRjb25zdCByZWNzID0gYXdhaXQgZ2V0SW5mbyhpZCwgbW92aWUuZmV0Y2hNb3ZpZVJlY2NvcywgXCJcIik7XG5cdGNvbnN0IHByb3ZpZGVycyA9IGF3YWl0IGdldEluZm8oaWQsIG1vdmllLmZldGNoTW92aWVQcm92aWRlcnMsIFwiXCIpO1xuXHRjb25zdCB0cmFpbGVyID0gYXdhaXQgZ2V0SW5mbyhpZCwgbW92aWUuZmV0Y2hNb3ZpZVRyYWlsZXIsIFwiXCIpO1xuXHRjb25zdCByZXZpZXdzID0gYXdhaXQgZ2V0SW5mbyhpZCwgbW92aWUuZmV0Y2hNb3ZpZVJldmlld3MsIFwiXCIpO1xuXG5cdGZ1bmN0aW9uIGRyYXdBbGwoKSB7XG5cdFx0YWRkVG9TZWN0aW9uKGRyYXdJbnRybygpKTtcblx0fVxuXG5cdGZ1bmN0aW9uIGFkZFRvU2VjdGlvbihwYXJ0KSB7XG5cdFx0c2VjdGlvbi5hcHBlbmRDaGlsZChwYXJ0KTtcblx0fVxuXG5cdGFzeW5jIGZ1bmN0aW9uIGdldEluZm8oaWQsIG1vdmllRm5jLCB0dkZuYykge1xuXHRcdHJldHVybiBtZWRpYSA9PT0gXCJtb3ZpZVwiID8gYXdhaXQgbW92aWVGbmMoaWQpIDogXCJcIjtcblx0fVxuXG5cdC8vIERyYXcgKGlmIGFueSkgdGl0bGUsIHBob3RvLCB0YWdsaW5lLCBhbmQgc3VtbWFyeS5cblx0Y29uc3QgZHJhd0ludHJvID0gKGltZ1NpemUpID0+IHtcblx0XHRjb25zdCBpbnRyb0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0aW50cm9Db250YWluZXIuY2xhc3NMaXN0LmFkZChcImludHJvXCIpO1xuXG5cdFx0aW50cm9Db250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlVGl0bGUoKSk7XG5cdFx0ZGV0YWlscy50YWdsaW5lID8gaW50cm9Db250YWluZXIuYXBwZW5kQ2hpbGQod3JpdGVUYWdsaW5lKCkpIDogXCJcIjtcblxuXHRcdGNvbnN0IGltZyA9IHJlbmRlckltZyhpbWdTaXplKTtcblx0XHRpbWcgPyBpbnRyb0NvbnRhaW5lci5hcHBlbmRDaGlsZChpbWcpIDogXCJcIjtcblxuXHRcdGludHJvQ29udGFpbmVyLmFwcGVuZENoaWxkKHdyaXRlU3VtbWFyeSgpKTtcblxuXHRcdGZ1bmN0aW9uIGNyZWF0ZVRpdGxlKCkge1xuXHRcdFx0Y29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDFcIik7XG5cdFx0XHR0aXRsZS50ZXh0Q29udGVudCA9IGRldGFpbHMubU5hbWU7XG5cdFx0XHR0aXRsZS5jbGFzc0xpc3QuYWRkKFwidGl0bGVcIik7XG5cdFx0XHRyZXR1cm4gdGl0bGU7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gcmVuZGVySW1nKGltZ1NpemUgPSBcIlwiKSB7XG5cdFx0XHRjb25zdCBwb3N0ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xuXHRcdFx0Y29uc3QgYmFzZUltZ1VybCA9IFwiaHR0cHM6Ly9pbWFnZS50bWRiLm9yZy90L3BcIjtcblx0XHRcdGxldCBpbWdfcGF0aDtcblx0XHRcdHBvc3Rlci5jbGFzc0xpc3QuYWRkKFwicG9zdGVyXCIpO1xuXG5cdFx0XHRpZiAoZGV0YWlscy5wb3N0ZXJfcGF0aCkge1xuXHRcdFx0XHRpbWdfcGF0aCA9IGRldGFpbHMucG9zdGVyX3BhdGg7XG5cdFx0XHR9IGVsc2UgaWYgKGRldGFpbHMuYmFja2Ryb3BfcGF0aCkge1xuXHRcdFx0XHRpbWdfcGF0aCA9IGRldGFpbHMuYmFja2Ryb3BfcGF0aDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdCFpbWdTaXplXG5cdFx0XHRcdD8gKHBvc3Rlci5zcmMgPSBgJHtiYXNlSW1nVXJsfS9vcmlnaW5hbC8ke2ltZ19wYXRofWApXG5cdFx0XHRcdDogKHBvc3Rlci5zcmMgPSBgJHtiYXNlSW1nVXJsfS93JHtpbWdTaXplfS8ke2ltZ19wYXRofWApO1xuXHRcdFx0cG9zdGVyLmFsdCA9IFwiTW92aWUgcGljdHVyZSBwb3N0ZXJcIjtcblx0XHRcdHJldHVybiBwb3N0ZXI7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gd3JpdGVUYWdsaW5lKCkge1xuXHRcdFx0Y29uc3QgdGFnUGFyYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuXHRcdFx0dGFnUGFyYS50ZXh0Q29udGVudCA9IGRldGFpbHMudGFnbGluZTtcblx0XHRcdHRhZ1BhcmEuY2xhc3NMaXN0LmFkZChcInRhZ2xpbmVcIik7XG5cdFx0XHRyZXR1cm4gdGFnUGFyYTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiB3cml0ZVN1bW1hcnkoKSB7XG5cdFx0XHRjb25zdCBwYXJhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XG5cdFx0XHRwYXJhLnRleHRDb250ZW50ID0gZGV0YWlscy5zdW1tYXJ5O1xuXHRcdFx0cGFyYS5jbGFzc0xpc3QuYWRkKFwic3VtbWFyeVwiKTtcblx0XHRcdHJldHVybiBwYXJhO1xuXHRcdH1cblx0XHRyZXR1cm4gaW50cm9Db250YWluZXI7XG5cdH07XG5cblx0Y29uc3QgZHJhd1N1YkluZm9zID0gKCkgPT4ge1xuXHRcdGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJzdWJpbmZvLWNvbnRhaW5lclwiKTtcblxuXHRcdGNvbnN0IGluZm9ybWF0aW9uID0gW1xuXHRcdFx0Y3JlYXRlU3ViSW5mbyhcIkdlbnJlczpcIiwgZGV0YWlscy5nZW5yZXMuam9pbihcIiwgXCIpKSxcblx0XHRcdGNyZWF0ZVN1YkluZm8oXCJSdW50aW1lOlwiLCBjb252ZXJ0TWluVG9IcihkZXRhaWxzLnJ1bnRpbWUpKSxcblx0XHRcdGNyZWF0ZVN1YkluZm8oXCJWb3RlIEF2ZXJhZ2U6XCIsIGRldGFpbHMudm90ZV9hdmVyYWdlKSxcblx0XHRcdGNyZWF0ZVN1YkluZm8oXCJWb3RlIENvdW50OlwiLCBkZXRhaWxzLnZvdGVfY291bnQpLFxuXHRcdFx0Y3JlYXRlU3ViSW5mbyhcIlBvcHVsYXJpdHk6XCIsIGRldGFpbHMucG9wdWxhcml0eSksXG5cdFx0XTtcblxuXHRcdGluZm9ybWF0aW9uLmZvckVhY2goKGluZm8pID0+IGNvbnRhaW5lci5hcHBlbmRDaGlsZChpbmZvKSk7XG5cblx0XHRmdW5jdGlvbiBjcmVhdGVTdWJJbmZvKGNhdGVnb3J5LCBpbmZvKSB7XG5cdFx0XHRjb25zdCBzdWJJbmZvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcdGNvbnN0IGNhdGVnb3J5TmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuXHRcdFx0Y29uc3QgY2F0ZWdvcnlJbmZvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cblx0XHRcdHN1YkluZm8uY2xhc3NMaXN0LmFkZChcInN1Yi1pbmZvXCIpO1xuXHRcdFx0Y2F0ZWdvcnlOYW1lLmNsYXNzTGlzdC5hZGQoXCJjYXRlZ29yeS1uYW1lXCIpO1xuXHRcdFx0Y2F0ZWdvcnlJbmZvLmNsYXNzTGlzdC5hZGQoXCJjYXRlZ29yeS1pbmZvXCIpO1xuXG5cdFx0XHRjYXRlZ29yeU5hbWUudGV4dENvbnRlbnQgPSBjYXRlZ29yeTtcblx0XHRcdGNhdGVnb3J5SW5mby50ZXh0Q29udGVudCA9IGluZm87XG5cblx0XHRcdFtjYXRlZ29yeU5hbWUsIGNhdGVnb3J5SW5mb10uZm9yRWFjaCgoaW5mbykgPT4gc3ViSW5mby5hcHBlbmRDaGlsZChpbmZvKSk7XG5cdFx0XHRyZXR1cm4gc3ViSW5mbztcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBjb252ZXJ0TWluVG9IcihtaW5zKSB7XG5cdFx0XHRjb25zdCBob3VycyA9IG1pbnMgLyA2MDtcblx0XHRcdGNvbnN0IHJIb3VycyA9IE1hdGguZmxvb3IoaG91cnMpO1xuXHRcdFx0Y29uc3QgbWludXRlcyA9IChob3VycyAtIHJIb3VycykgKiA2MDtcblx0XHRcdGNvbnN0IHJNaW51dGVzID0gTWF0aC5yb3VuZChtaW51dGVzKTtcblx0XHRcdHJldHVybiBgJHtySG91cnN9aCAke3JNaW51dGVzfW1pbmA7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGNvbnRhaW5lcjtcblx0fTtcblxuXHRjb25zdCBkcmF3UHJvdmlkZXJzID0gKCkgPT4ge1xuXHRcdC8vIEhvdXNlcyB0aGUgYnRuIHRoYXQgb3BlbnMgdGhlIG1vZGFsIGFuZCBvdmVybGF5LCBhbmQgdGhlIGF2YWlsYWJsZSBwcm92aWRlcnMgZm9yICdzdHJlYW1pbmcnLCAncmVudCcgYW5kICdwdXJjaGFzZScuXG5cdFx0ZnVuY3Rpb24gcmVuZGVyRWxlbWVudCh0YWcsIGNsYXNzTmFtZSkge1xuXHRcdFx0Y29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpO1xuXHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcblx0XHRcdHJldHVybiBjb250YWluZXI7XG5cdFx0fVxuXHRcdGNvbnN0IHByb3ZpZGVyQ29udGFpbmVyID0gcmVuZGVyRWxlbWVudChcImRpdlwiLCBcInByb3ZpZGVyLWNvbnRhaW5lclwiKTtcblx0XHRjb25zdCBjb3VudHJ5QnRuID0gcmVuZGVyRWxlbWVudChcImJ1dHRvblwiLCBcImNvdW50cnktYnRuXCIpO1xuXHRcdGNvbnN0IGhvdXNlQ29udGFpbmVyID0gcmVuZGVyRWxlbWVudChcImRpdlwiLCBcImhvdXNlLXByb3ZpZGVyLWNvbnRhaW5lclwiKTtcblx0XHRbY291bnRyeUJ0biwgaG91c2VDb250YWluZXJdLmZvckVhY2goKGVsZW0pID0+IHtcblx0XHRcdHByb3ZpZGVyQ29udGFpbmVyLmFwcGVuZENoaWxkKGVsZW0pO1xuXHRcdH0pO1xuXG5cdFx0Ly8gU2VhcmNoIGZvciBkZWZhdWx0IGNvdW50cnkgXCJBdXN0cmFsaWFcIi4gSWYgbm9uZSBmb3VuZC4gRHJhdyB0aGUgZmlyc3QgY291bnRyeSdzIHByb3ZpZGVyLlxuXHRcdGlmIChPYmplY3Qua2V5cyhwcm92aWRlcnMpLmxlbmd0aCkge1xuXHRcdFx0T2JqZWN0LmtleXMocHJvdmlkZXJzKS5pbmNsdWRlcyhcIkF1c3RyYWxpYVwiKVxuXHRcdFx0XHQ/IGRyYXdQcm92aWRlcihcIkF1c3RyYWxpYVwiKVxuXHRcdFx0XHQ6IGRyYXdQcm92aWRlcihPYmplY3Qua2V5cyhwcm92aWRlcnMpWzBdKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y291bnRyeUJ0bi50ZXh0Q29udGVudCA9XG5cdFx0XHRcdFwiTm8gY291bnRyaWVzIG9mZmVyIHRoaXMgdHYvbW92aWUgYXQgdGhlIG1vbWVudC5cIjtcblx0XHR9XG5cblx0XHRyZXR1cm4gcHJvdmlkZXJDb250YWluZXI7XG5cblx0XHRmdW5jdGlvbiBkcmF3UHJvdmlkZXIoY291bnRyeU5hbWUgPSBcIkF1c3RyYWxpYVwiKSB7XG5cdFx0XHQvLyBDaGFuZ2UgdGV4dCBvZiBidG4gdG8gY291bnRyeU5hbWVcblx0XHRcdGNvdW50cnlCdG4udGV4dENvbnRlbnQgPSBjb3VudHJ5TmFtZTtcblxuXHRcdFx0Y29uc3Qgc3RyZWFtSW5mbyA9IHByb3ZpZGVyc1tjb3VudHJ5TmFtZV0uc3RyZWFtO1xuXHRcdFx0Y29uc3QgYnV5SW5mbyA9IHByb3ZpZGVyc1tjb3VudHJ5TmFtZV0uYnV5O1xuXHRcdFx0Y29uc3QgcmVudEluZm8gPSBwcm92aWRlcnNbY291bnRyeU5hbWVdLnJlbnQ7XG5cblx0XHRcdGNvbnN0IHNlcnZpY2VOYW1lcyA9IFtcIlN0cmVhbSBhdDpcIiwgXCJQdXJjaGFzZSBhdDpcIiwgXCJSZW50IGF0OlwiXTtcblx0XHRcdC8vIFRvIGFzc2lnbiBuYW1lcyBmb3IgZWFjaCBzZXZpY2UgcHJvdmlkZXJzLlxuXHRcdFx0Ly8gVGhpcyBpbmNyZW1lbnRzIGFzIHByb3ZpZGVycyBhcmUgbGlzdGVkIGZvciBlYWNoIHNlcnZpY2UuXG5cdFx0XHRsZXQgaWR4ID0gMDtcblxuXHRcdFx0W3N0cmVhbUluZm8sIGJ1eUluZm8sIHJlbnRJbmZvXS5mb3JFYWNoKChpbmZvKSA9PiB7XG5cdFx0XHRcdGNvbnN0IHNlcnZpY2VDb250YWluZXIgPSByZW5kZXJFbGVtZW50KFwiZGl2XCIsIFwic2VydmljZS1jb250YWluZXJcIik7XG5cdFx0XHRcdGNvbnN0IHNlcnZpY2VOYW1lID0gcmVuZGVyRWxlbWVudChcImRpdlwiLCBcInNlcnZpY2UtbmFtZVwiKTtcblx0XHRcdFx0Y29uc3Qgc2VydmljZU5hbWVCb2xkID0gcmVuZGVyRWxlbWVudChcImgyXCIsIFwic2VydmljZS1uYW1lLWJvbGRcIik7XG5cdFx0XHRcdGNvbnN0IHByb3ZpZGVyU2VydmljZUNvbnRhaW5lciA9IHJlbmRlckVsZW1lbnQoXG5cdFx0XHRcdFx0XCJkaXZcIixcblx0XHRcdFx0XHRcInByb3ZpZGVyLXNlcnZpY2UtY29udGFpbmVyXCJcblx0XHRcdFx0KTtcblxuXHRcdFx0XHRpbmZvLmZvckVhY2goKHByb3ZpZGVyKSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgcHJvdmlkZXJTZXJ2aWNlID0gcmVuZGVyRWxlbWVudChcImRpdlwiLCBcInByb3ZpZGVyLXNlcnZpY2VcIik7XG5cdFx0XHRcdFx0Ly8gQWRkIGltZyBhbmQgbmFtZSBvZiBwcm92aWRlci5cblx0XHRcdFx0XHRjb25zdCBwcm92aWRlckltZyA9IHJlbmRlckVsZW1lbnQoXCJpbWdcIiwgXCJwcm92aWRlci1pbWdcIik7XG5cdFx0XHRcdFx0Y29uc3QgcHJvdmlkZXJOYW1lID0gcmVuZGVyRWxlbWVudChcInNwYW5cIiwgXCJwcm92aWRlci1uYW1lXCIpO1xuXG5cdFx0XHRcdFx0aWYgKHByb3ZpZGVyLnByb3ZpZGVyX2xvZ29fcGF0aCkge1xuXHRcdFx0XHRcdFx0cHJvdmlkZXJJbWcuc3JjID0gYGh0dHBzOi8vaW1hZ2UudG1kYi5vcmcvdC9wL29yaWdpbmFsLyR7cHJvdmlkZXIucHJvdmlkZXJfbG9nb19wYXRofWA7XG5cdFx0XHRcdFx0XHRwcm92aWRlckltZy5hbHQgPSBgJHtwcm92aWRlci5wcm92aWRlcl9uYW1lfSBwaWN0dXJlLmA7XG5cdFx0XHRcdFx0XHRwcm92aWRlck5hbWUudGV4dENvbnRlbnQgPSBwcm92aWRlci5wcm92aWRlcl9uYW1lO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFtwcm92aWRlckltZywgcHJvdmlkZXJOYW1lXS5mb3JFYWNoKChlbGVtKSA9PiB7XG5cdFx0XHRcdFx0XHRwcm92aWRlclNlcnZpY2UuYXBwZW5kQ2hpbGQoZWxlbSk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0cHJvdmlkZXJTZXJ2aWNlQ29udGFpbmVyLmFwcGVuZENoaWxkKHByb3ZpZGVyU2VydmljZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGlmIChpbmZvLmxlbmd0aCkge1xuXHRcdFx0XHRcdHNlcnZpY2VOYW1lQm9sZC50ZXh0Q29udGVudCA9IGAke3NlcnZpY2VOYW1lc1tpZHhdfWA7XG5cdFx0XHRcdFx0c2VydmljZU5hbWUuYXBwZW5kQ2hpbGQoc2VydmljZU5hbWVCb2xkKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZHgrKztcblx0XHRcdFx0c2VydmljZUNvbnRhaW5lci5hcHBlbmRDaGlsZChzZXJ2aWNlTmFtZSk7XG5cdFx0XHRcdHNlcnZpY2VDb250YWluZXIuYXBwZW5kQ2hpbGQocHJvdmlkZXJTZXJ2aWNlQ29udGFpbmVyKTtcblx0XHRcdFx0aG91c2VDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VydmljZUNvbnRhaW5lcik7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH07XG5cdHJldHVybiB7XG5cdFx0c2VjdGlvbixcblx0XHRhZGRUb1NlY3Rpb24sXG5cdFx0ZHJhd0FsbCxcblx0XHRkcmF3SW50cm8sXG5cdFx0ZHJhd1N1YkluZm9zLFxuXHRcdGRyYXdQcm92aWRlcnMsXG5cdH07XG59O1xuXG5leHBvcnQgeyBkcmF3U2VjdGlvbiB9O1xuIiwiaW1wb3J0IGNvbGxlY3RTZWFyY2hRdWVyeSBmcm9tIFwiLi9zZWFyY2hcIjtcbmltcG9ydCB7IGZldGNoSWRzIH0gZnJvbSBcIi4uL2FwaUZ1bmN0aW9ucy9mZXRjaElkXCI7XG5pbXBvcnQgKiBhcyBtb3ZpZSBmcm9tIFwiLi4vYXBpRnVuY3Rpb25zL2ZldGNoTW92aWVJbmZvXCI7XG5pbXBvcnQgeyBkcmF3U2VjdGlvbiB9IGZyb20gXCIuL2RyYXdTZWN0aW9uXCI7XG5cbmFzeW5jIGZ1bmN0aW9uIGRyYXdTZWN0aW9ucyh0aXRsZSkge1xuXHRjb25zdCBpZHMgPSBhd2FpdCBmZXRjaElkcyh0aXRsZSk7XG5cdGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4tY29udGFpbmVyXCIpO1xuXHRsZXQgc2VjdGlvbnMgPSBbXTtcblxuXHQvLyBNYWtlIGFuIGFyciB3LyBlbGVtcyBvZiBbaWQsIG1lZGlhXVxuXHRmb3IgKGxldCBpZCBpbiBpZHMpIHtcblx0XHQvLyBUZW1wIG1ha2UgaXQgc28gdGhhdCBpdCBvbmx5IGFjY2VwdHMgbW92aWVzXG5cblx0XHRpZHNbaWRdID09PSBcIm1vdmllXCIgPyBzZWN0aW9ucy5wdXNoKFtpZCwgaWRzW2lkXV0pIDogXCJcIjtcblx0fVxuXG5cdHNlY3Rpb25zLmZvckVhY2goXG5cdFx0YXN5bmMgKHNlY3Rpb24pID0+IGF3YWl0IHJlbmRlclNlY3Rpb24oc2VjdGlvblswXSwgc2VjdGlvblsxXSlcblx0KTtcblxuXHRhc3luYyBmdW5jdGlvbiByZW5kZXJTZWN0aW9uKGlkLCBtZWRpYSkge1xuXHRcdGNvbnN0IHNlY3Rpb24gPSBhd2FpdCBkcmF3U2VjdGlvbihpZCwgbWVkaWEpO1xuXHRcdHNlY3Rpb24uYWRkVG9TZWN0aW9uKHNlY3Rpb24uZHJhd0ludHJvKFwiMzAwXCIpKTtcblx0XHRzZWN0aW9uLmFkZFRvU2VjdGlvbihzZWN0aW9uLmRyYXdTdWJJbmZvcygpKTtcblx0XHRzZWN0aW9uLmFkZFRvU2VjdGlvbihzZWN0aW9uLmRyYXdQcm92aWRlcnMoKSk7XG5cdFx0bWFpbi5hcHBlbmRDaGlsZChzZWN0aW9uLnNlY3Rpb24pO1xuXHRcdHJldHVybiByZW5kZXJTZWN0aW9uO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGNsZWFyU2VjdGlvbnMoKSB7XG5cdGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4tY29udGFpbmVyXCIpO1xuXHRtYWluLmlubmVySFRNTCA9IFwiXCI7XG59XG5cbmV4cG9ydCB7IGRyYXdTZWN0aW9ucywgY2xlYXJTZWN0aW9ucyB9O1xuIiwiaW1wb3J0IHsgZHJhd1NlY3Rpb25zIH0gZnJvbSBcIi4vanMvRE9NRnVuY3Rpb25zL2RyYXdTZWN0aW9uc1wiO1xuaW1wb3J0IGFkZFN1Ym1pdFNlYXJjaEZuYyBmcm9tIFwiLi9qcy9VSS9zdWJtaXRTZWFyY2hcIjtcblxuY29uc29sZS5sb2coXCJIZWxsbyBXb3JsZFwiKTtcbi8vIGZldGNoSWRzKCdJUk9OIE1BTicpO1xuXG4vLyBmZXRjaE1vdmllRHVtbXkoMTcyNik7XG4vLyBmZXRjaE1vdmllRHVtbXkoMzA5Nyk7IC8vIGZhaWwgdG8gZmV0Y2ggYmVjYXVzZSBpdHMgdHYuXG4vLyBmZXRjaE1vdmllRHVtbXkoMTAxMzgpO1xuLy8gZmV0Y2hNb3ZpZUR1bW15KDY4NzIxKTtcblxuLy8gYXN5bmMgZnVuY3Rpb24gZmV0Y2hNb3ZpZUR1bW15KGlkKSB7XG4vLyAgICAgY29uc3QgbW92aWVEZXRhaWxzID0gYXdhaXQgbW92aWUuZmV0Y2hNb3ZpZURldGFpbHMoaWQpO1xuLy8gICAgIGNvbnN0IG1vdmllUmVjY29zID0gYXdhaXQgbW92aWUuZmV0Y2hNb3ZpZVJlY2NvcyhpZCk7XG4vLyAgICAgY29uc3QgbW92aWVQcm92aWRlcnMgPSBhd2FpdCBtb3ZpZS5mZXRjaE1vdmllUHJvdmlkZXJzKGlkKTtcbi8vICAgICBjb25zdCBtb3ZpZVRyYWlsZXIgPSBhd2FpdCBtb3ZpZS5mZXRjaE1vdmllVHJhaWxlcihpZCk7XG4vLyAgICAgY29uc3QgbW92aWVSZXZpZXdzID0gYXdhaXQgbW92aWUuZmV0Y2hNb3ZpZVJldmlld3MoaWQpO1xuLy8gICAgIGNvbnNvbGUubG9nKG1vdmllRGV0YWlscyk7XG4vLyAgICAgY29uc29sZS5sb2cobW92aWVSZWNjb3MpO1xuLy8gICAgIGNvbnNvbGUubG9nKG1vdmllUHJvdmlkZXJzKTtcbi8vICAgICBjb25zb2xlLmxvZyhtb3ZpZVRyYWlsZXIpO1xuLy8gICAgIGNvbnNvbGUubG9nKG1vdmllUmV2aWV3cyk7XG4vLyB9XG5cbi8vIGFkZFN1Ym1pdFNlYXJjaEZ1bmN0aW9uKCk7XG5cbmFkZFN1Ym1pdFNlYXJjaEZuYygpO1xuZHJhd1NlY3Rpb25zKFwiaXJvbiBtYW5cIik7XG4vLyBkcmF3U2VjdGlvbnMoXCJwZWUgbWFrXCIpO1xuIiwiaW1wb3J0IHsgZHJhd1NlY3Rpb25zLCBjbGVhclNlY3Rpb25zIH0gZnJvbSBcIi4uL0RPTUZ1bmN0aW9ucy9kcmF3U2VjdGlvbnNcIjtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gYWRkU3VibWl0U2VhcmNoRm5jKCkge1xuXHRjb25zdCBzZWFyY2hCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNlYXJjaC1xdWVyeVwiKTtcblx0c2VhcmNoQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoZSkgPT4ge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRjb25zdCBxdWVyeSA9IGludGVycHJldFRvUXVlcnkoXG5cdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImlucHV0LXNlYXJjaFwiKS52YWx1ZVxuXHRcdCk7XG5cdFx0aWYgKCFxdWVyeSkge1xuXHRcdFx0YWxlcnQoXCJQbGVhc2UgZW50ZXIgYSB2YWxpZCBtb3ZpZS90diBzaG93XCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRjbGVhclNlY3Rpb25zKCk7XG5cdFx0YXdhaXQgZHJhd1NlY3Rpb25zKHF1ZXJ5KTtcblxuXHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2VhcmNoLXF1ZXJ5XCIpLnZhbHVlID0gXCJcIjtcblx0fSk7XG59XG5cbmZ1bmN0aW9uIGludGVycHJldFRvUXVlcnkobmFtZSkge1xuXHRyZXR1cm4gbmFtZS5zcGxpdChcIiBcIikuam9pbihcIitcIik7XG59XG4iXSwibmFtZXMiOlsiQVBJX0tFWSIsImFzeW5jIiwiZmV0Y2hNb3ZpZURldGFpbHMiLCJtb3ZpZV9pZCIsInJlc3BvbnNlIiwiZmV0Y2giLCJtb2RlIiwiZGF0YSIsImpzb24iLCJnZW5yZXMiLCJyZWR1Y2UiLCJhY2MiLCJ2YWwiLCJuYW1lIiwibU5hbWUiLCJvcmlnaW5hbF90aXRsZSIsInN1bW1hcnkiLCJvdmVydmlldyIsInRhZ2xpbmUiLCJwb3B1bGFyaXR5Iiwidm90ZV9hdmVyYWdlIiwidm90ZV9jb3VudCIsInZpZGVvIiwicnVudGltZSIsInBvc3Rlcl9wYXRoIiwiYmFja2Ryb3BfcGF0aCIsImVyciIsImFsZXJ0IiwiZmV0Y2hNb3ZpZVJlY2NvcyIsInJlY01vdmllcyIsInJlc3VsdHMiLCJjb3VudCIsIm1vdmllIiwiaWQiLCJmZXRjaE1vdmllUHJvdmlkZXJzIiwicHJvdmlkZXJzQnlDb3VudHJ5IiwiY291bnRyeUNvZGUiLCJjb3VudHJ5IiwiY29kZSIsIkludGwiLCJEaXNwbGF5TmFtZXMiLCJ0eXBlIiwib2YiLCJzdHJlYW0iLCJyZW50IiwiYnV5Iiwic29ydFByb3ZpZGVycyIsInNlcnZpY2VzIiwiY29sbGVjdGlvbiIsImZvckVhY2giLCJzZXJ2aWNlIiwicHJvdmlkZXJJbmZvIiwicHJvdmlkZXJfbmFtZSIsInByb3ZpZGVyX2xvZ29fcGF0aCIsImxvZ29fcGF0aCIsInB1c2giLCJmbGF0cmF0ZSIsImZldGNoTW92aWVUcmFpbGVyIiwibW92aWVUcmFpbGVyIiwidHJhaWxlcnMiLCJmaWx0ZXIiLCJsZW5ndGgiLCJvZmZpY2lhbCIsImtleSIsInNpdGUiLCJsYW5nIiwiaXNvXzYzOV8xIiwiZmV0Y2hNb3ZpZVJldmlld3MiLCJyZXZpZXdzIiwicmV2aWV3IiwiYXV0aG9yIiwicmF0aW5nIiwiYXV0aG9yX2RldGFpbHMiLCJwaWNfcGF0aCIsImF2YXRhcl9wYXRoIiwiY29udGVudCIsInVybCIsImxhc3RfdXBkYXRlZCIsInVwZGF0ZWRfYXQiLCJzbGljZSIsImRyYXdTZWN0aW9uIiwibWVkaWEiLCJzZWN0aW9uIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiZGV0YWlscyIsImdldEluZm8iLCJwcm92aWRlcnMiLCJhZGRUb1NlY3Rpb24iLCJwYXJ0IiwiYXBwZW5kQ2hpbGQiLCJtb3ZpZUZuYyIsInR2Rm5jIiwiZHJhd0ludHJvIiwiaW1nU2l6ZSIsImludHJvQ29udGFpbmVyIiwiY2xhc3NMaXN0IiwiYWRkIiwidGl0bGUiLCJ0ZXh0Q29udGVudCIsImNyZWF0ZVRpdGxlIiwidGFnUGFyYSIsIndyaXRlVGFnbGluZSIsImltZyIsInBvc3RlciIsImJhc2VJbWdVcmwiLCJpbWdfcGF0aCIsInNyYyIsImFsdCIsInJlbmRlckltZyIsInBhcmEiLCJ3cml0ZVN1bW1hcnkiLCJkcmF3QWxsIiwiZHJhd1N1YkluZm9zIiwiY29udGFpbmVyIiwiY3JlYXRlU3ViSW5mbyIsImNhdGVnb3J5IiwiaW5mbyIsInN1YkluZm8iLCJjYXRlZ29yeU5hbWUiLCJjYXRlZ29yeUluZm8iLCJqb2luIiwibWlucyIsImhvdXJzIiwickhvdXJzIiwiTWF0aCIsImZsb29yIiwibWludXRlcyIsInJvdW5kIiwiY29udmVydE1pblRvSHIiLCJkcmF3UHJvdmlkZXJzIiwicmVuZGVyRWxlbWVudCIsInRhZyIsImNsYXNzTmFtZSIsInByb3ZpZGVyQ29udGFpbmVyIiwiY291bnRyeUJ0biIsImhvdXNlQ29udGFpbmVyIiwiZWxlbSIsIk9iamVjdCIsImtleXMiLCJpbmNsdWRlcyIsImRyYXdQcm92aWRlciIsImNvdW50cnlOYW1lIiwic3RyZWFtSW5mbyIsImJ1eUluZm8iLCJyZW50SW5mbyIsInNlcnZpY2VOYW1lcyIsImlkeCIsInNlcnZpY2VDb250YWluZXIiLCJzZXJ2aWNlTmFtZSIsInNlcnZpY2VOYW1lQm9sZCIsInByb3ZpZGVyU2VydmljZUNvbnRhaW5lciIsInByb3ZpZGVyIiwicHJvdmlkZXJTZXJ2aWNlIiwicHJvdmlkZXJJbWciLCJwcm92aWRlck5hbWUiLCJkcmF3U2VjdGlvbnMiLCJpZHMiLCJxdWVyeSIsInNwbGl0IiwiaW50ZXJwcmV0VG9RdWVyeSIsInJlc3VsdCIsInNvcnQiLCJwMSIsInAyIiwiaSIsIm1lZGlhX3R5cGUiLCJmZXRjaElkcyIsIm1haW4iLCJxdWVyeVNlbGVjdG9yIiwic2VjdGlvbnMiLCJyZW5kZXJTZWN0aW9uIiwiY29uc29sZSIsImxvZyIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJnZXRFbGVtZW50QnlJZCIsInZhbHVlIiwiaW5uZXJIVE1MIiwiYWRkU3VibWl0U2VhcmNoRm5jIl0sInNvdXJjZVJvb3QiOiIifQ==