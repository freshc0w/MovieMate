(()=>{"use strict";const t="720d2150cf09bfa61e28a5042cd7468f",e="720d2150cf09bfa61e28a5042cd7468f";async function n(t){try{const n=await fetch(`https://api.themoviedb.org/3/movie/${t}?api_key=${e}&language=en-US`,{mode:"cors"}),a=await n.json(),o=a.genres.reduce(((t,e)=>[...t,e.name]),[]);return{mName:a.original_title,summary:a.overview,tagline:a.tagline,popularity:a.popularity,vote_average:a.vote_average,vote_count:a.vote_count,genres:o,video:a.video,runtime:a.runtime,poster_path:a.poster_path,backdrop_path:a.backdrop_path}}catch(t){alert(t)}}async function a(t){try{const n=await fetch(`https://api.themoviedb.org/3/movie/${t}/recommendations?api_key=${e}&language=en-US&page=1`,{mode:"cors"}),a=await n.json(),o={};if(a.results){let t=1;for(let e of a.results){if(o[e.original_title]={mName:e.original_title,id:e.id,poster_path:e.poster_path,backdrop_path:e.backdrop_path},5===t)break;t++}}return o}catch(t){alert(t)}}async function o(t){const n={};try{const o=await fetch(`https://api.themoviedb.org/3/movie/${t}/watch/providers?api_key=${e}`,{mode:"cors"}),r=await o.json();for(const t in r.results){const e=(a=t,new Intl.DisplayNames(["en"],{type:"region"}).of(a));n[e]={stream:[],rent:[],buy:[]};const o=(t,e)=>{t&&t.forEach((t=>{const n={provider_name:t.provider_name,provider_logo_path:t.logo_path};e.push(n)}))};o(r.results[t].flatrate,n[e].stream),o(r.results[t].rent,n[e].rent),o(r.results[t].buy,n[e].buy)}return console.log(n),n}catch(t){alert(t)}var a}async function r(t){try{let a;const o=await fetch(`https://api.themoviedb.org/3/movie/${t}/videos?api_key=${e}`,{mode:"cors"}),r=(await o.json()).results.filter((t=>"Trailer"===t.type));if(0===r.length)return!1;const i=r.filter((t=>{t.official}));return a=0!==i.length?i[0]:r[0],{mName:a.name,key:a.key,site:a.site,type:a.type,lang:(n=a.iso_639_1,new Intl.DisplayNames(["en"],{type:"language"}).of(n))}}catch(t){alert(t)}var n}async function i(t){try{let n=[];const a=await fetch(`https://api.themoviedb.org/3/movie/${t}/reviews?api_key=${e}&language=en-US&page=1`,{mode:"cors"}),o=await a.json();if(console.log(o),0===o.results.length)return!1;let r=1;return o.results.forEach((t=>{n.push({author:t.author,rating:t.author_details.rating,pic_path:t.author_details.avatar_path,content:t.content,url:t.url,last_updated:t.updated_at}),r++})),n.slice(0,5)}catch(t){alert(t)}}const c=async(t,e)=>{const c=document.createElement("section"),s=await u(t,n),l=(await u(t,a),await u(t,o));function d(t){c.appendChild(t)}async function u(t,n,a){return"movie"===e?await n(t):""}await u(t,r),await u(t,i);const p=t=>{const e=document.createElement("div");e.classList.add("intro"),e.appendChild(function(){const t=document.createElement("h1");return t.textContent=s.mName,t.classList.add("title"),t}()),s.tagline&&e.appendChild(function(){const t=document.createElement("p");return t.textContent=s.tagline,t.classList.add("tagline"),t}());const n=function(t=""){const e=document.createElement("img"),n="https://image.tmdb.org/t/p";let a;if(e.classList.add("poster"),s.poster_path)a=s.poster_path;else{if(!s.backdrop_path)return;a=s.backdrop_path}return e.src=t?`${n}/w${t}/${a}`:`${n}/original/${a}`,e.alt="Movie picture poster",e}(t);return n&&e.appendChild(n),e.appendChild(function(){const t=document.createElement("p");return t.textContent=s.summary,t.classList.add("summary"),t}()),e};return{section:c,addToSection:d,drawAll:function(){d(p())},drawIntro:p,drawSubInfos:()=>{const t=document.createElement("div");function e(t,e){const n=document.createElement("div"),a=document.createElement("span"),o=document.createElement("span");return n.classList.add("sub-info"),a.classList.add("category-name"),o.classList.add("category-info"),a.textContent=t,o.textContent=e,[a,o].forEach((t=>n.appendChild(t))),n}return t.classList.add("subinfo-container"),[e("Genres:",s.genres.join(", ")),e("Runtime:",function(t){const e=t/60,n=Math.floor(e),a=60*(e-n);return`${n}h ${Math.round(a)}min`}(s.runtime)),e("Vote Average:",s.vote_average),e("Vote Count:",s.vote_count),e("Popularity:",s.popularity)].forEach((e=>t.appendChild(e))),t},drawProviders:()=>{function t(t,e){const n=document.createElement(t);return n.classList.add(e),n}const e=t("div","provider-container"),n=t("button","country-btn"),a=t("div","house-provider-container");return[n,a].forEach((t=>{e.appendChild(t)})),Object.keys(l).length?Object.keys(l).includes("Australia")||function(e="Australia"){console.log(e),n.textContent=e,console.log(l);const o=l[e].stream;console.log(o);const r=l[e].buy,i=l[e].rent,c=["Stream at:","Purchase at:","Rent at:"];let s=0;[o,r,i].forEach((e=>{const n=t("div","service-container"),o=t("div","service-name"),r=t("div","provider-service-container");e.forEach((e=>{const n=t("div","provider-service"),a=t("img","provider-img"),o=t("span","provider-name");e.provider_logo_path&&(a.src=`https://image.tmdb.org/t/p/original/${e.provider_logo_path}`,a.alt=`${e.provider_name} picture.`,o.textContent=e.provider_name),[a,o].forEach((t=>{n.appendChild(t)})),r.appendChild(n)})),e.length&&(o.textContent=`${c[s]}`),s++,n.appendChild(o),n.appendChild(r),a.appendChild(n)}))}(Object.keys(l)[0]):n.textContent="No countries offer this tv/movie at the moment.",e}}};async function s(e){const n=await async function(e){const n=function(t){return t.split(" ").join("+")}(e);try{const a=await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${t}&language=en-US&query=${n}&page=1`,{mode:"cors"}),o=await a.json();let r={},i=o.results;if(i.length){if(i.length>4)for(let t=0;t<5;t++)r[i[t].id]=i[t].media_type;else for(let t=0;t<i.length;t++)r[i[t].id]=i[t].media_type;return console.log(r),r}return void alert(`No results found for ${e}`)}catch(t){alert(t)}}(e),a=document.querySelector(".main-container");let o=[];for(let t in n)"movie"===n[t]&&o.push([t,n[t]]);async function r(t,e){const n=await c(t,e);return n.addToSection(n.drawIntro("300")),n.addToSection(n.drawSubInfos()),n.addToSection(n.drawProviders()),a.appendChild(n.section),r}o.forEach((async t=>await r(t[0],t[1])))}console.log("Hello World"),async function(){document.querySelector(".search-query").addEventListener("click",(async t=>{t.preventDefault();const e=document.getElementById("input-search").value.split(" ").join("+");e?(document.querySelector(".main-container").innerHTML="",await s(e),document.querySelector(".search-query").value=""):alert("Please enter a valid movie/tv show")}))}(),s("mummies")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU02SCxFQUdGLFVBQVpBLEVBQUk3SCxJQUFrQnVJLEVBQVNqSCxLQUFLLENBQUN0QixFQUFJNkgsRUFBSTdILEtBTzlDaEMsZUFBZXdLLEVBQWN4SSxFQUFJa0QsR0FDaEMsTUFBTUMsUUFBZ0JGLEVBQVlqRCxFQUFJa0QsR0FLdEMsT0FKQUMsRUFBUU0sYUFBYU4sRUFBUVcsVUFBVSxRQUN2Q1gsRUFBUU0sYUFBYU4sRUFBUStCLGdCQUM3Qi9CLEVBQVFNLGFBQWFOLEVBQVFnRCxpQkFDN0JrQyxFQUFLMUUsWUFBWVIsRUFBUUEsU0FDbEJxRixDQUNSLENBWEFELEVBQVN2SCxTQUNSaEQsTUFBT21GLFNBQWtCcUYsRUFBY3JGLEVBQVEsR0FBSUEsRUFBUSxLQVc3RCxDQzFCQTNCLFFBQVFDLElBQUksZUNER3pELGlCQUNJb0YsU0FBU2tGLGNBQWMsaUJBQy9CRyxpQkFBaUIsU0FBU3pLLE1BQU8wSyxJQUMxQ0EsRUFBRUMsaUJBQ0YsTUFBTWIsRUFDTDFFLFNBQVN3RixlQUFlLGdCQUFnQkMsTUFjOUJkLE1BQU0sS0FBS3JDLEtBQUssS0FadEJvQyxHRnVCTzFFLFNBQVNrRixjQUFjLG1CQUMvQlEsVUFBWSxTRW5CVmxCLEVBQWFFLEdBRW5CMUUsU0FBU2tGLGNBQWMsaUJBQWlCTyxNQUFRLElBTi9DbkosTUFBTSxxQ0FNMkMsR0FFcEQsQ0RRQXFKLEdBQ0FuQixFQUFhLFUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tb3ZpZW1hdGUvLi9zcmMvanMvYXBpRnVuY3Rpb25zL2ZldGNoSWQuanMiLCJ3ZWJwYWNrOi8vbW92aWVtYXRlLy4vc3JjL2pzL2FwaUZ1bmN0aW9ucy9mZXRjaE1vdmllSW5mby5qcyIsIndlYnBhY2s6Ly9tb3ZpZW1hdGUvLi9zcmMvanMvRE9NRnVuY3Rpb25zL2RyYXdTZWN0aW9uLmpzIiwid2VicGFjazovL21vdmllbWF0ZS8uL3NyYy9qcy9ET01GdW5jdGlvbnMvZHJhd1NlY3Rpb25zLmpzIiwid2VicGFjazovL21vdmllbWF0ZS8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly9tb3ZpZW1hdGUvLi9zcmMvanMvVUkvc3VibWl0U2VhcmNoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IEFQSV9LRVkgPSBcIjcyMGQyMTUwY2YwOWJmYTYxZTI4YTUwNDJjZDc0NjhmXCI7XG4vKlxuRmV0Y2hlcyB0aGUgZmlyc3QgNSBtb3ZpZS9zaG93IGlkcyBhbmQgcmV0dXJuIGl0IGluIGFuIGFycmF5LlxuKi9cbmFzeW5jIGZ1bmN0aW9uIGZldGNoSWRzKG5hbWUpIHtcblx0Y29uc3QgcXVlcnkgPSBpbnRlcnByZXRUb1F1ZXJ5KG5hbWUpO1xuXHR0cnkge1xuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG5cdFx0XHRgaHR0cHM6Ly9hcGkudGhlbW92aWVkYi5vcmcvMy9zZWFyY2gvbXVsdGk/YXBpX2tleT0ke0FQSV9LRVl9Jmxhbmd1YWdlPWVuLVVTJnF1ZXJ5PSR7cXVlcnl9JnBhZ2U9MWAsXG5cdFx0XHR7IG1vZGU6IFwiY29yc1wiIH1cblx0XHQpO1xuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0bGV0IGlkcyA9IHt9O1xuXHRcdGxldCByZXN1bHQgPSBkYXRhLnJlc3VsdHM7XG5cdFx0aWYgKHJlc3VsdC5sZW5ndGgpIHtcblx0XHRcdGlmIChyZXN1bHQubGVuZ3RoID4gNCkge1xuXHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IDU7IGkrKykge1xuXHRcdFx0XHRcdGlkc1tyZXN1bHRbaV0uaWRdID0gcmVzdWx0W2ldLm1lZGlhX3R5cGU7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0aWRzW3Jlc3VsdFtpXS5pZF0gPSByZXN1bHRbaV0ubWVkaWFfdHlwZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Y29uc29sZS5sb2coaWRzKTtcblx0XHRcdHJldHVybiBpZHM7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGFsZXJ0KGBObyByZXN1bHRzIGZvdW5kIGZvciAke25hbWV9YCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHR9IGNhdGNoIChlcnIpIHtcblx0XHRhbGVydChlcnIpO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGludGVycHJldFRvUXVlcnkobmFtZSkge1xuXHRyZXR1cm4gbmFtZS5zcGxpdChcIiBcIikuam9pbihcIitcIik7XG59XG5cbmV4cG9ydCB7IGZldGNoSWRzIH07XG4iLCJjb25zdCBBUElfS0VZID0gXCI3MjBkMjE1MGNmMDliZmE2MWUyOGE1MDQyY2Q3NDY4ZlwiO1xuXG5hc3luYyBmdW5jdGlvbiBmZXRjaE1vdmllRGV0YWlscyhtb3ZpZV9pZCkge1xuXHR0cnkge1xuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG5cdFx0XHRgaHR0cHM6Ly9hcGkudGhlbW92aWVkYi5vcmcvMy9tb3ZpZS8ke21vdmllX2lkfT9hcGlfa2V5PSR7QVBJX0tFWX0mbGFuZ3VhZ2U9ZW4tVVNgLFxuXHRcdFx0eyBtb2RlOiBcImNvcnNcIiB9XG5cdFx0KTtcblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG5cdFx0Y29uc3QgZ2VucmVzID0gZGF0YS5nZW5yZXMucmVkdWNlKChhY2MsIHZhbCkgPT4gWy4uLmFjYywgdmFsLm5hbWVdLCBbXSk7XG5cblx0XHRjb25zdCBnZW5lcmFsSW5mbyA9IHtcblx0XHRcdG1OYW1lOiBkYXRhLm9yaWdpbmFsX3RpdGxlLFxuXHRcdFx0c3VtbWFyeTogZGF0YS5vdmVydmlldyxcblx0XHRcdHRhZ2xpbmU6IGRhdGEudGFnbGluZSxcblx0XHRcdHBvcHVsYXJpdHk6IGRhdGEucG9wdWxhcml0eSxcblx0XHRcdHZvdGVfYXZlcmFnZTogZGF0YS52b3RlX2F2ZXJhZ2UsXG5cdFx0XHR2b3RlX2NvdW50OiBkYXRhLnZvdGVfY291bnQsXG5cdFx0XHRnZW5yZXM6IGdlbnJlcyxcblx0XHRcdHZpZGVvOiBkYXRhLnZpZGVvLFxuXHRcdFx0cnVudGltZTogZGF0YS5ydW50aW1lLFxuXHRcdFx0cG9zdGVyX3BhdGg6IGRhdGEucG9zdGVyX3BhdGgsXG5cdFx0XHRiYWNrZHJvcF9wYXRoOiBkYXRhLmJhY2tkcm9wX3BhdGgsXG5cdFx0fTtcblx0XHRyZXR1cm4gZ2VuZXJhbEluZm87XG5cdH0gY2F0Y2ggKGVycikge1xuXHRcdGFsZXJ0KGVycik7XG5cdH1cbn1cblxuLypcblJldHVybnMgYW4gYXJyYXkgb2YgcmVjb21tZW5kZWQgbW92aWVzIHdpdGggdGhlaXIgbmFtZSwgaWQsIHBvc3Rlcl9wYXRoIGFuZFxuYmFja2Ryb3BfcGF0aCByZWNvcmRlZC4gXG5JZiBubyBtb3ZpZXMgYXJlIHJlY29tbWVuZGVkLCByZXR1cm4gbnVsbDtcbiovXG5hc3luYyBmdW5jdGlvbiBmZXRjaE1vdmllUmVjY29zKG1vdmllX2lkKSB7XG5cdHRyeSB7XG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcblx0XHRcdGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL21vdmllLyR7bW92aWVfaWR9L3JlY29tbWVuZGF0aW9ucz9hcGlfa2V5PSR7QVBJX0tFWX0mbGFuZ3VhZ2U9ZW4tVVMmcGFnZT0xYCxcblx0XHRcdHsgbW9kZTogXCJjb3JzXCIgfVxuXHRcdCk7XG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuXHRcdGNvbnN0IHJlY01vdmllcyA9IHt9O1xuXHRcdGlmIChkYXRhLnJlc3VsdHMpIHtcblx0XHRcdGxldCBjb3VudCA9IDE7XG5cdFx0XHRmb3IgKGxldCBtb3ZpZSBvZiBkYXRhLnJlc3VsdHMpIHtcblx0XHRcdFx0cmVjTW92aWVzW21vdmllLm9yaWdpbmFsX3RpdGxlXSA9IHtcblx0XHRcdFx0XHRtTmFtZTogbW92aWUub3JpZ2luYWxfdGl0bGUsXG5cdFx0XHRcdFx0aWQ6IG1vdmllLmlkLFxuXHRcdFx0XHRcdHBvc3Rlcl9wYXRoOiBtb3ZpZS5wb3N0ZXJfcGF0aCxcblx0XHRcdFx0XHRiYWNrZHJvcF9wYXRoOiBtb3ZpZS5iYWNrZHJvcF9wYXRoLFxuXHRcdFx0XHR9O1xuXHRcdFx0XHRpZiAoY291bnQgPT09IDUpIHtcblx0XHRcdFx0XHQvLyBNYXggNSBtb3ZpZXMgdG8gYmUgcmVjb21tZW5kZWRcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0XHRjb3VudCsrO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gcmVjTW92aWVzO1xuXHR9IGNhdGNoIChlcnIpIHtcblx0XHRhbGVydChlcnIpO1xuXHR9XG59XG5cbi8qXG5SZXR1cm5zIGFuIG9iamVjdCB3aXRoIGNvdW50cmllcyBhbmQgdGhlIGF2YWlsYWJsZSBzdHJlYW1pbmcgc2VydmljZXMsIGJ1eVxub3IgcmVudCBpdCBjb21lcyB3aXRoIEVBQ0ggaW5kaXZpZHVhbCBjb3VudHJ5LlxuKi9cbmFzeW5jIGZ1bmN0aW9uIGZldGNoTW92aWVQcm92aWRlcnMobW92aWVfaWQpIHtcblx0Y29uc3QgcHJvdmlkZXJzQnlDb3VudHJ5ID0ge307XG5cdHRyeSB7XG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcblx0XHRcdGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL21vdmllLyR7bW92aWVfaWR9L3dhdGNoL3Byb3ZpZGVycz9hcGlfa2V5PSR7QVBJX0tFWX1gLFxuXHRcdFx0eyBtb2RlOiBcImNvcnNcIiB9XG5cdFx0KTtcblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG5cdFx0Zm9yIChjb25zdCBjb3VudHJ5Q29kZSBpbiBkYXRhLnJlc3VsdHMpIHtcblx0XHRcdGNvbnN0IGNvdW50cnkgPSBnZXRDb3VudHJ5TmFtZShjb3VudHJ5Q29kZSk7XG5cdFx0XHRwcm92aWRlcnNCeUNvdW50cnlbY291bnRyeV0gPSB7XG5cdFx0XHRcdHN0cmVhbTogW10sXG5cdFx0XHRcdHJlbnQ6IFtdLFxuXHRcdFx0XHRidXk6IFtdLFxuXHRcdFx0fTtcblxuXHRcdFx0Lypcblx0XHRcdFNvcnRzIHByb3ZpZGVycyBiYXNlZCBvbiBjb3VudHJ5IGFuZCBzZXJ2aWNlcyB0aGV5IHByb3ZpZGUuXG5cblx0XHRcdFRha2VzIGluIHR5cGUgb2Ygc2VydmljZXMgYXMgcGFyYW0gPT4gW1wiZmxhdHJhdGUgKHN0cmVhbWluZylcIiwgXG5cdFx0XHRcInJlbnRcIiwgXCJidXlcIl0gYW5kIGFuIGFycmF5IHRvIGFwcGVuZCBpdCB0by5cblx0XHRcdCovXG5cdFx0XHRjb25zdCBzb3J0UHJvdmlkZXJzID0gKHNlcnZpY2VzLCBjb2xsZWN0aW9uKSA9PiB7XG5cdFx0XHRcdGlmIChzZXJ2aWNlcykge1xuXHRcdFx0XHRcdHNlcnZpY2VzLmZvckVhY2goKHNlcnZpY2UpID0+IHtcblx0XHRcdFx0XHRcdGNvbnN0IHByb3ZpZGVySW5mbyA9IHtcblx0XHRcdFx0XHRcdFx0cHJvdmlkZXJfbmFtZTogc2VydmljZS5wcm92aWRlcl9uYW1lLFxuXHRcdFx0XHRcdFx0XHRwcm92aWRlcl9sb2dvX3BhdGg6IHNlcnZpY2UubG9nb19wYXRoLFxuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdGNvbGxlY3Rpb24ucHVzaChwcm92aWRlckluZm8pO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXG5cdFx0XHQvLyBBZGQgc3RyZWFtaW5nIHNlcnZpY2VzIGZvciBzcGVjaWZpZWQgbW92aWUgaW4gZWFjaCBjb3VudHJ5LlxuXHRcdFx0c29ydFByb3ZpZGVycyhcblx0XHRcdFx0ZGF0YS5yZXN1bHRzW2NvdW50cnlDb2RlXS5mbGF0cmF0ZSxcblx0XHRcdFx0cHJvdmlkZXJzQnlDb3VudHJ5W2NvdW50cnldLnN0cmVhbVxuXHRcdFx0KTtcblxuXHRcdFx0Ly8gQWRkIHJlbnRpbmcgc2VydmljZXMgZm9yIHNwZWljaWZpZWQgbW92aWUgaW4gZWFjaCBjb3VudHJ5LlxuXHRcdFx0c29ydFByb3ZpZGVycyhcblx0XHRcdFx0ZGF0YS5yZXN1bHRzW2NvdW50cnlDb2RlXS5yZW50LFxuXHRcdFx0XHRwcm92aWRlcnNCeUNvdW50cnlbY291bnRyeV0ucmVudFxuXHRcdFx0KTtcblxuXHRcdFx0Ly8gQWRkIGJ1eWluZyBzZXJ2aWNlcyBmb3Igc3BlY2lmaWVkIG1vdmllIGluIGVhY2ggY291bnRyeS5cblx0XHRcdHNvcnRQcm92aWRlcnMoXG5cdFx0XHRcdGRhdGEucmVzdWx0c1tjb3VudHJ5Q29kZV0uYnV5LFxuXHRcdFx0XHRwcm92aWRlcnNCeUNvdW50cnlbY291bnRyeV0uYnV5XG5cdFx0XHQpO1xuXHRcdH1cblx0XHRjb25zb2xlLmxvZyhwcm92aWRlcnNCeUNvdW50cnkpXG5cdFx0cmV0dXJuIHByb3ZpZGVyc0J5Q291bnRyeTtcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0YWxlcnQoZXJyKTtcblx0fVxufVxuXG4vLyBGaW5kIG1vdmllIHRyYWlsZXIgYW5kIHJldHVybiBmYWxzZSBpZiBub25lIGNhbiBiZSBmb3VuZC5cbi8vIE9mZmljaWFsIHRyYWlsZXIgd2lsbCBiZSBwcmlvcml0aXNlZC5cbmFzeW5jIGZ1bmN0aW9uIGZldGNoTW92aWVUcmFpbGVyKG1vdmllX2lkKSB7XG5cdHRyeSB7XG5cdFx0bGV0IG1vdmllVHJhaWxlcjtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuXHRcdFx0YGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvbW92aWUvJHttb3ZpZV9pZH0vdmlkZW9zP2FwaV9rZXk9JHtBUElfS0VZfWAsXG5cdFx0XHR7IG1vZGU6IFwiY29yc1wiIH1cblx0XHQpO1xuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cblx0XHRjb25zdCB0cmFpbGVycyA9IGRhdGEucmVzdWx0cy5maWx0ZXIoKHZpZGVvKSA9PiB2aWRlby50eXBlID09PSBcIlRyYWlsZXJcIik7XG5cblx0XHRpZiAodHJhaWxlcnMubGVuZ3RoID09PSAwKSByZXR1cm4gZmFsc2U7XG5cdFx0Ly8gRmluZCBvZmZpY2lhbCB0cmFpbGVyLlxuXHRcdGNvbnN0IG9mZmljaWFsID0gdHJhaWxlcnMuZmlsdGVyKCh2aWRlbykgPT4ge1xuXHRcdFx0dmlkZW8ub2ZmaWNpYWwgPT09IHRydWU7XG5cdFx0fSk7XG5cblx0XHRvZmZpY2lhbC5sZW5ndGggIT09IDBcblx0XHRcdD8gKG1vdmllVHJhaWxlciA9IG9mZmljaWFsWzBdKVxuXHRcdFx0OiAobW92aWVUcmFpbGVyID0gdHJhaWxlcnNbMF0pO1xuXG5cdFx0cmV0dXJuIHtcblx0XHRcdG1OYW1lOiBtb3ZpZVRyYWlsZXIubmFtZSxcblx0XHRcdGtleTogbW92aWVUcmFpbGVyLmtleSxcblx0XHRcdHNpdGU6IG1vdmllVHJhaWxlci5zaXRlLFxuXHRcdFx0dHlwZTogbW92aWVUcmFpbGVyLnR5cGUsXG5cdFx0XHRsYW5nOiBnZXRMYW5ndWFnZShtb3ZpZVRyYWlsZXIuaXNvXzYzOV8xKSxcblx0XHR9O1xuXHR9IGNhdGNoIChlcnIpIHtcblx0XHRhbGVydChlcnIpO1xuXHR9XG59XG5cbi8vIFJldHVybnMgYW4gYXJyIG9mIGEgbWF4aW11bSBvZiA1IHJldmlld3MgYmFzZWQgb24gdGhlIG1vdmllIGZyb20gcmFuZG9tIHNvdXJjZXMuXG4vLyBJZiBubyByZXZpZXdzIGFyZSBmb3VuZCwgdGhpcyBmbmMgcmV0dXJucyBmYWxzZS5cbmFzeW5jIGZ1bmN0aW9uIGZldGNoTW92aWVSZXZpZXdzKG1vdmllX2lkKSB7XG5cdHRyeSB7XG5cdFx0bGV0IHJldmlld3MgPSBbXTtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuXHRcdFx0YGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvbW92aWUvJHttb3ZpZV9pZH0vcmV2aWV3cz9hcGlfa2V5PSR7QVBJX0tFWX0mbGFuZ3VhZ2U9ZW4tVVMmcGFnZT0xYCxcblx0XHRcdHsgbW9kZTogXCJjb3JzXCIgfVxuXHRcdCk7XG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRjb25zb2xlLmxvZyhkYXRhKTtcblx0XHRpZiAoZGF0YS5yZXN1bHRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuXG5cdFx0bGV0IGNvdW50ID0gMTtcblx0XHRkYXRhLnJlc3VsdHMuZm9yRWFjaCgocmV2aWV3KSA9PiB7XG5cdFx0XHRyZXZpZXdzLnB1c2goe1xuXHRcdFx0XHRhdXRob3I6IHJldmlldy5hdXRob3IsXG5cdFx0XHRcdHJhdGluZzogcmV2aWV3LmF1dGhvcl9kZXRhaWxzLnJhdGluZyxcblx0XHRcdFx0cGljX3BhdGg6IHJldmlldy5hdXRob3JfZGV0YWlscy5hdmF0YXJfcGF0aCxcblx0XHRcdFx0Y29udGVudDogcmV2aWV3LmNvbnRlbnQsXG5cdFx0XHRcdHVybDogcmV2aWV3LnVybCxcblx0XHRcdFx0bGFzdF91cGRhdGVkOiByZXZpZXcudXBkYXRlZF9hdCxcblx0XHRcdH0pO1xuXHRcdFx0Y291bnQrKztcblx0XHR9KTtcblx0XHRyZXR1cm4gcmV2aWV3cy5zbGljZSgwLCA1KTtcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0YWxlcnQoZXJyKTtcblx0fVxufVxuXG5mdW5jdGlvbiBnZXRDb3VudHJ5TmFtZShjb2RlKSB7XG5cdGxldCByZWdpb25OYW1lcyA9IG5ldyBJbnRsLkRpc3BsYXlOYW1lcyhbXCJlblwiXSwgeyB0eXBlOiBcInJlZ2lvblwiIH0pO1xuXHRyZXR1cm4gcmVnaW9uTmFtZXMub2YoY29kZSk7XG59XG5cbmZ1bmN0aW9uIGdldExhbmd1YWdlKGNvZGUpIHtcblx0Y29uc3QgbGFuZyA9IG5ldyBJbnRsLkRpc3BsYXlOYW1lcyhbXCJlblwiXSwgeyB0eXBlOiBcImxhbmd1YWdlXCIgfSk7XG5cdHJldHVybiBsYW5nLm9mKGNvZGUpO1xufVxuZXhwb3J0IHtcblx0ZmV0Y2hNb3ZpZURldGFpbHMsXG5cdGZldGNoTW92aWVSZWNjb3MsXG5cdGZldGNoTW92aWVQcm92aWRlcnMsXG5cdGZldGNoTW92aWVUcmFpbGVyLFxuXHRmZXRjaE1vdmllUmV2aWV3cyxcblx0Z2V0Q291bnRyeU5hbWUsXG59O1xuIiwiaW1wb3J0ICogYXMgbW92aWUgZnJvbSBcIi4uL2FwaUZ1bmN0aW9ucy9mZXRjaE1vdmllSW5mb1wiO1xuXG4vKlxuRHJhdyBhbiBpbmRpdmlkdWFsIHNlY3Rpb24gYmFzZWQgb24gdXNlciBpbnB1dCBxdWVyeS5cblRoaXMgc2VjdGlvbiB3aWxsIGNvbnN0cyBvZiB0aGUgb3ZlcmFsbCBtb3ZpZS90didzIFxuICAgIC0gRGV0YWlscyxcbiAgICAtIFRoZSB3YXRjaCBwcm92aWRlcnMgYmFzZWQgb24gc3BlY2lmaWMgY291bnRyaWVzXG4gICAgLSBBdmFpbGFibGUgdHJhaWxlcnMsXG4gICAgLSBPdGhlciByZWNvbW1lbmRhdGlvbnMuXG4gICAgLSBSZXZpZXdzIGJ5IGVzdGFibGlzaGVkIGF1dGhvcnMgYmFzZWQgZnJvbSByYW5kb20gc291cmNlcy5cbiovXG5cbmNvbnN0IGRyYXdTZWN0aW9uID0gYXN5bmMgKGlkLCBtZWRpYSkgPT4ge1xuXHRjb25zdCBzZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNlY3Rpb25cIik7XG5cdGNvbnN0IGRldGFpbHMgPSBhd2FpdCBnZXRJbmZvKGlkLCBtb3ZpZS5mZXRjaE1vdmllRGV0YWlscywgXCJcIik7XG5cdGNvbnN0IHJlY3MgPSBhd2FpdCBnZXRJbmZvKGlkLCBtb3ZpZS5mZXRjaE1vdmllUmVjY29zLCBcIlwiKTtcblx0Y29uc3QgcHJvdmlkZXJzID0gYXdhaXQgZ2V0SW5mbyhpZCwgbW92aWUuZmV0Y2hNb3ZpZVByb3ZpZGVycywgXCJcIik7XG5cdGNvbnN0IHRyYWlsZXIgPSBhd2FpdCBnZXRJbmZvKGlkLCBtb3ZpZS5mZXRjaE1vdmllVHJhaWxlciwgXCJcIik7XG5cdGNvbnN0IHJldmlld3MgPSBhd2FpdCBnZXRJbmZvKGlkLCBtb3ZpZS5mZXRjaE1vdmllUmV2aWV3cywgXCJcIik7XG5cblx0ZnVuY3Rpb24gZHJhd0FsbCgpIHtcblx0XHRhZGRUb1NlY3Rpb24oZHJhd0ludHJvKCkpO1xuXHR9XG5cblx0ZnVuY3Rpb24gYWRkVG9TZWN0aW9uKHBhcnQpIHtcblx0XHRzZWN0aW9uLmFwcGVuZENoaWxkKHBhcnQpO1xuXHR9XG5cblx0YXN5bmMgZnVuY3Rpb24gZ2V0SW5mbyhpZCwgbW92aWVGbmMsIHR2Rm5jKSB7XG5cdFx0cmV0dXJuIG1lZGlhID09PSBcIm1vdmllXCIgPyBhd2FpdCBtb3ZpZUZuYyhpZCkgOiBcIlwiO1xuXHR9XG5cblx0Ly8gRHJhdyAoaWYgYW55KSB0aXRsZSwgcGhvdG8sIHRhZ2xpbmUsIGFuZCBzdW1tYXJ5LlxuXHRjb25zdCBkcmF3SW50cm8gPSAoaW1nU2l6ZSkgPT4ge1xuXHRcdGNvbnN0IGludHJvQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRpbnRyb0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiaW50cm9cIik7XG5cblx0XHRpbnRyb0NvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVUaXRsZSgpKTtcblx0XHRkZXRhaWxzLnRhZ2xpbmUgPyBpbnRyb0NvbnRhaW5lci5hcHBlbmRDaGlsZCh3cml0ZVRhZ2xpbmUoKSkgOiBcIlwiO1xuXG5cdFx0Y29uc3QgaW1nID0gcmVuZGVySW1nKGltZ1NpemUpO1xuXHRcdGltZyA/IGludHJvQ29udGFpbmVyLmFwcGVuZENoaWxkKGltZykgOiBcIlwiO1xuXG5cdFx0aW50cm9Db250YWluZXIuYXBwZW5kQ2hpbGQod3JpdGVTdW1tYXJ5KCkpO1xuXG5cdFx0ZnVuY3Rpb24gY3JlYXRlVGl0bGUoKSB7XG5cdFx0XHRjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoMVwiKTtcblx0XHRcdHRpdGxlLnRleHRDb250ZW50ID0gZGV0YWlscy5tTmFtZTtcblx0XHRcdHRpdGxlLmNsYXNzTGlzdC5hZGQoXCJ0aXRsZVwiKTtcblx0XHRcdHJldHVybiB0aXRsZTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiByZW5kZXJJbWcoaW1nU2l6ZSA9IFwiXCIpIHtcblx0XHRcdGNvbnN0IHBvc3RlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIik7XG5cdFx0XHRjb25zdCBiYXNlSW1nVXJsID0gXCJodHRwczovL2ltYWdlLnRtZGIub3JnL3QvcFwiO1xuXHRcdFx0bGV0IGltZ19wYXRoO1xuXHRcdFx0cG9zdGVyLmNsYXNzTGlzdC5hZGQoXCJwb3N0ZXJcIik7XG5cblx0XHRcdGlmIChkZXRhaWxzLnBvc3Rlcl9wYXRoKSB7XG5cdFx0XHRcdGltZ19wYXRoID0gZGV0YWlscy5wb3N0ZXJfcGF0aDtcblx0XHRcdH0gZWxzZSBpZiAoZGV0YWlscy5iYWNrZHJvcF9wYXRoKSB7XG5cdFx0XHRcdGltZ19wYXRoID0gZGV0YWlscy5iYWNrZHJvcF9wYXRoO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0IWltZ1NpemVcblx0XHRcdFx0PyAocG9zdGVyLnNyYyA9IGAke2Jhc2VJbWdVcmx9L29yaWdpbmFsLyR7aW1nX3BhdGh9YClcblx0XHRcdFx0OiAocG9zdGVyLnNyYyA9IGAke2Jhc2VJbWdVcmx9L3cke2ltZ1NpemV9LyR7aW1nX3BhdGh9YCk7XG5cdFx0XHRwb3N0ZXIuYWx0ID0gXCJNb3ZpZSBwaWN0dXJlIHBvc3RlclwiO1xuXHRcdFx0cmV0dXJuIHBvc3Rlcjtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiB3cml0ZVRhZ2xpbmUoKSB7XG5cdFx0XHRjb25zdCB0YWdQYXJhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XG5cdFx0XHR0YWdQYXJhLnRleHRDb250ZW50ID0gZGV0YWlscy50YWdsaW5lO1xuXHRcdFx0dGFnUGFyYS5jbGFzc0xpc3QuYWRkKFwidGFnbGluZVwiKTtcblx0XHRcdHJldHVybiB0YWdQYXJhO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHdyaXRlU3VtbWFyeSgpIHtcblx0XHRcdGNvbnN0IHBhcmEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcblx0XHRcdHBhcmEudGV4dENvbnRlbnQgPSBkZXRhaWxzLnN1bW1hcnk7XG5cdFx0XHRwYXJhLmNsYXNzTGlzdC5hZGQoXCJzdW1tYXJ5XCIpO1xuXHRcdFx0cmV0dXJuIHBhcmE7XG5cdFx0fVxuXHRcdHJldHVybiBpbnRyb0NvbnRhaW5lcjtcblx0fTtcblxuXHRjb25zdCBkcmF3U3ViSW5mb3MgPSAoKSA9PiB7XG5cdFx0Y29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRjb250YWluZXIuY2xhc3NMaXN0LmFkZChcInN1YmluZm8tY29udGFpbmVyXCIpO1xuXG5cdFx0Y29uc3QgaW5mb3JtYXRpb24gPSBbXG5cdFx0XHRjcmVhdGVTdWJJbmZvKFwiR2VucmVzOlwiLCBkZXRhaWxzLmdlbnJlcy5qb2luKFwiLCBcIikpLFxuXHRcdFx0Y3JlYXRlU3ViSW5mbyhcIlJ1bnRpbWU6XCIsIGNvbnZlcnRNaW5Ub0hyKGRldGFpbHMucnVudGltZSkpLFxuXHRcdFx0Y3JlYXRlU3ViSW5mbyhcIlZvdGUgQXZlcmFnZTpcIiwgZGV0YWlscy52b3RlX2F2ZXJhZ2UpLFxuXHRcdFx0Y3JlYXRlU3ViSW5mbyhcIlZvdGUgQ291bnQ6XCIsIGRldGFpbHMudm90ZV9jb3VudCksXG5cdFx0XHRjcmVhdGVTdWJJbmZvKFwiUG9wdWxhcml0eTpcIiwgZGV0YWlscy5wb3B1bGFyaXR5KSxcblx0XHRdO1xuXG5cdFx0aW5mb3JtYXRpb24uZm9yRWFjaCgoaW5mbykgPT4gY29udGFpbmVyLmFwcGVuZENoaWxkKGluZm8pKTtcblxuXHRcdGZ1bmN0aW9uIGNyZWF0ZVN1YkluZm8oY2F0ZWdvcnksIGluZm8pIHtcblx0XHRcdGNvbnN0IHN1YkluZm8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdFx0Y29uc3QgY2F0ZWdvcnlOYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdFx0XHRjb25zdCBjYXRlZ29yeUluZm8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblxuXHRcdFx0c3ViSW5mby5jbGFzc0xpc3QuYWRkKFwic3ViLWluZm9cIik7XG5cdFx0XHRjYXRlZ29yeU5hbWUuY2xhc3NMaXN0LmFkZChcImNhdGVnb3J5LW5hbWVcIik7XG5cdFx0XHRjYXRlZ29yeUluZm8uY2xhc3NMaXN0LmFkZChcImNhdGVnb3J5LWluZm9cIik7XG5cblx0XHRcdGNhdGVnb3J5TmFtZS50ZXh0Q29udGVudCA9IGNhdGVnb3J5O1xuXHRcdFx0Y2F0ZWdvcnlJbmZvLnRleHRDb250ZW50ID0gaW5mbztcblxuXHRcdFx0W2NhdGVnb3J5TmFtZSwgY2F0ZWdvcnlJbmZvXS5mb3JFYWNoKChpbmZvKSA9PiBzdWJJbmZvLmFwcGVuZENoaWxkKGluZm8pKTtcblx0XHRcdHJldHVybiBzdWJJbmZvO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGNvbnZlcnRNaW5Ub0hyKG1pbnMpIHtcblx0XHRcdGNvbnN0IGhvdXJzID0gbWlucyAvIDYwO1xuXHRcdFx0Y29uc3QgckhvdXJzID0gTWF0aC5mbG9vcihob3Vycyk7XG5cdFx0XHRjb25zdCBtaW51dGVzID0gKGhvdXJzIC0gckhvdXJzKSAqIDYwO1xuXHRcdFx0Y29uc3Qgck1pbnV0ZXMgPSBNYXRoLnJvdW5kKG1pbnV0ZXMpO1xuXHRcdFx0cmV0dXJuIGAke3JIb3Vyc31oICR7ck1pbnV0ZXN9bWluYDtcblx0XHR9XG5cblx0XHRyZXR1cm4gY29udGFpbmVyO1xuXHR9O1xuXG5cdGNvbnN0IGRyYXdQcm92aWRlcnMgPSAoKSA9PiB7XG5cdFx0Ly8gSG91c2VzIHRoZSBidG4gdGhhdCBvcGVucyB0aGUgbW9kYWwgYW5kIG92ZXJsYXksIGFuZCB0aGUgYXZhaWxhYmxlIHByb3ZpZGVycyBmb3IgJ3N0cmVhbWluZycsICdyZW50JyBhbmQgJ3B1cmNoYXNlJy5cblx0XHRmdW5jdGlvbiByZW5kZXJFbGVtZW50KHRhZywgY2xhc3NOYW1lKSB7XG5cdFx0XHRjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZyk7XG5cdFx0XHRjb250YWluZXIuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xuXHRcdFx0cmV0dXJuIGNvbnRhaW5lcjtcblx0XHR9XG5cdFx0Y29uc3QgcHJvdmlkZXJDb250YWluZXIgPSByZW5kZXJFbGVtZW50KFwiZGl2XCIsIFwicHJvdmlkZXItY29udGFpbmVyXCIpO1xuXHRcdGNvbnN0IGNvdW50cnlCdG4gPSByZW5kZXJFbGVtZW50KFwiYnV0dG9uXCIsIFwiY291bnRyeS1idG5cIik7XG5cdFx0Y29uc3QgaG91c2VDb250YWluZXIgPSByZW5kZXJFbGVtZW50KFwiZGl2XCIsIFwiaG91c2UtcHJvdmlkZXItY29udGFpbmVyXCIpO1xuXHRcdFtjb3VudHJ5QnRuLCBob3VzZUNvbnRhaW5lcl0uZm9yRWFjaCgoZWxlbSkgPT4ge1xuXHRcdFx0cHJvdmlkZXJDb250YWluZXIuYXBwZW5kQ2hpbGQoZWxlbSk7XG5cdFx0fSk7XG5cblx0XHQvLyBTZWFyY2ggZm9yIGRlZmF1bHQgY291bnRyeSBcIkF1c3RyYWxpYVwiLiBJZiBub25lIGZvdW5kLiBEcmF3IHRoZSBmaXJzdCBjb3VudHJ5J3MgcHJvdmlkZXIuXG5cdFx0aWYoT2JqZWN0LmtleXMocHJvdmlkZXJzKS5sZW5ndGgpe1xuXHRcdE9iamVjdC5rZXlzKHByb3ZpZGVycykuaW5jbHVkZXMoXCJBdXN0cmFsaWFcIikgPyBkcmF3UHJvdmlkZXIgOiBkcmF3UHJvdmlkZXIoT2JqZWN0LmtleXMocHJvdmlkZXJzKVswXSk7fSBlbHNlIHtcblx0XHRcdGNvdW50cnlCdG4udGV4dENvbnRlbnQgPSAnTm8gY291bnRyaWVzIG9mZmVyIHRoaXMgdHYvbW92aWUgYXQgdGhlIG1vbWVudC4nXG5cdFx0fVxuXG5cdFx0cmV0dXJuIHByb3ZpZGVyQ29udGFpbmVyO1xuXG5cdFx0ZnVuY3Rpb24gZHJhd1Byb3ZpZGVyKGNvdW50cnlOYW1lID0gXCJBdXN0cmFsaWFcIikge1xuXHRcdFx0Ly8gQ2hhbmdlIHRleHQgb2YgYnRuIHRvIGNvdW50cnlOYW1lXG5cdFx0XHRjb25zb2xlLmxvZyhjb3VudHJ5TmFtZSk7XG5cdFx0XHRjb3VudHJ5QnRuLnRleHRDb250ZW50ID0gY291bnRyeU5hbWU7XG5cblx0XHRcdGNvbnNvbGUubG9nKHByb3ZpZGVycyk7XG5cdFx0XHRcblx0XHRcdGNvbnN0IHN0cmVhbUluZm8gPSBwcm92aWRlcnNbY291bnRyeU5hbWVdLnN0cmVhbTtcblx0XHRcdGNvbnNvbGUubG9nKHN0cmVhbUluZm8pXG5cdFx0XHRjb25zdCBidXlJbmZvID0gcHJvdmlkZXJzW2NvdW50cnlOYW1lXS5idXk7XG5cdFx0XHRjb25zdCByZW50SW5mbyA9IHByb3ZpZGVyc1tjb3VudHJ5TmFtZV0ucmVudDtcblxuXG5cdFx0XHRjb25zdCBzZXJ2aWNlTmFtZXMgPSBbXCJTdHJlYW0gYXQ6XCIsIFwiUHVyY2hhc2UgYXQ6XCIsIFwiUmVudCBhdDpcIl07XG5cdFx0XHQvLyBUbyBhc3NpZ24gbmFtZXMgZm9yIGVhY2ggc2V2aWNlIHByb3ZpZGVycy5cblx0XHRcdC8vIFRoaXMgaW5jcmVtZW50cyBhcyBwcm92aWRlcnMgYXJlIGxpc3RlZCBmb3IgZWFjaCBzZXJ2aWNlLlxuXHRcdFx0bGV0IGlkeCA9IDA7XG5cblx0XHRcdFtzdHJlYW1JbmZvLCBidXlJbmZvLCByZW50SW5mb10uZm9yRWFjaCgoaW5mbykgPT4ge1xuXHRcdFx0XHRcblx0XHRcdFx0Y29uc3Qgc2VydmljZUNvbnRhaW5lciA9IHJlbmRlckVsZW1lbnQoXCJkaXZcIiwgXCJzZXJ2aWNlLWNvbnRhaW5lclwiKTtcblx0XHRcdFx0Y29uc3Qgc2VydmljZU5hbWUgPSByZW5kZXJFbGVtZW50KFwiZGl2XCIsIFwic2VydmljZS1uYW1lXCIpO1xuXHRcdFx0XHRjb25zdCBwcm92aWRlclNlcnZpY2VDb250YWluZXIgPSByZW5kZXJFbGVtZW50KFxuXHRcdFx0XHRcdFwiZGl2XCIsXG5cdFx0XHRcdFx0XCJwcm92aWRlci1zZXJ2aWNlLWNvbnRhaW5lclwiXG5cdFx0XHRcdCk7XG5cblx0XHRcdFx0aW5mby5mb3JFYWNoKChwcm92aWRlcikgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IHByb3ZpZGVyU2VydmljZSA9IHJlbmRlckVsZW1lbnQoXCJkaXZcIiwgXCJwcm92aWRlci1zZXJ2aWNlXCIpO1xuXHRcdFx0XHRcdC8vIEFkZCBpbWcgYW5kIG5hbWUgb2YgcHJvdmlkZXIuXG5cdFx0XHRcdFx0Y29uc3QgcHJvdmlkZXJJbWcgPSByZW5kZXJFbGVtZW50KFwiaW1nXCIsIFwicHJvdmlkZXItaW1nXCIpO1xuXHRcdFx0XHRcdGNvbnN0IHByb3ZpZGVyTmFtZSA9IHJlbmRlckVsZW1lbnQoXCJzcGFuXCIsIFwicHJvdmlkZXItbmFtZVwiKTtcblxuXHRcdFx0XHRcdGlmIChwcm92aWRlci5wcm92aWRlcl9sb2dvX3BhdGgpIHtcblx0XHRcdFx0XHRcdHByb3ZpZGVySW1nLnNyYyA9IGBodHRwczovL2ltYWdlLnRtZGIub3JnL3QvcC9vcmlnaW5hbC8ke3Byb3ZpZGVyLnByb3ZpZGVyX2xvZ29fcGF0aH1gO1xuXHRcdFx0XHRcdFx0cHJvdmlkZXJJbWcuYWx0ID0gYCR7cHJvdmlkZXIucHJvdmlkZXJfbmFtZX0gcGljdHVyZS5gO1xuXHRcdFx0XHRcdFx0cHJvdmlkZXJOYW1lLnRleHRDb250ZW50ID0gcHJvdmlkZXIucHJvdmlkZXJfbmFtZTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRbcHJvdmlkZXJJbWcsIHByb3ZpZGVyTmFtZV0uZm9yRWFjaCgoZWxlbSkgPT4ge1xuXHRcdFx0XHRcdFx0cHJvdmlkZXJTZXJ2aWNlLmFwcGVuZENoaWxkKGVsZW0pO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdHByb3ZpZGVyU2VydmljZUNvbnRhaW5lci5hcHBlbmRDaGlsZChwcm92aWRlclNlcnZpY2UpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRpZiAoaW5mby5sZW5ndGgpIHtcblx0XHRcdFx0XHRzZXJ2aWNlTmFtZS50ZXh0Q29udGVudCA9IGAke3NlcnZpY2VOYW1lc1tpZHhdfWA7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWR4Kys7XG5cdFx0XHRcdHNlcnZpY2VDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VydmljZU5hbWUpO1xuXHRcdFx0XHRzZXJ2aWNlQ29udGFpbmVyLmFwcGVuZENoaWxkKHByb3ZpZGVyU2VydmljZUNvbnRhaW5lcik7XG5cdFx0XHRcdGhvdXNlQ29udGFpbmVyLmFwcGVuZENoaWxkKHNlcnZpY2VDb250YWluZXIpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9O1xuXHRyZXR1cm4ge1xuXHRcdHNlY3Rpb24sXG5cdFx0YWRkVG9TZWN0aW9uLFxuXHRcdGRyYXdBbGwsXG5cdFx0ZHJhd0ludHJvLFxuXHRcdGRyYXdTdWJJbmZvcyxcblx0XHRkcmF3UHJvdmlkZXJzLFxuXHR9O1xufTtcblxuZXhwb3J0IHsgZHJhd1NlY3Rpb24gfTtcbiIsImltcG9ydCBjb2xsZWN0U2VhcmNoUXVlcnkgZnJvbSBcIi4vc2VhcmNoXCI7XG5pbXBvcnQgeyBmZXRjaElkcyB9IGZyb20gXCIuLi9hcGlGdW5jdGlvbnMvZmV0Y2hJZFwiO1xuaW1wb3J0ICogYXMgbW92aWUgZnJvbSBcIi4uL2FwaUZ1bmN0aW9ucy9mZXRjaE1vdmllSW5mb1wiO1xuaW1wb3J0IHsgZHJhd1NlY3Rpb24gfSBmcm9tIFwiLi9kcmF3U2VjdGlvblwiO1xuXG5hc3luYyBmdW5jdGlvbiBkcmF3U2VjdGlvbnModGl0bGUpIHtcblx0Y29uc3QgaWRzID0gYXdhaXQgZmV0Y2hJZHModGl0bGUpO1xuXHRjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWNvbnRhaW5lclwiKTtcblx0bGV0IHNlY3Rpb25zID0gW107XG5cblx0Ly8gTWFrZSBhbiBhcnIgdy8gZWxlbXMgb2YgW2lkLCBtZWRpYV1cblx0Zm9yIChsZXQgaWQgaW4gaWRzKSB7XG5cdFx0Ly8gVGVtcCBtYWtlIGl0IHNvIHRoYXQgaXQgb25seSBhY2NlcHRzIG1vdmllc1xuXG5cdFx0aWRzW2lkXSA9PT0gXCJtb3ZpZVwiID8gc2VjdGlvbnMucHVzaChbaWQsIGlkc1tpZF1dKSA6IFwiXCI7XG5cdH1cblxuXHRzZWN0aW9ucy5mb3JFYWNoKFxuXHRcdGFzeW5jIChzZWN0aW9uKSA9PiBhd2FpdCByZW5kZXJTZWN0aW9uKHNlY3Rpb25bMF0sIHNlY3Rpb25bMV0pXG5cdCk7XG5cblx0YXN5bmMgZnVuY3Rpb24gcmVuZGVyU2VjdGlvbihpZCwgbWVkaWEpIHtcblx0XHRjb25zdCBzZWN0aW9uID0gYXdhaXQgZHJhd1NlY3Rpb24oaWQsIG1lZGlhKTtcblx0XHRzZWN0aW9uLmFkZFRvU2VjdGlvbihzZWN0aW9uLmRyYXdJbnRybyhcIjMwMFwiKSk7XG5cdFx0c2VjdGlvbi5hZGRUb1NlY3Rpb24oc2VjdGlvbi5kcmF3U3ViSW5mb3MoKSk7XG5cdFx0c2VjdGlvbi5hZGRUb1NlY3Rpb24oc2VjdGlvbi5kcmF3UHJvdmlkZXJzKCkpO1xuXHRcdG1haW4uYXBwZW5kQ2hpbGQoc2VjdGlvbi5zZWN0aW9uKTtcblx0XHRyZXR1cm4gcmVuZGVyU2VjdGlvbjtcblx0fVxufVxuXG5mdW5jdGlvbiBjbGVhclNlY3Rpb25zKCkge1xuXHRjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWNvbnRhaW5lclwiKTtcblx0bWFpbi5pbm5lckhUTUwgPSBcIlwiO1xufVxuXG5leHBvcnQgeyBkcmF3U2VjdGlvbnMsIGNsZWFyU2VjdGlvbnMgfTtcbiIsImltcG9ydCB7IGRyYXdTZWN0aW9ucyB9IGZyb20gXCIuL2pzL0RPTUZ1bmN0aW9ucy9kcmF3U2VjdGlvbnNcIjtcbmltcG9ydCBhZGRTdWJtaXRTZWFyY2hGbmMgZnJvbSBcIi4vanMvVUkvc3VibWl0U2VhcmNoXCI7XG5cbmNvbnNvbGUubG9nKFwiSGVsbG8gV29ybGRcIik7XG4vLyBmZXRjaElkcygnSVJPTiBNQU4nKTtcblxuLy8gZmV0Y2hNb3ZpZUR1bW15KDE3MjYpO1xuLy8gZmV0Y2hNb3ZpZUR1bW15KDMwOTcpOyAvLyBmYWlsIHRvIGZldGNoIGJlY2F1c2UgaXRzIHR2LlxuLy8gZmV0Y2hNb3ZpZUR1bW15KDEwMTM4KTtcbi8vIGZldGNoTW92aWVEdW1teSg2ODcyMSk7XG5cbi8vIGFzeW5jIGZ1bmN0aW9uIGZldGNoTW92aWVEdW1teShpZCkge1xuLy8gICAgIGNvbnN0IG1vdmllRGV0YWlscyA9IGF3YWl0IG1vdmllLmZldGNoTW92aWVEZXRhaWxzKGlkKTtcbi8vICAgICBjb25zdCBtb3ZpZVJlY2NvcyA9IGF3YWl0IG1vdmllLmZldGNoTW92aWVSZWNjb3MoaWQpO1xuLy8gICAgIGNvbnN0IG1vdmllUHJvdmlkZXJzID0gYXdhaXQgbW92aWUuZmV0Y2hNb3ZpZVByb3ZpZGVycyhpZCk7XG4vLyAgICAgY29uc3QgbW92aWVUcmFpbGVyID0gYXdhaXQgbW92aWUuZmV0Y2hNb3ZpZVRyYWlsZXIoaWQpO1xuLy8gICAgIGNvbnN0IG1vdmllUmV2aWV3cyA9IGF3YWl0IG1vdmllLmZldGNoTW92aWVSZXZpZXdzKGlkKTtcbi8vICAgICBjb25zb2xlLmxvZyhtb3ZpZURldGFpbHMpO1xuLy8gICAgIGNvbnNvbGUubG9nKG1vdmllUmVjY29zKTtcbi8vICAgICBjb25zb2xlLmxvZyhtb3ZpZVByb3ZpZGVycyk7XG4vLyAgICAgY29uc29sZS5sb2cobW92aWVUcmFpbGVyKTtcbi8vICAgICBjb25zb2xlLmxvZyhtb3ZpZVJldmlld3MpO1xuLy8gfVxuXG4vLyBhZGRTdWJtaXRTZWFyY2hGdW5jdGlvbigpO1xuXG5hZGRTdWJtaXRTZWFyY2hGbmMoKTtcbmRyYXdTZWN0aW9ucyhcIm11bW1pZXNcIik7XG4iLCJpbXBvcnQgeyBkcmF3U2VjdGlvbnMsIGNsZWFyU2VjdGlvbnMgfSBmcm9tIFwiLi4vRE9NRnVuY3Rpb25zL2RyYXdTZWN0aW9uc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBhZGRTdWJtaXRTZWFyY2hGbmMoKSB7XG5cdGNvbnN0IHNlYXJjaEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2VhcmNoLXF1ZXJ5XCIpO1xuXHRzZWFyY2hCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFzeW5jIChlKSA9PiB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGNvbnN0IHF1ZXJ5ID0gaW50ZXJwcmV0VG9RdWVyeShcblx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW5wdXQtc2VhcmNoXCIpLnZhbHVlXG5cdFx0KTtcblx0XHRpZiAoIXF1ZXJ5KSB7XG5cdFx0XHRhbGVydChcIlBsZWFzZSBlbnRlciBhIHZhbGlkIG1vdmllL3R2IHNob3dcIik7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGNsZWFyU2VjdGlvbnMoKTtcblx0XHRhd2FpdCBkcmF3U2VjdGlvbnMocXVlcnkpO1xuXG5cdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zZWFyY2gtcXVlcnlcIikudmFsdWUgPSBcIlwiO1xuXHR9KTtcbn1cblxuZnVuY3Rpb24gaW50ZXJwcmV0VG9RdWVyeShuYW1lKSB7XG5cdHJldHVybiBuYW1lLnNwbGl0KFwiIFwiKS5qb2luKFwiK1wiKTtcbn1cbiJdLCJuYW1lcyI6WyJBUElfS0VZIiwiYXN5bmMiLCJmZXRjaE1vdmllRGV0YWlscyIsIm1vdmllX2lkIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1vZGUiLCJkYXRhIiwianNvbiIsImdlbnJlcyIsInJlZHVjZSIsImFjYyIsInZhbCIsIm5hbWUiLCJtTmFtZSIsIm9yaWdpbmFsX3RpdGxlIiwic3VtbWFyeSIsIm92ZXJ2aWV3IiwidGFnbGluZSIsInBvcHVsYXJpdHkiLCJ2b3RlX2F2ZXJhZ2UiLCJ2b3RlX2NvdW50IiwidmlkZW8iLCJydW50aW1lIiwicG9zdGVyX3BhdGgiLCJiYWNrZHJvcF9wYXRoIiwiZXJyIiwiYWxlcnQiLCJmZXRjaE1vdmllUmVjY29zIiwicmVjTW92aWVzIiwicmVzdWx0cyIsImNvdW50IiwibW92aWUiLCJpZCIsImZldGNoTW92aWVQcm92aWRlcnMiLCJwcm92aWRlcnNCeUNvdW50cnkiLCJjb3VudHJ5Q29kZSIsImNvdW50cnkiLCJjb2RlIiwiSW50bCIsIkRpc3BsYXlOYW1lcyIsInR5cGUiLCJvZiIsInN0cmVhbSIsInJlbnQiLCJidXkiLCJzb3J0UHJvdmlkZXJzIiwic2VydmljZXMiLCJjb2xsZWN0aW9uIiwiZm9yRWFjaCIsInNlcnZpY2UiLCJwcm92aWRlckluZm8iLCJwcm92aWRlcl9uYW1lIiwicHJvdmlkZXJfbG9nb19wYXRoIiwibG9nb19wYXRoIiwicHVzaCIsImZsYXRyYXRlIiwiY29uc29sZSIsImxvZyIsImZldGNoTW92aWVUcmFpbGVyIiwibW92aWVUcmFpbGVyIiwidHJhaWxlcnMiLCJmaWx0ZXIiLCJsZW5ndGgiLCJvZmZpY2lhbCIsImtleSIsInNpdGUiLCJsYW5nIiwiaXNvXzYzOV8xIiwiZmV0Y2hNb3ZpZVJldmlld3MiLCJyZXZpZXdzIiwicmV2aWV3IiwiYXV0aG9yIiwicmF0aW5nIiwiYXV0aG9yX2RldGFpbHMiLCJwaWNfcGF0aCIsImF2YXRhcl9wYXRoIiwiY29udGVudCIsInVybCIsImxhc3RfdXBkYXRlZCIsInVwZGF0ZWRfYXQiLCJzbGljZSIsImRyYXdTZWN0aW9uIiwibWVkaWEiLCJzZWN0aW9uIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiZGV0YWlscyIsImdldEluZm8iLCJwcm92aWRlcnMiLCJhZGRUb1NlY3Rpb24iLCJwYXJ0IiwiYXBwZW5kQ2hpbGQiLCJtb3ZpZUZuYyIsInR2Rm5jIiwiZHJhd0ludHJvIiwiaW1nU2l6ZSIsImludHJvQ29udGFpbmVyIiwiY2xhc3NMaXN0IiwiYWRkIiwidGl0bGUiLCJ0ZXh0Q29udGVudCIsImNyZWF0ZVRpdGxlIiwidGFnUGFyYSIsIndyaXRlVGFnbGluZSIsImltZyIsInBvc3RlciIsImJhc2VJbWdVcmwiLCJpbWdfcGF0aCIsInNyYyIsImFsdCIsInJlbmRlckltZyIsInBhcmEiLCJ3cml0ZVN1bW1hcnkiLCJkcmF3QWxsIiwiZHJhd1N1YkluZm9zIiwiY29udGFpbmVyIiwiY3JlYXRlU3ViSW5mbyIsImNhdGVnb3J5IiwiaW5mbyIsInN1YkluZm8iLCJjYXRlZ29yeU5hbWUiLCJjYXRlZ29yeUluZm8iLCJqb2luIiwibWlucyIsImhvdXJzIiwickhvdXJzIiwiTWF0aCIsImZsb29yIiwibWludXRlcyIsInJvdW5kIiwiY29udmVydE1pblRvSHIiLCJkcmF3UHJvdmlkZXJzIiwicmVuZGVyRWxlbWVudCIsInRhZyIsImNsYXNzTmFtZSIsInByb3ZpZGVyQ29udGFpbmVyIiwiY291bnRyeUJ0biIsImhvdXNlQ29udGFpbmVyIiwiZWxlbSIsIk9iamVjdCIsImtleXMiLCJpbmNsdWRlcyIsImNvdW50cnlOYW1lIiwic3RyZWFtSW5mbyIsImJ1eUluZm8iLCJyZW50SW5mbyIsInNlcnZpY2VOYW1lcyIsImlkeCIsInNlcnZpY2VDb250YWluZXIiLCJzZXJ2aWNlTmFtZSIsInByb3ZpZGVyU2VydmljZUNvbnRhaW5lciIsInByb3ZpZGVyIiwicHJvdmlkZXJTZXJ2aWNlIiwicHJvdmlkZXJJbWciLCJwcm92aWRlck5hbWUiLCJkcmF3UHJvdmlkZXIiLCJkcmF3U2VjdGlvbnMiLCJpZHMiLCJxdWVyeSIsInNwbGl0IiwiaW50ZXJwcmV0VG9RdWVyeSIsInJlc3VsdCIsImkiLCJtZWRpYV90eXBlIiwiZmV0Y2hJZHMiLCJtYWluIiwicXVlcnlTZWxlY3RvciIsInNlY3Rpb25zIiwicmVuZGVyU2VjdGlvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJnZXRFbGVtZW50QnlJZCIsInZhbHVlIiwiaW5uZXJIVE1MIiwiYWRkU3VibWl0U2VhcmNoRm5jIl0sInNvdXJjZVJvb3QiOiIifQ==