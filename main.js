(()=>{"use strict";const t="720d2150cf09bfa61e28a5042cd7468f",e="720d2150cf09bfa61e28a5042cd7468f";async function n(t){try{const n=await fetch(`https://api.themoviedb.org/3/movie/${t}?api_key=${e}&language=en-US`,{mode:"cors"}),a=await n.json(),o=a.genres.reduce(((t,e)=>[...t,e.name]),[]);return{mName:a.original_title,summary:a.overview,tagline:a.tagline,popularity:a.popularity,vote_average:a.vote_average,vote_count:a.vote_count,genres:o,video:a.video,runtime:a.runtime,poster_path:a.poster_path,backdrop_path:a.backdrop_path}}catch(t){alert(t)}}async function a(t){try{const n=await fetch(`https://api.themoviedb.org/3/movie/${t}/recommendations?api_key=${e}&language=en-US&page=1`,{mode:"cors"}),a=await n.json(),o={};if(a.results){let t=1;for(let e of a.results){if(o[e.original_title]={mName:e.original_title,id:e.id,poster_path:e.poster_path,backdrop_path:e.backdrop_path},5===t)break;t++}}return o}catch(t){alert(t)}}async function o(t){const n={};try{const o=await fetch(`https://api.themoviedb.org/3/movie/${t}/watch/providers?api_key=${e}`,{mode:"cors"}),r=await o.json();for(const t in r.results){const e=(a=t,new Intl.DisplayNames(["en"],{type:"region"}).of(a));n[e]={stream:[],rent:[],buy:[],countryCode:t};const o=(t,e)=>{t&&t.forEach((t=>{const n={provider_name:t.provider_name,provider_logo_path:t.logo_path};e.push(n)}))};o(r.results[t].flatrate,n[e].stream),o(r.results[t].rent,n[e].rent),o(r.results[t].buy,n[e].buy)}return n}catch(t){alert(t)}var a}async function r(t){try{let a;const o=await fetch(`https://api.themoviedb.org/3/movie/${t}/videos?api_key=${e}`,{mode:"cors"}),r=(await o.json()).results.filter((t=>"Trailer"===t.type));if(0===r.length)return!1;const i=r.filter((t=>{t.official}));return a=0!==i.length?i[0]:r[0],{mName:a.name,key:a.key,site:a.site,type:a.type,lang:(n=a.iso_639_1,new Intl.DisplayNames(["en"],{type:"language"}).of(n))}}catch(t){alert(t)}var n}async function i(t){try{let n=[];const a=await fetch(`https://api.themoviedb.org/3/movie/${t}/reviews?api_key=${e}&language=en-US&page=1`,{mode:"cors"}),o=await a.json();if(0===o.results.length)return!1;let r=1;return o.results.forEach((t=>{n.push({author:t.author,rating:t.author_details.rating,pic_path:t.author_details.avatar_path,content:t.content,url:t.url,last_updated:t.updated_at}),r++})),n.slice(0,5)}catch(t){alert(t)}}const c=async(t,e)=>{const c=document.createElement("section"),s=await p(t,n),l=(await p(t,a),await p(t,o));function d(t){c.appendChild(t)}function u(t,e){const n=document.createElement(t);return n.classList.add(e),n}async function p(t,n,a){return"movie"===e?await n(t):""}console.log(l),await p(t,r),await p(t,i);const m=t=>{const e=document.createElement("div");e.classList.add("intro"),e.appendChild(function(){const t=document.createElement("h1");return t.textContent=s.mName,t.classList.add("title"),t}()),s.tagline&&e.appendChild(function(){const t=document.createElement("p");return t.textContent=s.tagline,t.classList.add("tagline"),t}());const n=function(t=""){const e=document.createElement("img"),n="https://image.tmdb.org/t/p";let a;if(e.classList.add("poster"),s.poster_path)a=s.poster_path;else{if(!s.backdrop_path)return;a=s.backdrop_path}return e.src=t?`${n}/w${t}/${a}`:`${n}/original/${a}`,e.alt="Movie picture poster",e}(t);return n&&e.appendChild(n),e.appendChild(function(){const t=document.createElement("p");return t.textContent=s.summary,t.classList.add("summary"),t}()),e};return{section:c,addToSection:d,drawAll:function(){d(m())},drawIntro:m,drawSubInfos:()=>{const t=document.createElement("div");function e(t,e){const n=document.createElement("div"),a=document.createElement("span"),o=document.createElement("span");return n.classList.add("sub-info"),a.classList.add("category-name"),o.classList.add("category-info"),a.textContent=t,o.textContent=e,[a,o].forEach((t=>n.appendChild(t))),n}return t.classList.add("subinfo-container"),[e("Genres:",s.genres.join(", ")),e("Runtime:",function(t){const e=t/60,n=Math.floor(e),a=60*(e-n);return`${n}h ${Math.round(a)}min`}(s.runtime)),e("Vote Average:",s.vote_average),e("Vote Count:",s.vote_count),e("Popularity:",s.popularity)].forEach((e=>t.appendChild(e))),t},drawProviders:()=>{let t;const e=u("div","provider-container"),n=u("button","country-btn"),a=u("div","house-provider-container");if([n,a].forEach((t=>{e.appendChild(t)})),Object.keys(l).length)if(t=!0,Object.keys(l).includes("Australia"))o("Australia"),n.textContent="Australia";else{const t=Object.keys(l)[0];o(t),n.textContent=`${t}`}else t=!1,n.textContent="No countries offer this tv/movie at the moment.";return n.addEventListener("click",(e=>{e.preventDefault(),t&&function(t){const e=Object.keys(l);let n,a={};e.forEach((e=>{a[e]=l[e].countryCode,t===e&&(n=l[e].countryCode)}));const o=u("form","modal-country-container"),r=u("div","modal-header"),i=u("div","modal-body"),c=u("div","modal-current-country"),s=u("input","modal-input-search"),d=u("ul","modal-list-countries"),p=u("button","modal-close-btn");function m(t,e){const n=u("img","country-flag");return n.setAttribute("crossorigin","anonymous"),n.src=`https://countryflagsapi.com/png/${t}`,n.alt=`${e} flag`,n}function h(){let t,e,n,a,o,r,i;for(t=document.getElementById("modal-input-search"),e=t.value.toUpperCase(),n=document.getElementById("countries-list"),a=n.getElementsByTagName("li"),r=0;r<a.length;r++)o=a[r].getElementsByTagName("a")[0],i=o.textContent||o.innerText,i.toUpperCase().indexOf(e)>-1?a[r].style.display="":a[r].style.display="none"}(()=>{const e=document.createElement("h2");e.textContent="Countries";const a=document.createElement("h3"),o=document.createElement("label"),i=u("i","fa"),l={id:"modal-input-search",type:"text",placeholder:"Search for countries...",title:"Type in a country name"};for(let t in l)s.setAttribute(t,l[t]);s.addEventListener("keyup",h);const d=m(n,t);a.textContent=t,c.appendChild(d),c.appendChild(a),o.htmlFor=`${s.id}`,i.classList.add("fa-search"),o.appendChild(i),[e,c,o,s].forEach((t=>{r.appendChild(t)}))})(),(()=>{d.id="countries-list";for(let t in a){let e=a[t];const n=u("li","country-container"),o=m(e,t),r=u("a","country-name");r.textContent=t,r.setAttribute("href","#"),[o,r].forEach((t=>{n.appendChild(t)})),d.appendChild(n)}[d].forEach((t=>{i.appendChild(t)}))})(),(t=>{const e=u("i","fa");e.classList.add("fa-close"),p.appendChild(e),t()})((()=>{p.addEventListener("click",(t=>{t.preventDefault(),document.querySelector(".modal-country-container").remove(),document.querySelector(".face-mask").style.display="none"}))})),[r,i,p].forEach((t=>o.appendChild(t))),document.querySelector("body").append(o),document.querySelector(".face-mask").style.display="block"}(n.textContent)})),e;function o(t="Australia"){n.textContent=t;const e=l[t].stream,o=l[t].buy,r=l[t].rent,i=["Stream at:","Purchase at:","Rent at:"];let c=0;[e,o,r].forEach((t=>{const e=u("div","service-container"),n=u("div","service-name"),o=u("h2","service-name-bold"),r=u("div","provider-service-container");t.forEach((t=>{const e=u("div","provider-service"),n=u("img","provider-img"),a=u("span","provider-name");t.provider_logo_path&&(n.src=`https://image.tmdb.org/t/p/original/${t.provider_logo_path}`,n.alt=`${t.provider_name} picture.`,a.textContent=t.provider_name),[n,a].forEach((t=>{e.appendChild(t)})),r.appendChild(e)})),t.length&&(o.textContent=`${i[c]}`,n.appendChild(o)),c++,e.appendChild(n),e.appendChild(r),a.appendChild(e)}))}}}};async function s(e){const n=await async function(e){const n=function(t){return t.split(" ").join("+")}(e);try{const a=await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${t}&language=en-US&query=${n}&page=1`,{mode:"cors"}),o=await a.json();let r={},i=o.results.sort(((t,e)=>t.popularity<e.popularity?1:t.popularity>e.popularity?-1:0));if(i.length){for(let t=0;t<i.length;t++)r[i[t].id]=i[t].media_type;return r}return void alert(`No results found for ${e}`)}catch(t){alert(t)}}(e),a=document.querySelector(".main-container");let o=[];for(let t in n)"movie"===n[t]&&o.push([t,n[t]]);async function r(t,e){const n=await c(t,e);return n.addToSection(n.drawIntro("300")),n.addToSection(n.drawSubInfos()),n.addToSection(n.drawProviders()),a.appendChild(n.section),r}o.forEach((async t=>await r(t[0],t[1])))}console.log("Hello World"),async function(){document.querySelector(".search-query").addEventListener("click",(async t=>{t.preventDefault();const e=document.getElementById("input-search").value.split(" ").join("+");e?(document.querySelector(".main-container").innerHTML="",await s(e),document.querySelector(".search-query").value=""):alert("Please enter a valid movie/tv show")}))}(),s("iron man")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFpQixRQUFRQyxJQUFJLGVDREduRyxpQkFDSWtGLFNBQVNpSCxjQUFjLGlCQUMvQmxELGlCQUFpQixTQUFTakosTUFBT2tKLElBQzFDQSxFQUFFQyxpQkFDRixNQUFNb0UsRUFDTHJJLFNBQVN3RixlQUFlLGdCQUFnQkMsTUFjOUI2QyxNQUFNLEtBQUszRixLQUFLLEtBWnRCMEYsR0Z1Qk9ySSxTQUFTaUgsY0FBYyxtQkFDL0JnQyxVQUFZLFNFbkJWZCxFQUFhRSxHQUVuQnJJLFNBQVNpSCxjQUFjLGlCQUFpQnhCLE1BQVEsSUFOL0NqSixNQUFNLHFDQU0yQyxHQUVwRCxDRFFBME0sR0FDQWYsRUFBYSxXIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbW92aWVtYXRlLy4vc3JjL2pzL2FwaUZ1bmN0aW9ucy9mZXRjaElkLmpzIiwid2VicGFjazovL21vdmllbWF0ZS8uL3NyYy9qcy9hcGlGdW5jdGlvbnMvZmV0Y2hNb3ZpZUluZm8uanMiLCJ3ZWJwYWNrOi8vbW92aWVtYXRlLy4vc3JjL2pzL0RPTUZ1bmN0aW9ucy9kcmF3U2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9tb3ZpZW1hdGUvLi9zcmMvanMvRE9NRnVuY3Rpb25zL2RyYXdTZWN0aW9ucy5qcyIsIndlYnBhY2s6Ly9tb3ZpZW1hdGUvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vbW92aWVtYXRlLy4vc3JjL2pzL1VJL3N1Ym1pdFNlYXJjaC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBBUElfS0VZID0gXCI3MjBkMjE1MGNmMDliZmE2MWUyOGE1MDQyY2Q3NDY4ZlwiO1xuLypcbkZldGNoZXMgdGhlIHRoZSBmaXJzdCBwYWdlIG9mIHRoZSBtb3ZpZS9zaG93IGlkcyBhbmQgcmV0dXJuIGl0IGluIGFuIGFycmF5LlxuKi9cbmFzeW5jIGZ1bmN0aW9uIGZldGNoSWRzKG5hbWUpIHtcblx0Y29uc3QgcXVlcnkgPSBpbnRlcnByZXRUb1F1ZXJ5KG5hbWUpO1xuXHR0cnkge1xuXHRcdGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG5cdFx0XHRgaHR0cHM6Ly9hcGkudGhlbW92aWVkYi5vcmcvMy9zZWFyY2gvbXVsdGk/YXBpX2tleT0ke0FQSV9LRVl9Jmxhbmd1YWdlPWVuLVVTJnF1ZXJ5PSR7cXVlcnl9JnBhZ2U9MWAsXG5cdFx0XHR7IG1vZGU6IFwiY29yc1wiIH1cblx0XHQpO1xuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cdFx0bGV0IGlkcyA9IHt9O1xuXHRcdC8vIGxldCByZXN1bHQgPSBkYXRhLnJlc3VsdHM7XG5cdFx0bGV0IHJlc3VsdCA9IGRhdGEucmVzdWx0cy5zb3J0KFxuXHRcdFx0KHAxLCBwMikgPT4gKHAxLnBvcHVsYXJpdHkgPCBwMi5wb3B1bGFyaXR5KSA/IDEgOiAocDEucG9wdWxhcml0eSA+IHAyLnBvcHVsYXJpdHkpID8gLTEgOiAwXG5cdFx0KSAvLyBTb3J0IGJ5IHBvcHVsYXJpdHkuXG5cdFx0XG5cdFx0aWYgKHJlc3VsdC5sZW5ndGgpIHtcblx0XHRcdC8vIGlmIChyZXN1bHQubGVuZ3RoID4gNCkge1xuXHRcdFx0Ly8gXHRmb3IgKGxldCBpID0gMDsgaSA8IDU7IGkrKykge1xuXHRcdFx0Ly8gXHRcdGlkc1tyZXN1bHRbaV0uaWRdID0gcmVzdWx0W2ldLm1lZGlhX3R5cGU7XG5cdFx0XHQvLyBcdH1cblx0XHRcdC8vIH0gZWxzZSB7XG5cdFx0XHQvLyBcdGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7XG5cdFx0XHQvLyBcdFx0aWRzW3Jlc3VsdFtpXS5pZF0gPSByZXN1bHRbaV0ubWVkaWFfdHlwZTtcblx0XHRcdC8vIFx0fVxuXHRcdFx0Ly8gfVxuXHRcdFx0Zm9yKGxldCBpID0gMDsgaSA8IHJlc3VsdC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRpZHNbcmVzdWx0W2ldLmlkXSA9IHJlc3VsdFtpXS5tZWRpYV90eXBlO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGlkcztcblx0XHR9IGVsc2Uge1xuXHRcdFx0YWxlcnQoYE5vIHJlc3VsdHMgZm91bmQgZm9yICR7bmFtZX1gKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdH0gY2F0Y2ggKGVycikge1xuXHRcdGFsZXJ0KGVycik7XG5cdH1cbn1cblxuZnVuY3Rpb24gaW50ZXJwcmV0VG9RdWVyeShuYW1lKSB7XG5cdHJldHVybiBuYW1lLnNwbGl0KFwiIFwiKS5qb2luKFwiK1wiKTtcbn1cblxuZXhwb3J0IHsgZmV0Y2hJZHMgfTtcbiIsImNvbnN0IEFQSV9LRVkgPSBcIjcyMGQyMTUwY2YwOWJmYTYxZTI4YTUwNDJjZDc0NjhmXCI7XG5cbmFzeW5jIGZ1bmN0aW9uIGZldGNoTW92aWVEZXRhaWxzKG1vdmllX2lkKSB7XG5cdHRyeSB7XG5cdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcblx0XHRcdGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL21vdmllLyR7bW92aWVfaWR9P2FwaV9rZXk9JHtBUElfS0VZfSZsYW5ndWFnZT1lbi1VU2AsXG5cdFx0XHR7IG1vZGU6IFwiY29yc1wiIH1cblx0XHQpO1xuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cblx0XHRjb25zdCBnZW5yZXMgPSBkYXRhLmdlbnJlcy5yZWR1Y2UoKGFjYywgdmFsKSA9PiBbLi4uYWNjLCB2YWwubmFtZV0sIFtdKTtcblxuXHRcdGNvbnN0IGdlbmVyYWxJbmZvID0ge1xuXHRcdFx0bU5hbWU6IGRhdGEub3JpZ2luYWxfdGl0bGUsXG5cdFx0XHRzdW1tYXJ5OiBkYXRhLm92ZXJ2aWV3LFxuXHRcdFx0dGFnbGluZTogZGF0YS50YWdsaW5lLFxuXHRcdFx0cG9wdWxhcml0eTogZGF0YS5wb3B1bGFyaXR5LFxuXHRcdFx0dm90ZV9hdmVyYWdlOiBkYXRhLnZvdGVfYXZlcmFnZSxcblx0XHRcdHZvdGVfY291bnQ6IGRhdGEudm90ZV9jb3VudCxcblx0XHRcdGdlbnJlczogZ2VucmVzLFxuXHRcdFx0dmlkZW86IGRhdGEudmlkZW8sXG5cdFx0XHRydW50aW1lOiBkYXRhLnJ1bnRpbWUsXG5cdFx0XHRwb3N0ZXJfcGF0aDogZGF0YS5wb3N0ZXJfcGF0aCxcblx0XHRcdGJhY2tkcm9wX3BhdGg6IGRhdGEuYmFja2Ryb3BfcGF0aCxcblx0XHR9O1xuXHRcdHJldHVybiBnZW5lcmFsSW5mbztcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0YWxlcnQoZXJyKTtcblx0fVxufVxuXG4vKlxuUmV0dXJucyBhbiBhcnJheSBvZiByZWNvbW1lbmRlZCBtb3ZpZXMgd2l0aCB0aGVpciBuYW1lLCBpZCwgcG9zdGVyX3BhdGggYW5kXG5iYWNrZHJvcF9wYXRoIHJlY29yZGVkLiBcbklmIG5vIG1vdmllcyBhcmUgcmVjb21tZW5kZWQsIHJldHVybiBudWxsO1xuKi9cbmFzeW5jIGZ1bmN0aW9uIGZldGNoTW92aWVSZWNjb3MobW92aWVfaWQpIHtcblx0dHJ5IHtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuXHRcdFx0YGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvbW92aWUvJHttb3ZpZV9pZH0vcmVjb21tZW5kYXRpb25zP2FwaV9rZXk9JHtBUElfS0VZfSZsYW5ndWFnZT1lbi1VUyZwYWdlPTFgLFxuXHRcdFx0eyBtb2RlOiBcImNvcnNcIiB9XG5cdFx0KTtcblx0XHRjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG5cdFx0Y29uc3QgcmVjTW92aWVzID0ge307XG5cdFx0aWYgKGRhdGEucmVzdWx0cykge1xuXHRcdFx0bGV0IGNvdW50ID0gMTtcblx0XHRcdGZvciAobGV0IG1vdmllIG9mIGRhdGEucmVzdWx0cykge1xuXHRcdFx0XHRyZWNNb3ZpZXNbbW92aWUub3JpZ2luYWxfdGl0bGVdID0ge1xuXHRcdFx0XHRcdG1OYW1lOiBtb3ZpZS5vcmlnaW5hbF90aXRsZSxcblx0XHRcdFx0XHRpZDogbW92aWUuaWQsXG5cdFx0XHRcdFx0cG9zdGVyX3BhdGg6IG1vdmllLnBvc3Rlcl9wYXRoLFxuXHRcdFx0XHRcdGJhY2tkcm9wX3BhdGg6IG1vdmllLmJhY2tkcm9wX3BhdGgsXG5cdFx0XHRcdH07XG5cdFx0XHRcdGlmIChjb3VudCA9PT0gNSkge1xuXHRcdFx0XHRcdC8vIE1heCA1IG1vdmllcyB0byBiZSByZWNvbW1lbmRlZFxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGNvdW50Kys7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiByZWNNb3ZpZXM7XG5cdH0gY2F0Y2ggKGVycikge1xuXHRcdGFsZXJ0KGVycik7XG5cdH1cbn1cblxuLypcblJldHVybnMgYW4gb2JqZWN0IHdpdGggY291bnRyaWVzIGFuZCB0aGUgYXZhaWxhYmxlIHN0cmVhbWluZyBzZXJ2aWNlcywgYnV5XG5vciByZW50IGl0IGNvbWVzIHdpdGggRUFDSCBpbmRpdmlkdWFsIGNvdW50cnkuXG4qL1xuYXN5bmMgZnVuY3Rpb24gZmV0Y2hNb3ZpZVByb3ZpZGVycyhtb3ZpZV9pZCkge1xuXHRjb25zdCBwcm92aWRlcnNCeUNvdW50cnkgPSB7fTtcblx0dHJ5IHtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuXHRcdFx0YGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvbW92aWUvJHttb3ZpZV9pZH0vd2F0Y2gvcHJvdmlkZXJzP2FwaV9rZXk9JHtBUElfS0VZfWAsXG5cdFx0XHR7IG1vZGU6IFwiY29yc1wiIH1cblx0XHQpO1xuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cblx0XHRmb3IgKGNvbnN0IGNvdW50cnlDb2RlIGluIGRhdGEucmVzdWx0cykge1xuXHRcdFx0Y29uc3QgY291bnRyeSA9IGdldENvdW50cnlOYW1lKGNvdW50cnlDb2RlKTtcblx0XHRcdHByb3ZpZGVyc0J5Q291bnRyeVtjb3VudHJ5XSA9IHtcblx0XHRcdFx0c3RyZWFtOiBbXSxcblx0XHRcdFx0cmVudDogW10sXG5cdFx0XHRcdGJ1eTogW10sXG5cdFx0XHRcdGNvdW50cnlDb2RlOiBjb3VudHJ5Q29kZSxcblx0XHRcdH07XG5cblx0XHRcdC8qXG5cdFx0XHRTb3J0cyBwcm92aWRlcnMgYmFzZWQgb24gY291bnRyeSBhbmQgc2VydmljZXMgdGhleSBwcm92aWRlLlxuXG5cdFx0XHRUYWtlcyBpbiB0eXBlIG9mIHNlcnZpY2VzIGFzIHBhcmFtID0+IFtcImZsYXRyYXRlIChzdHJlYW1pbmcpXCIsIFxuXHRcdFx0XCJyZW50XCIsIFwiYnV5XCJdIGFuZCBhbiBhcnJheSB0byBhcHBlbmQgaXQgdG8uXG5cdFx0XHQqL1xuXHRcdFx0Y29uc3Qgc29ydFByb3ZpZGVycyA9IChzZXJ2aWNlcywgY29sbGVjdGlvbikgPT4ge1xuXHRcdFx0XHRpZiAoc2VydmljZXMpIHtcblx0XHRcdFx0XHRzZXJ2aWNlcy5mb3JFYWNoKChzZXJ2aWNlKSA9PiB7XG5cdFx0XHRcdFx0XHRjb25zdCBwcm92aWRlckluZm8gPSB7XG5cdFx0XHRcdFx0XHRcdHByb3ZpZGVyX25hbWU6IHNlcnZpY2UucHJvdmlkZXJfbmFtZSxcblx0XHRcdFx0XHRcdFx0cHJvdmlkZXJfbG9nb19wYXRoOiBzZXJ2aWNlLmxvZ29fcGF0aCxcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRjb2xsZWN0aW9uLnB1c2gocHJvdmlkZXJJbmZvKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblxuXHRcdFx0Ly8gQWRkIHN0cmVhbWluZyBzZXJ2aWNlcyBmb3Igc3BlY2lmaWVkIG1vdmllIGluIGVhY2ggY291bnRyeS5cblx0XHRcdHNvcnRQcm92aWRlcnMoXG5cdFx0XHRcdGRhdGEucmVzdWx0c1tjb3VudHJ5Q29kZV0uZmxhdHJhdGUsXG5cdFx0XHRcdHByb3ZpZGVyc0J5Q291bnRyeVtjb3VudHJ5XS5zdHJlYW1cblx0XHRcdCk7XG5cblx0XHRcdC8vIEFkZCByZW50aW5nIHNlcnZpY2VzIGZvciBzcGVpY2lmaWVkIG1vdmllIGluIGVhY2ggY291bnRyeS5cblx0XHRcdHNvcnRQcm92aWRlcnMoXG5cdFx0XHRcdGRhdGEucmVzdWx0c1tjb3VudHJ5Q29kZV0ucmVudCxcblx0XHRcdFx0cHJvdmlkZXJzQnlDb3VudHJ5W2NvdW50cnldLnJlbnRcblx0XHRcdCk7XG5cblx0XHRcdC8vIEFkZCBidXlpbmcgc2VydmljZXMgZm9yIHNwZWNpZmllZCBtb3ZpZSBpbiBlYWNoIGNvdW50cnkuXG5cdFx0XHRzb3J0UHJvdmlkZXJzKFxuXHRcdFx0XHRkYXRhLnJlc3VsdHNbY291bnRyeUNvZGVdLmJ1eSxcblx0XHRcdFx0cHJvdmlkZXJzQnlDb3VudHJ5W2NvdW50cnldLmJ1eVxuXHRcdFx0KTtcblx0XHR9XG5cdFx0cmV0dXJuIHByb3ZpZGVyc0J5Q291bnRyeTtcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0YWxlcnQoZXJyKTtcblx0fVxufVxuXG4vLyBGaW5kIG1vdmllIHRyYWlsZXIgYW5kIHJldHVybiBmYWxzZSBpZiBub25lIGNhbiBiZSBmb3VuZC5cbi8vIE9mZmljaWFsIHRyYWlsZXIgd2lsbCBiZSBwcmlvcml0aXNlZC5cbmFzeW5jIGZ1bmN0aW9uIGZldGNoTW92aWVUcmFpbGVyKG1vdmllX2lkKSB7XG5cdHRyeSB7XG5cdFx0bGV0IG1vdmllVHJhaWxlcjtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuXHRcdFx0YGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvbW92aWUvJHttb3ZpZV9pZH0vdmlkZW9zP2FwaV9rZXk9JHtBUElfS0VZfWAsXG5cdFx0XHR7IG1vZGU6IFwiY29yc1wiIH1cblx0XHQpO1xuXHRcdGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cblx0XHRjb25zdCB0cmFpbGVycyA9IGRhdGEucmVzdWx0cy5maWx0ZXIoKHZpZGVvKSA9PiB2aWRlby50eXBlID09PSBcIlRyYWlsZXJcIik7XG5cblx0XHRpZiAodHJhaWxlcnMubGVuZ3RoID09PSAwKSByZXR1cm4gZmFsc2U7XG5cdFx0Ly8gRmluZCBvZmZpY2lhbCB0cmFpbGVyLlxuXHRcdGNvbnN0IG9mZmljaWFsID0gdHJhaWxlcnMuZmlsdGVyKCh2aWRlbykgPT4ge1xuXHRcdFx0dmlkZW8ub2ZmaWNpYWwgPT09IHRydWU7XG5cdFx0fSk7XG5cblx0XHRvZmZpY2lhbC5sZW5ndGggIT09IDBcblx0XHRcdD8gKG1vdmllVHJhaWxlciA9IG9mZmljaWFsWzBdKVxuXHRcdFx0OiAobW92aWVUcmFpbGVyID0gdHJhaWxlcnNbMF0pO1xuXG5cdFx0cmV0dXJuIHtcblx0XHRcdG1OYW1lOiBtb3ZpZVRyYWlsZXIubmFtZSxcblx0XHRcdGtleTogbW92aWVUcmFpbGVyLmtleSxcblx0XHRcdHNpdGU6IG1vdmllVHJhaWxlci5zaXRlLFxuXHRcdFx0dHlwZTogbW92aWVUcmFpbGVyLnR5cGUsXG5cdFx0XHRsYW5nOiBnZXRMYW5ndWFnZShtb3ZpZVRyYWlsZXIuaXNvXzYzOV8xKSxcblx0XHR9O1xuXHR9IGNhdGNoIChlcnIpIHtcblx0XHRhbGVydChlcnIpO1xuXHR9XG59XG5cbi8vIFJldHVybnMgYW4gYXJyIG9mIGEgbWF4aW11bSBvZiA1IHJldmlld3MgYmFzZWQgb24gdGhlIG1vdmllIGZyb20gcmFuZG9tIHNvdXJjZXMuXG4vLyBJZiBubyByZXZpZXdzIGFyZSBmb3VuZCwgdGhpcyBmbmMgcmV0dXJucyBmYWxzZS5cbmFzeW5jIGZ1bmN0aW9uIGZldGNoTW92aWVSZXZpZXdzKG1vdmllX2lkKSB7XG5cdHRyeSB7XG5cdFx0bGV0IHJldmlld3MgPSBbXTtcblx0XHRjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuXHRcdFx0YGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvbW92aWUvJHttb3ZpZV9pZH0vcmV2aWV3cz9hcGlfa2V5PSR7QVBJX0tFWX0mbGFuZ3VhZ2U9ZW4tVVMmcGFnZT0xYCxcblx0XHRcdHsgbW9kZTogXCJjb3JzXCIgfVxuXHRcdCk7XG5cdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblx0XHRpZiAoZGF0YS5yZXN1bHRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuXG5cdFx0bGV0IGNvdW50ID0gMTtcblx0XHRkYXRhLnJlc3VsdHMuZm9yRWFjaCgocmV2aWV3KSA9PiB7XG5cdFx0XHRyZXZpZXdzLnB1c2goe1xuXHRcdFx0XHRhdXRob3I6IHJldmlldy5hdXRob3IsXG5cdFx0XHRcdHJhdGluZzogcmV2aWV3LmF1dGhvcl9kZXRhaWxzLnJhdGluZyxcblx0XHRcdFx0cGljX3BhdGg6IHJldmlldy5hdXRob3JfZGV0YWlscy5hdmF0YXJfcGF0aCxcblx0XHRcdFx0Y29udGVudDogcmV2aWV3LmNvbnRlbnQsXG5cdFx0XHRcdHVybDogcmV2aWV3LnVybCxcblx0XHRcdFx0bGFzdF91cGRhdGVkOiByZXZpZXcudXBkYXRlZF9hdCxcblx0XHRcdH0pO1xuXHRcdFx0Y291bnQrKztcblx0XHR9KTtcblx0XHRyZXR1cm4gcmV2aWV3cy5zbGljZSgwLCA1KTtcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0YWxlcnQoZXJyKTtcblx0fVxufVxuXG5mdW5jdGlvbiBnZXRDb3VudHJ5TmFtZShjb2RlKSB7XG5cdGxldCByZWdpb25OYW1lcyA9IG5ldyBJbnRsLkRpc3BsYXlOYW1lcyhbXCJlblwiXSwgeyB0eXBlOiBcInJlZ2lvblwiIH0pO1xuXHRyZXR1cm4gcmVnaW9uTmFtZXMub2YoY29kZSk7XG59XG5cbmZ1bmN0aW9uIGdldExhbmd1YWdlKGNvZGUpIHtcblx0Y29uc3QgbGFuZyA9IG5ldyBJbnRsLkRpc3BsYXlOYW1lcyhbXCJlblwiXSwgeyB0eXBlOiBcImxhbmd1YWdlXCIgfSk7XG5cdHJldHVybiBsYW5nLm9mKGNvZGUpO1xufVxuZXhwb3J0IHtcblx0ZmV0Y2hNb3ZpZURldGFpbHMsXG5cdGZldGNoTW92aWVSZWNjb3MsXG5cdGZldGNoTW92aWVQcm92aWRlcnMsXG5cdGZldGNoTW92aWVUcmFpbGVyLFxuXHRmZXRjaE1vdmllUmV2aWV3cyxcblx0Z2V0Q291bnRyeU5hbWUsXG59O1xuIiwiaW1wb3J0ICogYXMgbW92aWUgZnJvbSBcIi4uL2FwaUZ1bmN0aW9ucy9mZXRjaE1vdmllSW5mb1wiO1xuXG4vKlxuRHJhdyBhbiBpbmRpdmlkdWFsIHNlY3Rpb24gYmFzZWQgb24gdXNlciBpbnB1dCBxdWVyeS5cblRoaXMgc2VjdGlvbiB3aWxsIGNvbnN0cyBvZiB0aGUgb3ZlcmFsbCBtb3ZpZS90didzIFxuICAgIC0gRGV0YWlscyxcbiAgICAtIFRoZSB3YXRjaCBwcm92aWRlcnMgYmFzZWQgb24gc3BlY2lmaWMgY291bnRyaWVzXG4gICAgLSBBdmFpbGFibGUgdHJhaWxlcnMsXG4gICAgLSBPdGhlciByZWNvbW1lbmRhdGlvbnMuXG4gICAgLSBSZXZpZXdzIGJ5IGVzdGFibGlzaGVkIGF1dGhvcnMgYmFzZWQgZnJvbSByYW5kb20gc291cmNlcy5cbiovXG5cbmNvbnN0IGRyYXdTZWN0aW9uID0gYXN5bmMgKGlkLCBtZWRpYSkgPT4ge1xuXHRjb25zdCBzZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNlY3Rpb25cIik7XG5cdGNvbnN0IGRldGFpbHMgPSBhd2FpdCBnZXRJbmZvKGlkLCBtb3ZpZS5mZXRjaE1vdmllRGV0YWlscywgXCJcIik7XG5cdGNvbnN0IHJlY3MgPSBhd2FpdCBnZXRJbmZvKGlkLCBtb3ZpZS5mZXRjaE1vdmllUmVjY29zLCBcIlwiKTtcblx0Y29uc3QgcHJvdmlkZXJzID0gYXdhaXQgZ2V0SW5mbyhpZCwgbW92aWUuZmV0Y2hNb3ZpZVByb3ZpZGVycywgXCJcIik7XG5cdGNvbnNvbGUubG9nKHByb3ZpZGVycyk7XG5cdGNvbnN0IHRyYWlsZXIgPSBhd2FpdCBnZXRJbmZvKGlkLCBtb3ZpZS5mZXRjaE1vdmllVHJhaWxlciwgXCJcIik7XG5cdGNvbnN0IHJldmlld3MgPSBhd2FpdCBnZXRJbmZvKGlkLCBtb3ZpZS5mZXRjaE1vdmllUmV2aWV3cywgXCJcIik7XG5cblx0ZnVuY3Rpb24gZHJhd0FsbCgpIHtcblx0XHRhZGRUb1NlY3Rpb24oZHJhd0ludHJvKCkpO1xuXHR9XG5cblx0ZnVuY3Rpb24gYWRkVG9TZWN0aW9uKHBhcnQpIHtcblx0XHRzZWN0aW9uLmFwcGVuZENoaWxkKHBhcnQpO1xuXHR9XG5cblx0ZnVuY3Rpb24gcmVuZGVyRWxlbWVudCh0YWcsIGNsYXNzTmFtZSkge1xuXHRcdGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnKTtcblx0XHRjb250YWluZXIuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xuXHRcdHJldHVybiBjb250YWluZXI7XG5cdH1cblxuXHRhc3luYyBmdW5jdGlvbiBnZXRJbmZvKGlkLCBtb3ZpZUZuYywgdHZGbmMpIHtcblx0XHRyZXR1cm4gbWVkaWEgPT09IFwibW92aWVcIiA/IGF3YWl0IG1vdmllRm5jKGlkKSA6IFwiXCI7XG5cdH1cblxuXHQvLyBEcmF3IChpZiBhbnkpIHRpdGxlLCBwaG90bywgdGFnbGluZSwgYW5kIHN1bW1hcnkuXG5cdGNvbnN0IGRyYXdJbnRybyA9IChpbWdTaXplKSA9PiB7XG5cdFx0Y29uc3QgaW50cm9Db250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdGludHJvQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJpbnRyb1wiKTtcblxuXHRcdGludHJvQ29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZVRpdGxlKCkpO1xuXHRcdGRldGFpbHMudGFnbGluZSA/IGludHJvQ29udGFpbmVyLmFwcGVuZENoaWxkKHdyaXRlVGFnbGluZSgpKSA6IFwiXCI7XG5cblx0XHRjb25zdCBpbWcgPSByZW5kZXJJbWcoaW1nU2l6ZSk7XG5cdFx0aW1nID8gaW50cm9Db250YWluZXIuYXBwZW5kQ2hpbGQoaW1nKSA6IFwiXCI7XG5cblx0XHRpbnRyb0NvbnRhaW5lci5hcHBlbmRDaGlsZCh3cml0ZVN1bW1hcnkoKSk7XG5cblx0XHRmdW5jdGlvbiBjcmVhdGVUaXRsZSgpIHtcblx0XHRcdGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgxXCIpO1xuXHRcdFx0dGl0bGUudGV4dENvbnRlbnQgPSBkZXRhaWxzLm1OYW1lO1xuXHRcdFx0dGl0bGUuY2xhc3NMaXN0LmFkZChcInRpdGxlXCIpO1xuXHRcdFx0cmV0dXJuIHRpdGxlO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHJlbmRlckltZyhpbWdTaXplID0gXCJcIikge1xuXHRcdFx0Y29uc3QgcG9zdGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKTtcblx0XHRcdGNvbnN0IGJhc2VJbWdVcmwgPSBcImh0dHBzOi8vaW1hZ2UudG1kYi5vcmcvdC9wXCI7XG5cdFx0XHRsZXQgaW1nX3BhdGg7XG5cdFx0XHRwb3N0ZXIuY2xhc3NMaXN0LmFkZChcInBvc3RlclwiKTtcblxuXHRcdFx0aWYgKGRldGFpbHMucG9zdGVyX3BhdGgpIHtcblx0XHRcdFx0aW1nX3BhdGggPSBkZXRhaWxzLnBvc3Rlcl9wYXRoO1xuXHRcdFx0fSBlbHNlIGlmIChkZXRhaWxzLmJhY2tkcm9wX3BhdGgpIHtcblx0XHRcdFx0aW1nX3BhdGggPSBkZXRhaWxzLmJhY2tkcm9wX3BhdGg7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHQhaW1nU2l6ZVxuXHRcdFx0XHQ/IChwb3N0ZXIuc3JjID0gYCR7YmFzZUltZ1VybH0vb3JpZ2luYWwvJHtpbWdfcGF0aH1gKVxuXHRcdFx0XHQ6IChwb3N0ZXIuc3JjID0gYCR7YmFzZUltZ1VybH0vdyR7aW1nU2l6ZX0vJHtpbWdfcGF0aH1gKTtcblx0XHRcdHBvc3Rlci5hbHQgPSBcIk1vdmllIHBpY3R1cmUgcG9zdGVyXCI7XG5cdFx0XHRyZXR1cm4gcG9zdGVyO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHdyaXRlVGFnbGluZSgpIHtcblx0XHRcdGNvbnN0IHRhZ1BhcmEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcblx0XHRcdHRhZ1BhcmEudGV4dENvbnRlbnQgPSBkZXRhaWxzLnRhZ2xpbmU7XG5cdFx0XHR0YWdQYXJhLmNsYXNzTGlzdC5hZGQoXCJ0YWdsaW5lXCIpO1xuXHRcdFx0cmV0dXJuIHRhZ1BhcmE7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gd3JpdGVTdW1tYXJ5KCkge1xuXHRcdFx0Y29uc3QgcGFyYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuXHRcdFx0cGFyYS50ZXh0Q29udGVudCA9IGRldGFpbHMuc3VtbWFyeTtcblx0XHRcdHBhcmEuY2xhc3NMaXN0LmFkZChcInN1bW1hcnlcIik7XG5cdFx0XHRyZXR1cm4gcGFyYTtcblx0XHR9XG5cdFx0cmV0dXJuIGludHJvQ29udGFpbmVyO1xuXHR9O1xuXG5cdGNvbnN0IGRyYXdTdWJJbmZvcyA9ICgpID0+IHtcblx0XHRjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwic3ViaW5mby1jb250YWluZXJcIik7XG5cblx0XHRjb25zdCBpbmZvcm1hdGlvbiA9IFtcblx0XHRcdGNyZWF0ZVN1YkluZm8oXCJHZW5yZXM6XCIsIGRldGFpbHMuZ2VucmVzLmpvaW4oXCIsIFwiKSksXG5cdFx0XHRjcmVhdGVTdWJJbmZvKFwiUnVudGltZTpcIiwgY29udmVydE1pblRvSHIoZGV0YWlscy5ydW50aW1lKSksXG5cdFx0XHRjcmVhdGVTdWJJbmZvKFwiVm90ZSBBdmVyYWdlOlwiLCBkZXRhaWxzLnZvdGVfYXZlcmFnZSksXG5cdFx0XHRjcmVhdGVTdWJJbmZvKFwiVm90ZSBDb3VudDpcIiwgZGV0YWlscy52b3RlX2NvdW50KSxcblx0XHRcdGNyZWF0ZVN1YkluZm8oXCJQb3B1bGFyaXR5OlwiLCBkZXRhaWxzLnBvcHVsYXJpdHkpLFxuXHRcdF07XG5cblx0XHRpbmZvcm1hdGlvbi5mb3JFYWNoKChpbmZvKSA9PiBjb250YWluZXIuYXBwZW5kQ2hpbGQoaW5mbykpO1xuXG5cdFx0ZnVuY3Rpb24gY3JlYXRlU3ViSW5mbyhjYXRlZ29yeSwgaW5mbykge1xuXHRcdFx0Y29uc3Qgc3ViSW5mbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XHRjb25zdCBjYXRlZ29yeU5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblx0XHRcdGNvbnN0IGNhdGVnb3J5SW5mbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuXG5cdFx0XHRzdWJJbmZvLmNsYXNzTGlzdC5hZGQoXCJzdWItaW5mb1wiKTtcblx0XHRcdGNhdGVnb3J5TmFtZS5jbGFzc0xpc3QuYWRkKFwiY2F0ZWdvcnktbmFtZVwiKTtcblx0XHRcdGNhdGVnb3J5SW5mby5jbGFzc0xpc3QuYWRkKFwiY2F0ZWdvcnktaW5mb1wiKTtcblxuXHRcdFx0Y2F0ZWdvcnlOYW1lLnRleHRDb250ZW50ID0gY2F0ZWdvcnk7XG5cdFx0XHRjYXRlZ29yeUluZm8udGV4dENvbnRlbnQgPSBpbmZvO1xuXG5cdFx0XHRbY2F0ZWdvcnlOYW1lLCBjYXRlZ29yeUluZm9dLmZvckVhY2goKGluZm8pID0+IHN1YkluZm8uYXBwZW5kQ2hpbGQoaW5mbykpO1xuXHRcdFx0cmV0dXJuIHN1YkluZm87XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gY29udmVydE1pblRvSHIobWlucykge1xuXHRcdFx0Y29uc3QgaG91cnMgPSBtaW5zIC8gNjA7XG5cdFx0XHRjb25zdCBySG91cnMgPSBNYXRoLmZsb29yKGhvdXJzKTtcblx0XHRcdGNvbnN0IG1pbnV0ZXMgPSAoaG91cnMgLSBySG91cnMpICogNjA7XG5cdFx0XHRjb25zdCByTWludXRlcyA9IE1hdGgucm91bmQobWludXRlcyk7XG5cdFx0XHRyZXR1cm4gYCR7ckhvdXJzfWggJHtyTWludXRlc31taW5gO1xuXHRcdH1cblxuXHRcdHJldHVybiBjb250YWluZXI7XG5cdH07XG5cblx0Y29uc3QgZHJhd1Byb3ZpZGVycyA9ICgpID0+IHtcblx0XHRsZXQgYXZhaWxQcm92aWRlcnM7IC8vIEJvb2xlYW4gdGhhdCBpbmRpY2F0ZXMgaWYgdGhlcmUgYXJlIGFueSB3YXRjaFxuXHRcdC8vIHByb3ZpZGVycyBmb3IgdGhpcyBzaG93LlxuXG5cdFx0Ly8gSG91c2VzIHRoZSBidG4gdGhhdCBvcGVucyB0aGUgbW9kYWwgYW5kIG92ZXJsYXksIGFuZCB0aGUgYXZhaWxhYmxlIHByb3ZpZGVycyBmb3IgJ3N0cmVhbWluZycsICdyZW50JyBhbmQgJ3B1cmNoYXNlJy5cblx0XHRjb25zdCBwcm92aWRlckNvbnRhaW5lciA9IHJlbmRlckVsZW1lbnQoXCJkaXZcIiwgXCJwcm92aWRlci1jb250YWluZXJcIik7XG5cdFx0Y29uc3QgY291bnRyeUJ0biA9IHJlbmRlckVsZW1lbnQoXCJidXR0b25cIiwgXCJjb3VudHJ5LWJ0blwiKTtcblx0XHRjb25zdCBob3VzZUNvbnRhaW5lciA9IHJlbmRlckVsZW1lbnQoXCJkaXZcIiwgXCJob3VzZS1wcm92aWRlci1jb250YWluZXJcIik7XG5cdFx0W2NvdW50cnlCdG4sIGhvdXNlQ29udGFpbmVyXS5mb3JFYWNoKChlbGVtKSA9PiB7XG5cdFx0XHRwcm92aWRlckNvbnRhaW5lci5hcHBlbmRDaGlsZChlbGVtKTtcblx0XHR9KTtcblxuXHRcdC8vIFNlYXJjaCBmb3IgZGVmYXVsdCBjb3VudHJ5IFwiQXVzdHJhbGlhXCIuIElmIG5vbmUgZm91bmQuIERyYXcgdGhlIGZpcnN0IGNvdW50cnkncyBwcm92aWRlci5cblx0XHRpZiAoT2JqZWN0LmtleXMocHJvdmlkZXJzKS5sZW5ndGgpIHtcblx0XHRcdGF2YWlsUHJvdmlkZXJzID0gdHJ1ZTtcblx0XHRcdGlmIChPYmplY3Qua2V5cyhwcm92aWRlcnMpLmluY2x1ZGVzKFwiQXVzdHJhbGlhXCIpKSB7XG5cdFx0XHRcdGRyYXdQcm92aWRlcihcIkF1c3RyYWxpYVwiKTtcblx0XHRcdFx0Y291bnRyeUJ0bi50ZXh0Q29udGVudCA9IFwiQXVzdHJhbGlhXCI7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zdCBmaXJzdFByb3ZpZGVyID0gT2JqZWN0LmtleXMocHJvdmlkZXJzKVswXTtcblx0XHRcdFx0ZHJhd1Byb3ZpZGVyKGZpcnN0UHJvdmlkZXIpO1xuXHRcdFx0XHRjb3VudHJ5QnRuLnRleHRDb250ZW50ID0gYCR7Zmlyc3RQcm92aWRlcn1gO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRhdmFpbFByb3ZpZGVycyA9IGZhbHNlO1xuXHRcdFx0Y291bnRyeUJ0bi50ZXh0Q29udGVudCA9XG5cdFx0XHRcdFwiTm8gY291bnRyaWVzIG9mZmVyIHRoaXMgdHYvbW92aWUgYXQgdGhlIG1vbWVudC5cIjtcblx0XHR9XG5cblx0XHQvLyBhdmFpbFByb3ZpZGVycyA/IHJlbmRlckNvdW50cmllc01vZGFsKGNvdW50cnlCdG4udGV4dENvbnRlbnQpIDogXCJcIjsgLy8gdGVtcFxuXHRcdC8vIEFkZCBidG4gZXZlbnQgY2xpY2sgbGlzdGVuZXIgdG8gb3BlbiBtb2RhbFxuXHRcdGNvdW50cnlCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRpZiAoYXZhaWxQcm92aWRlcnMpIHtcblx0XHRcdFx0cmVuZGVyQ291bnRyaWVzTW9kYWwoY291bnRyeUJ0bi50ZXh0Q29udGVudCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gcHJvdmlkZXJDb250YWluZXI7XG5cblx0XHRmdW5jdGlvbiBkcmF3UHJvdmlkZXIoY291bnRyeU5hbWUgPSBcIkF1c3RyYWxpYVwiKSB7XG5cdFx0XHQvLyBDaGFuZ2UgdGV4dCBvZiBidG4gdG8gY291bnRyeU5hbWVcblx0XHRcdGNvdW50cnlCdG4udGV4dENvbnRlbnQgPSBjb3VudHJ5TmFtZTtcblxuXHRcdFx0Y29uc3Qgc3RyZWFtSW5mbyA9IHByb3ZpZGVyc1tjb3VudHJ5TmFtZV0uc3RyZWFtO1xuXHRcdFx0Y29uc3QgYnV5SW5mbyA9IHByb3ZpZGVyc1tjb3VudHJ5TmFtZV0uYnV5O1xuXHRcdFx0Y29uc3QgcmVudEluZm8gPSBwcm92aWRlcnNbY291bnRyeU5hbWVdLnJlbnQ7XG5cblx0XHRcdGNvbnN0IHNlcnZpY2VOYW1lcyA9IFtcIlN0cmVhbSBhdDpcIiwgXCJQdXJjaGFzZSBhdDpcIiwgXCJSZW50IGF0OlwiXTtcblx0XHRcdC8vIFRvIGFzc2lnbiBuYW1lcyBmb3IgZWFjaCBzZXZpY2UgcHJvdmlkZXJzLlxuXHRcdFx0Ly8gVGhpcyBpbmNyZW1lbnRzIGFzIHByb3ZpZGVycyBhcmUgbGlzdGVkIGZvciBlYWNoIHNlcnZpY2UuXG5cdFx0XHRsZXQgaWR4ID0gMDtcblxuXHRcdFx0W3N0cmVhbUluZm8sIGJ1eUluZm8sIHJlbnRJbmZvXS5mb3JFYWNoKChpbmZvKSA9PiB7XG5cdFx0XHRcdGNvbnN0IHNlcnZpY2VDb250YWluZXIgPSByZW5kZXJFbGVtZW50KFwiZGl2XCIsIFwic2VydmljZS1jb250YWluZXJcIik7XG5cdFx0XHRcdGNvbnN0IHNlcnZpY2VOYW1lID0gcmVuZGVyRWxlbWVudChcImRpdlwiLCBcInNlcnZpY2UtbmFtZVwiKTtcblx0XHRcdFx0Y29uc3Qgc2VydmljZU5hbWVCb2xkID0gcmVuZGVyRWxlbWVudChcImgyXCIsIFwic2VydmljZS1uYW1lLWJvbGRcIik7XG5cdFx0XHRcdGNvbnN0IHByb3ZpZGVyU2VydmljZUNvbnRhaW5lciA9IHJlbmRlckVsZW1lbnQoXG5cdFx0XHRcdFx0XCJkaXZcIixcblx0XHRcdFx0XHRcInByb3ZpZGVyLXNlcnZpY2UtY29udGFpbmVyXCJcblx0XHRcdFx0KTtcblxuXHRcdFx0XHRpbmZvLmZvckVhY2goKHByb3ZpZGVyKSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgcHJvdmlkZXJTZXJ2aWNlID0gcmVuZGVyRWxlbWVudChcImRpdlwiLCBcInByb3ZpZGVyLXNlcnZpY2VcIik7XG5cdFx0XHRcdFx0Ly8gQWRkIGltZyBhbmQgbmFtZSBvZiBwcm92aWRlci5cblx0XHRcdFx0XHRjb25zdCBwcm92aWRlckltZyA9IHJlbmRlckVsZW1lbnQoXCJpbWdcIiwgXCJwcm92aWRlci1pbWdcIik7XG5cdFx0XHRcdFx0Y29uc3QgcHJvdmlkZXJOYW1lID0gcmVuZGVyRWxlbWVudChcInNwYW5cIiwgXCJwcm92aWRlci1uYW1lXCIpO1xuXG5cdFx0XHRcdFx0aWYgKHByb3ZpZGVyLnByb3ZpZGVyX2xvZ29fcGF0aCkge1xuXHRcdFx0XHRcdFx0cHJvdmlkZXJJbWcuc3JjID0gYGh0dHBzOi8vaW1hZ2UudG1kYi5vcmcvdC9wL29yaWdpbmFsLyR7cHJvdmlkZXIucHJvdmlkZXJfbG9nb19wYXRofWA7XG5cdFx0XHRcdFx0XHRwcm92aWRlckltZy5hbHQgPSBgJHtwcm92aWRlci5wcm92aWRlcl9uYW1lfSBwaWN0dXJlLmA7XG5cdFx0XHRcdFx0XHRwcm92aWRlck5hbWUudGV4dENvbnRlbnQgPSBwcm92aWRlci5wcm92aWRlcl9uYW1lO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFtwcm92aWRlckltZywgcHJvdmlkZXJOYW1lXS5mb3JFYWNoKChlbGVtKSA9PiB7XG5cdFx0XHRcdFx0XHRwcm92aWRlclNlcnZpY2UuYXBwZW5kQ2hpbGQoZWxlbSk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0cHJvdmlkZXJTZXJ2aWNlQ29udGFpbmVyLmFwcGVuZENoaWxkKHByb3ZpZGVyU2VydmljZSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGlmIChpbmZvLmxlbmd0aCkge1xuXHRcdFx0XHRcdHNlcnZpY2VOYW1lQm9sZC50ZXh0Q29udGVudCA9IGAke3NlcnZpY2VOYW1lc1tpZHhdfWA7XG5cdFx0XHRcdFx0c2VydmljZU5hbWUuYXBwZW5kQ2hpbGQoc2VydmljZU5hbWVCb2xkKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZHgrKztcblx0XHRcdFx0c2VydmljZUNvbnRhaW5lci5hcHBlbmRDaGlsZChzZXJ2aWNlTmFtZSk7XG5cdFx0XHRcdHNlcnZpY2VDb250YWluZXIuYXBwZW5kQ2hpbGQocHJvdmlkZXJTZXJ2aWNlQ29udGFpbmVyKTtcblx0XHRcdFx0aG91c2VDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VydmljZUNvbnRhaW5lcik7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH07XG5cblx0ZnVuY3Rpb24gcmVuZGVyQ291bnRyaWVzTW9kYWwoY3VyckNvdW50cnlOYW1lKSB7XG5cdFx0Ly8gQ291bnRyeSBuYW1lc1xuXHRcdGNvbnN0IHByb3ZpZGVyQ291bnRyaWVzID0gT2JqZWN0LmtleXMocHJvdmlkZXJzKTtcblx0XHQvLyBTb3J0IGJ5IGNvdW50cnkgbmFtZSBhbmQgY29kZXMgaW50byBhbiBvYmouXG5cdFx0bGV0IGNvdW50cmllcyA9IHt9O1xuXHRcdGxldCBjdXJyQ291bnRyeUNvZGU7XG5cdFx0cHJvdmlkZXJDb3VudHJpZXMuZm9yRWFjaCgoY291bnRyeSkgPT4ge1xuXHRcdFx0Y291bnRyaWVzW2NvdW50cnldID0gcHJvdmlkZXJzW2NvdW50cnldLmNvdW50cnlDb2RlO1xuXG5cdFx0XHQvLyBGaW5kIGN1cnJlbnQgY291bnRyeSBjb2RlLlxuXHRcdFx0aWYgKGN1cnJDb3VudHJ5TmFtZSA9PT0gY291bnRyeSkge1xuXHRcdFx0XHRjdXJyQ291bnRyeUNvZGUgPSBwcm92aWRlcnNbY291bnRyeV0uY291bnRyeUNvZGU7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRjb25zdCBtb2RhbENvbnRhaW5lciA9IHJlbmRlckVsZW1lbnQoXCJmb3JtXCIsIFwibW9kYWwtY291bnRyeS1jb250YWluZXJcIik7XG5cdFx0Y29uc3QgbW9kYWxIZWFkZXIgPSByZW5kZXJFbGVtZW50KFwiZGl2XCIsIFwibW9kYWwtaGVhZGVyXCIpO1xuXG5cdFx0Y29uc3QgbW9kYWxCb2R5ID0gcmVuZGVyRWxlbWVudChcImRpdlwiLCBcIm1vZGFsLWJvZHlcIik7XG5cdFx0Y29uc3QgbW9kYWxDdXJyZW50Q291bnRyeSA9IHJlbmRlckVsZW1lbnQoXCJkaXZcIiwgXCJtb2RhbC1jdXJyZW50LWNvdW50cnlcIik7XG5cdFx0Y29uc3QgbW9kYWxJbnB1dFNlYXJjaCA9IHJlbmRlckVsZW1lbnQoXCJpbnB1dFwiLCBcIm1vZGFsLWlucHV0LXNlYXJjaFwiKTtcblx0XHRjb25zdCBtb2RhbExpc3RDb3VudHJpZXMgPSByZW5kZXJFbGVtZW50KFwidWxcIiwgXCJtb2RhbC1saXN0LWNvdW50cmllc1wiKTtcblxuXHRcdGNvbnN0IG1vZGFsQ2xvc2VCdG4gPSByZW5kZXJFbGVtZW50KFwiYnV0dG9uXCIsIFwibW9kYWwtY2xvc2UtYnRuXCIpO1xuXG5cdFx0Y29uc3QgcmVuZGVySGVhZGluZyA9ICgpID0+IHtcblx0XHRcdC8vIEhlYWRpbmcgdGhhdCBkaXNwbGF5cyBjdXJyZW50IGNvdW50cnkgc2VsZWN0ZWQuXG5cdFx0XHRjb25zdCBoZWFkaW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgyXCIpO1xuXHRcdFx0aGVhZGluZy50ZXh0Q29udGVudCA9IFwiQ291bnRyaWVzXCI7XG5cblx0XHRcdGNvbnN0IGN1cnJDb3VudHJ5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgzXCIpO1xuXHRcdFx0Y29uc3Qgc2VhcmNoTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7XG5cdFx0XHRjb25zdCBzZWFyY2hTeW1iID0gcmVuZGVyRWxlbWVudChcImlcIiwgXCJmYVwiKTtcblxuXHRcdFx0Y29uc3Qgc2VhcmNoQXR0cmlidXRlcyA9IHtcblx0XHRcdFx0aWQ6IFwibW9kYWwtaW5wdXQtc2VhcmNoXCIsXG5cdFx0XHRcdHR5cGU6IFwidGV4dFwiLFxuXHRcdFx0XHQvLyBvbmtleXVwOiBcImZpbHRlclwiLFxuXHRcdFx0XHRwbGFjZWhvbGRlcjogXCJTZWFyY2ggZm9yIGNvdW50cmllcy4uLlwiLFxuXHRcdFx0XHR0aXRsZTogXCJUeXBlIGluIGEgY291bnRyeSBuYW1lXCJcblx0XHRcdH1cblxuXHRcdFx0Zm9yKGxldCBpIGluIHNlYXJjaEF0dHJpYnV0ZXMpIHtcblx0XHRcdFx0bW9kYWxJbnB1dFNlYXJjaC5zZXRBdHRyaWJ1dGUoaSwgc2VhcmNoQXR0cmlidXRlc1tpXSk7XG5cdFx0XHR9XG5cdFx0XHRtb2RhbElucHV0U2VhcmNoLmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBmaWx0ZXJSZXN1bHRzKVxuXG5cdFx0XHQvLyBGaW5kIGN1cnJlbnQgY291bnRyeSBuYW1lIGFuZCBjb2RlLlxuXHRcdFx0Y29uc3QgY3VyckNvdW50cnlGbGFnID0gcmVuZGVyQ291bnRyeUZsYWcoXG5cdFx0XHRcdGN1cnJDb3VudHJ5Q29kZSxcblx0XHRcdFx0Y3VyckNvdW50cnlOYW1lXG5cdFx0XHQpO1xuXHRcdFx0Y3VyckNvdW50cnkudGV4dENvbnRlbnQgPSBjdXJyQ291bnRyeU5hbWU7XG5cblx0XHRcdG1vZGFsQ3VycmVudENvdW50cnkuYXBwZW5kQ2hpbGQoY3VyckNvdW50cnlGbGFnKTtcblx0XHRcdG1vZGFsQ3VycmVudENvdW50cnkuYXBwZW5kQ2hpbGQoY3VyckNvdW50cnkpO1xuXG5cdFx0XHRzZWFyY2hMYWJlbC5odG1sRm9yID0gYCR7bW9kYWxJbnB1dFNlYXJjaC5pZH1gO1xuXHRcdFx0c2VhcmNoU3ltYi5jbGFzc0xpc3QuYWRkKFwiZmEtc2VhcmNoXCIpO1xuXHRcdFx0c2VhcmNoTGFiZWwuYXBwZW5kQ2hpbGQoc2VhcmNoU3ltYik7XG5cblx0XHRcdFtoZWFkaW5nLCBtb2RhbEN1cnJlbnRDb3VudHJ5LCBzZWFyY2hMYWJlbCwgbW9kYWxJbnB1dFNlYXJjaF0uZm9yRWFjaChcblx0XHRcdFx0KGZvcm1FbGVtKSA9PiB7XG5cdFx0XHRcdFx0bW9kYWxIZWFkZXIuYXBwZW5kQ2hpbGQoZm9ybUVsZW0pO1xuXHRcdFx0XHR9XG5cdFx0XHQpO1xuXHRcdH07XG5cblx0XHRjb25zdCByZW5kZXJCb2R5ID0gKCkgPT4ge1xuXHRcdFx0bW9kYWxMaXN0Q291bnRyaWVzLmlkID0gJ2NvdW50cmllcy1saXN0J1xuXHRcdFx0Zm9yKGxldCBjb3VudHJ5IGluIGNvdW50cmllcykge1xuXHRcdFx0XHRsZXQgY291bnRyeUNvZGUgPSBjb3VudHJpZXNbY291bnRyeV1cblxuXHRcdFx0XHRjb25zdCBjb3VudHJ5Q29udGFpbmVyID0gcmVuZGVyRWxlbWVudCgnbGknLCAnY291bnRyeS1jb250YWluZXInKTtcblx0XHRcdFx0Y29uc3QgY291bnRyeUZsYWcgPSByZW5kZXJDb3VudHJ5RmxhZyhjb3VudHJ5Q29kZSwgY291bnRyeSk7XG5cdFx0XHRcdGNvbnN0IGNvdW50cnlOYW1lID0gcmVuZGVyRWxlbWVudCgnYScsICdjb3VudHJ5LW5hbWUnKTtcblxuXHRcdFx0XHRjb3VudHJ5TmFtZS50ZXh0Q29udGVudCA9IGNvdW50cnk7XG5cdFx0XHRcdGNvdW50cnlOYW1lLnNldEF0dHJpYnV0ZSgnaHJlZicsICcjJyk7XG5cblx0XHRcdFx0W2NvdW50cnlGbGFnLCBjb3VudHJ5TmFtZV0uZm9yRWFjaChjb3VudHJ5RWxlbSA9PiB7XG5cdFx0XHRcdFx0Y291bnRyeUNvbnRhaW5lci5hcHBlbmRDaGlsZChjb3VudHJ5RWxlbSk7XG5cdFx0XHRcdH0pXG5cdFx0XHRcdG1vZGFsTGlzdENvdW50cmllcy5hcHBlbmRDaGlsZChjb3VudHJ5Q29udGFpbmVyKTtcblx0XHRcdH1cblxuXG5cdFx0XHRbbW9kYWxMaXN0Q291bnRyaWVzXS5mb3JFYWNoKChmb3JtRWxlbSkgPT4ge1xuXHRcdFx0XHRtb2RhbEJvZHkuYXBwZW5kQ2hpbGQoZm9ybUVsZW0pO1xuXHRcdFx0fSk7XG5cdFx0fTtcblxuXHRcdGNvbnN0IHJlbmRlckNsb3NlQnRuID0gKGNsb3NlRm5jKSA9PiB7XG5cdFx0XHRjb25zdCBjbG9zZVN5bWIgPSByZW5kZXJFbGVtZW50KFwiaVwiLCBcImZhXCIpO1xuXHRcdFx0Y2xvc2VTeW1iLmNsYXNzTGlzdC5hZGQoXCJmYS1jbG9zZVwiKTtcblx0XHRcdG1vZGFsQ2xvc2VCdG4uYXBwZW5kQ2hpbGQoY2xvc2VTeW1iKTtcblx0XHRcdGNsb3NlRm5jKCk7XG5cdFx0fTtcblx0XHRjb25zdCBhZGRDbG9zZUZuYyA9ICgpID0+IHtcblx0XHRcdG1vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0Y29uc3QgY3VycmVudEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsLWNvdW50cnktY29udGFpbmVyXCIpO1xuXHRcdFx0XHRjdXJyZW50Rm9ybS5yZW1vdmUoKTtcblx0XHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mYWNlLW1hc2tcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXHRcdFx0fSk7XG5cdFx0fTtcblxuXHRcdC8vIFJlbmRlciBzZWN0aW9ucyBvZiB0aGUgZm9ybS5cblx0XHRyZW5kZXJIZWFkaW5nKCk7XG5cdFx0cmVuZGVyQm9keSgpO1xuXHRcdHJlbmRlckNsb3NlQnRuKGFkZENsb3NlRm5jKTtcblxuXHRcdFttb2RhbEhlYWRlciwgbW9kYWxCb2R5LCBtb2RhbENsb3NlQnRuXS5mb3JFYWNoKChtb2RhbEVsZW0pID0+XG5cdFx0XHRtb2RhbENvbnRhaW5lci5hcHBlbmRDaGlsZChtb2RhbEVsZW0pXG5cdFx0KTtcblxuXHRcdGNvbnN0IGJvZHlEb2N1bWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJib2R5XCIpO1xuXHRcdGJvZHlEb2N1bWVudC5hcHBlbmQobW9kYWxDb250YWluZXIpO1xuXHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZmFjZS1tYXNrXCIpLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG5cblx0XHRmdW5jdGlvbiByZW5kZXJDb3VudHJ5RmxhZyhjb3VudHJ5Q29kZSwgY291bnRyeU5hbWUpIHtcblx0XHRcdGNvbnN0IGZsYWcgPSByZW5kZXJFbGVtZW50KFwiaW1nXCIsIFwiY291bnRyeS1mbGFnXCIpO1xuXHRcdFx0ZmxhZy5zZXRBdHRyaWJ1dGUoXCJjcm9zc29yaWdpblwiLCBcImFub255bW91c1wiKTtcblx0XHRcdGZsYWcuc3JjID0gYGh0dHBzOi8vY291bnRyeWZsYWdzYXBpLmNvbS9wbmcvJHtjb3VudHJ5Q29kZX1gO1xuXHRcdFx0ZmxhZy5hbHQgPSBgJHtjb3VudHJ5TmFtZX0gZmxhZ2A7XG5cdFx0XHRyZXR1cm4gZmxhZztcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBmaWx0ZXJSZXN1bHRzKCkge1xuXHRcdFx0bGV0IGlucHV0LCBmaWx0ZXIsIHVsLCBsaSwgYSwgaSwgdHh0VmFsdWU7XG5cdFx0XHRpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbC1pbnB1dC1zZWFyY2gnKTtcblx0XHRcdGZpbHRlciA9IGlucHV0LnZhbHVlLnRvVXBwZXJDYXNlKCk7XG5cdFx0XHR1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY291bnRyaWVzLWxpc3RcIik7XG5cdFx0XHRsaSA9IHVsLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdsaScpO1xuXHRcdFx0Zm9yKGkgPSAwOyBpIDwgbGkubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0YSA9IGxpW2ldLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiYVwiKVswXTtcblx0XHRcdFx0dHh0VmFsdWUgPSBhLnRleHRDb250ZW50IHx8IGEuaW5uZXJUZXh0O1xuXHRcdFx0XHRpZih0eHRWYWx1ZS50b1VwcGVyQ2FzZSgpLmluZGV4T2YoZmlsdGVyKSA+IC0xKSB7XG5cdFx0XHRcdFx0bGlbaV0uc3R5bGUuZGlzcGxheSA9IFwiXCI7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0bGlbaV0uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdHJldHVybiB7XG5cdFx0c2VjdGlvbixcblx0XHRhZGRUb1NlY3Rpb24sXG5cdFx0ZHJhd0FsbCxcblx0XHRkcmF3SW50cm8sXG5cdFx0ZHJhd1N1YkluZm9zLFxuXHRcdGRyYXdQcm92aWRlcnMsXG5cdH07XG59O1xuXG5leHBvcnQgeyBkcmF3U2VjdGlvbiB9O1xuIiwiaW1wb3J0IGNvbGxlY3RTZWFyY2hRdWVyeSBmcm9tIFwiLi9zZWFyY2hcIjtcbmltcG9ydCB7IGZldGNoSWRzIH0gZnJvbSBcIi4uL2FwaUZ1bmN0aW9ucy9mZXRjaElkXCI7XG5pbXBvcnQgKiBhcyBtb3ZpZSBmcm9tIFwiLi4vYXBpRnVuY3Rpb25zL2ZldGNoTW92aWVJbmZvXCI7XG5pbXBvcnQgeyBkcmF3U2VjdGlvbiB9IGZyb20gXCIuL2RyYXdTZWN0aW9uXCI7XG5cbmFzeW5jIGZ1bmN0aW9uIGRyYXdTZWN0aW9ucyh0aXRsZSkge1xuXHRjb25zdCBpZHMgPSBhd2FpdCBmZXRjaElkcyh0aXRsZSk7XG5cdGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4tY29udGFpbmVyXCIpO1xuXHRsZXQgc2VjdGlvbnMgPSBbXTtcblxuXHQvLyBNYWtlIGFuIGFyciB3LyBlbGVtcyBvZiBbaWQsIG1lZGlhXVxuXHRmb3IgKGxldCBpZCBpbiBpZHMpIHtcblx0XHQvLyBUZW1wIG1ha2UgaXQgc28gdGhhdCBpdCBvbmx5IGFjY2VwdHMgbW92aWVzXG5cblx0XHRpZHNbaWRdID09PSBcIm1vdmllXCIgPyBzZWN0aW9ucy5wdXNoKFtpZCwgaWRzW2lkXV0pIDogXCJcIjtcblx0fVxuXG5cdHNlY3Rpb25zLmZvckVhY2goXG5cdFx0YXN5bmMgKHNlY3Rpb24pID0+IGF3YWl0IHJlbmRlclNlY3Rpb24oc2VjdGlvblswXSwgc2VjdGlvblsxXSlcblx0KTtcblxuXHRhc3luYyBmdW5jdGlvbiByZW5kZXJTZWN0aW9uKGlkLCBtZWRpYSkge1xuXHRcdGNvbnN0IHNlY3Rpb24gPSBhd2FpdCBkcmF3U2VjdGlvbihpZCwgbWVkaWEpO1xuXHRcdHNlY3Rpb24uYWRkVG9TZWN0aW9uKHNlY3Rpb24uZHJhd0ludHJvKFwiMzAwXCIpKTtcblx0XHRzZWN0aW9uLmFkZFRvU2VjdGlvbihzZWN0aW9uLmRyYXdTdWJJbmZvcygpKTtcblx0XHRzZWN0aW9uLmFkZFRvU2VjdGlvbihzZWN0aW9uLmRyYXdQcm92aWRlcnMoKSk7XG5cdFx0bWFpbi5hcHBlbmRDaGlsZChzZWN0aW9uLnNlY3Rpb24pO1xuXHRcdHJldHVybiByZW5kZXJTZWN0aW9uO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGNsZWFyU2VjdGlvbnMoKSB7XG5cdGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4tY29udGFpbmVyXCIpO1xuXHRtYWluLmlubmVySFRNTCA9IFwiXCI7XG59XG5cbmV4cG9ydCB7IGRyYXdTZWN0aW9ucywgY2xlYXJTZWN0aW9ucyB9O1xuIiwiaW1wb3J0IHsgZHJhd1NlY3Rpb25zIH0gZnJvbSBcIi4vanMvRE9NRnVuY3Rpb25zL2RyYXdTZWN0aW9uc1wiO1xuaW1wb3J0IGFkZFN1Ym1pdFNlYXJjaEZuYyBmcm9tIFwiLi9qcy9VSS9zdWJtaXRTZWFyY2hcIjtcblxuY29uc29sZS5sb2coXCJIZWxsbyBXb3JsZFwiKTtcbi8vIGZldGNoSWRzKCdJUk9OIE1BTicpO1xuXG4vLyBmZXRjaE1vdmllRHVtbXkoMTcyNik7XG4vLyBmZXRjaE1vdmllRHVtbXkoMzA5Nyk7IC8vIGZhaWwgdG8gZmV0Y2ggYmVjYXVzZSBpdHMgdHYuXG4vLyBmZXRjaE1vdmllRHVtbXkoMTAxMzgpO1xuLy8gZmV0Y2hNb3ZpZUR1bW15KDY4NzIxKTtcblxuLy8gYXN5bmMgZnVuY3Rpb24gZmV0Y2hNb3ZpZUR1bW15KGlkKSB7XG4vLyAgICAgY29uc3QgbW92aWVEZXRhaWxzID0gYXdhaXQgbW92aWUuZmV0Y2hNb3ZpZURldGFpbHMoaWQpO1xuLy8gICAgIGNvbnN0IG1vdmllUmVjY29zID0gYXdhaXQgbW92aWUuZmV0Y2hNb3ZpZVJlY2NvcyhpZCk7XG4vLyAgICAgY29uc3QgbW92aWVQcm92aWRlcnMgPSBhd2FpdCBtb3ZpZS5mZXRjaE1vdmllUHJvdmlkZXJzKGlkKTtcbi8vICAgICBjb25zdCBtb3ZpZVRyYWlsZXIgPSBhd2FpdCBtb3ZpZS5mZXRjaE1vdmllVHJhaWxlcihpZCk7XG4vLyAgICAgY29uc3QgbW92aWVSZXZpZXdzID0gYXdhaXQgbW92aWUuZmV0Y2hNb3ZpZVJldmlld3MoaWQpO1xuLy8gICAgIGNvbnNvbGUubG9nKG1vdmllRGV0YWlscyk7XG4vLyAgICAgY29uc29sZS5sb2cobW92aWVSZWNjb3MpO1xuLy8gICAgIGNvbnNvbGUubG9nKG1vdmllUHJvdmlkZXJzKTtcbi8vICAgICBjb25zb2xlLmxvZyhtb3ZpZVRyYWlsZXIpO1xuLy8gICAgIGNvbnNvbGUubG9nKG1vdmllUmV2aWV3cyk7XG4vLyB9XG5cbi8vIGFkZFN1Ym1pdFNlYXJjaEZ1bmN0aW9uKCk7XG5cbmFkZFN1Ym1pdFNlYXJjaEZuYygpO1xuZHJhd1NlY3Rpb25zKFwiaXJvbiBtYW5cIik7XG4vLyBkcmF3U2VjdGlvbnMoXCJwZWUgbWFrXCIpO1xuIiwiaW1wb3J0IHsgZHJhd1NlY3Rpb25zLCBjbGVhclNlY3Rpb25zIH0gZnJvbSBcIi4uL0RPTUZ1bmN0aW9ucy9kcmF3U2VjdGlvbnNcIjtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gYWRkU3VibWl0U2VhcmNoRm5jKCkge1xuXHRjb25zdCBzZWFyY2hCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNlYXJjaC1xdWVyeVwiKTtcblx0c2VhcmNoQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoZSkgPT4ge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRjb25zdCBxdWVyeSA9IGludGVycHJldFRvUXVlcnkoXG5cdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImlucHV0LXNlYXJjaFwiKS52YWx1ZVxuXHRcdCk7XG5cdFx0aWYgKCFxdWVyeSkge1xuXHRcdFx0YWxlcnQoXCJQbGVhc2UgZW50ZXIgYSB2YWxpZCBtb3ZpZS90diBzaG93XCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRjbGVhclNlY3Rpb25zKCk7XG5cdFx0YXdhaXQgZHJhd1NlY3Rpb25zKHF1ZXJ5KTtcblxuXHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2VhcmNoLXF1ZXJ5XCIpLnZhbHVlID0gXCJcIjtcblx0fSk7XG59XG5cbmZ1bmN0aW9uIGludGVycHJldFRvUXVlcnkobmFtZSkge1xuXHRyZXR1cm4gbmFtZS5zcGxpdChcIiBcIikuam9pbihcIitcIik7XG59XG4iXSwibmFtZXMiOlsiQVBJX0tFWSIsImFzeW5jIiwiZmV0Y2hNb3ZpZURldGFpbHMiLCJtb3ZpZV9pZCIsInJlc3BvbnNlIiwiZmV0Y2giLCJtb2RlIiwiZGF0YSIsImpzb24iLCJnZW5yZXMiLCJyZWR1Y2UiLCJhY2MiLCJ2YWwiLCJuYW1lIiwibU5hbWUiLCJvcmlnaW5hbF90aXRsZSIsInN1bW1hcnkiLCJvdmVydmlldyIsInRhZ2xpbmUiLCJwb3B1bGFyaXR5Iiwidm90ZV9hdmVyYWdlIiwidm90ZV9jb3VudCIsInZpZGVvIiwicnVudGltZSIsInBvc3Rlcl9wYXRoIiwiYmFja2Ryb3BfcGF0aCIsImVyciIsImFsZXJ0IiwiZmV0Y2hNb3ZpZVJlY2NvcyIsInJlY01vdmllcyIsInJlc3VsdHMiLCJjb3VudCIsIm1vdmllIiwiaWQiLCJmZXRjaE1vdmllUHJvdmlkZXJzIiwicHJvdmlkZXJzQnlDb3VudHJ5IiwiY291bnRyeUNvZGUiLCJjb3VudHJ5IiwiY29kZSIsIkludGwiLCJEaXNwbGF5TmFtZXMiLCJ0eXBlIiwib2YiLCJzdHJlYW0iLCJyZW50IiwiYnV5Iiwic29ydFByb3ZpZGVycyIsInNlcnZpY2VzIiwiY29sbGVjdGlvbiIsImZvckVhY2giLCJzZXJ2aWNlIiwicHJvdmlkZXJJbmZvIiwicHJvdmlkZXJfbmFtZSIsInByb3ZpZGVyX2xvZ29fcGF0aCIsImxvZ29fcGF0aCIsInB1c2giLCJmbGF0cmF0ZSIsImZldGNoTW92aWVUcmFpbGVyIiwibW92aWVUcmFpbGVyIiwidHJhaWxlcnMiLCJmaWx0ZXIiLCJsZW5ndGgiLCJvZmZpY2lhbCIsImtleSIsInNpdGUiLCJsYW5nIiwiaXNvXzYzOV8xIiwiZmV0Y2hNb3ZpZVJldmlld3MiLCJyZXZpZXdzIiwicmV2aWV3IiwiYXV0aG9yIiwicmF0aW5nIiwiYXV0aG9yX2RldGFpbHMiLCJwaWNfcGF0aCIsImF2YXRhcl9wYXRoIiwiY29udGVudCIsInVybCIsImxhc3RfdXBkYXRlZCIsInVwZGF0ZWRfYXQiLCJzbGljZSIsImRyYXdTZWN0aW9uIiwibWVkaWEiLCJzZWN0aW9uIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiZGV0YWlscyIsImdldEluZm8iLCJwcm92aWRlcnMiLCJhZGRUb1NlY3Rpb24iLCJwYXJ0IiwiYXBwZW5kQ2hpbGQiLCJyZW5kZXJFbGVtZW50IiwidGFnIiwiY2xhc3NOYW1lIiwiY29udGFpbmVyIiwiY2xhc3NMaXN0IiwiYWRkIiwibW92aWVGbmMiLCJ0dkZuYyIsImNvbnNvbGUiLCJsb2ciLCJkcmF3SW50cm8iLCJpbWdTaXplIiwiaW50cm9Db250YWluZXIiLCJ0aXRsZSIsInRleHRDb250ZW50IiwiY3JlYXRlVGl0bGUiLCJ0YWdQYXJhIiwid3JpdGVUYWdsaW5lIiwiaW1nIiwicG9zdGVyIiwiYmFzZUltZ1VybCIsImltZ19wYXRoIiwic3JjIiwiYWx0IiwicmVuZGVySW1nIiwicGFyYSIsIndyaXRlU3VtbWFyeSIsImRyYXdBbGwiLCJkcmF3U3ViSW5mb3MiLCJjcmVhdGVTdWJJbmZvIiwiY2F0ZWdvcnkiLCJpbmZvIiwic3ViSW5mbyIsImNhdGVnb3J5TmFtZSIsImNhdGVnb3J5SW5mbyIsImpvaW4iLCJtaW5zIiwiaG91cnMiLCJySG91cnMiLCJNYXRoIiwiZmxvb3IiLCJtaW51dGVzIiwicm91bmQiLCJjb252ZXJ0TWluVG9IciIsImRyYXdQcm92aWRlcnMiLCJhdmFpbFByb3ZpZGVycyIsInByb3ZpZGVyQ29udGFpbmVyIiwiY291bnRyeUJ0biIsImhvdXNlQ29udGFpbmVyIiwiZWxlbSIsIk9iamVjdCIsImtleXMiLCJpbmNsdWRlcyIsImRyYXdQcm92aWRlciIsImZpcnN0UHJvdmlkZXIiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInByZXZlbnREZWZhdWx0IiwiY3VyckNvdW50cnlOYW1lIiwicHJvdmlkZXJDb3VudHJpZXMiLCJjdXJyQ291bnRyeUNvZGUiLCJjb3VudHJpZXMiLCJtb2RhbENvbnRhaW5lciIsIm1vZGFsSGVhZGVyIiwibW9kYWxCb2R5IiwibW9kYWxDdXJyZW50Q291bnRyeSIsIm1vZGFsSW5wdXRTZWFyY2giLCJtb2RhbExpc3RDb3VudHJpZXMiLCJtb2RhbENsb3NlQnRuIiwicmVuZGVyQ291bnRyeUZsYWciLCJjb3VudHJ5TmFtZSIsImZsYWciLCJzZXRBdHRyaWJ1dGUiLCJmaWx0ZXJSZXN1bHRzIiwiaW5wdXQiLCJ1bCIsImxpIiwiYSIsImkiLCJ0eHRWYWx1ZSIsImdldEVsZW1lbnRCeUlkIiwidmFsdWUiLCJ0b1VwcGVyQ2FzZSIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiaW5uZXJUZXh0IiwiaW5kZXhPZiIsInN0eWxlIiwiZGlzcGxheSIsImhlYWRpbmciLCJjdXJyQ291bnRyeSIsInNlYXJjaExhYmVsIiwic2VhcmNoU3ltYiIsInNlYXJjaEF0dHJpYnV0ZXMiLCJwbGFjZWhvbGRlciIsImN1cnJDb3VudHJ5RmxhZyIsImh0bWxGb3IiLCJmb3JtRWxlbSIsInJlbmRlckhlYWRpbmciLCJjb3VudHJ5Q29udGFpbmVyIiwiY291bnRyeUZsYWciLCJjb3VudHJ5RWxlbSIsInJlbmRlckJvZHkiLCJjbG9zZUZuYyIsImNsb3NlU3ltYiIsInJlbmRlckNsb3NlQnRuIiwicXVlcnlTZWxlY3RvciIsInJlbW92ZSIsIm1vZGFsRWxlbSIsImFwcGVuZCIsInJlbmRlckNvdW50cmllc01vZGFsIiwic3RyZWFtSW5mbyIsImJ1eUluZm8iLCJyZW50SW5mbyIsInNlcnZpY2VOYW1lcyIsImlkeCIsInNlcnZpY2VDb250YWluZXIiLCJzZXJ2aWNlTmFtZSIsInNlcnZpY2VOYW1lQm9sZCIsInByb3ZpZGVyU2VydmljZUNvbnRhaW5lciIsInByb3ZpZGVyIiwicHJvdmlkZXJTZXJ2aWNlIiwicHJvdmlkZXJJbWciLCJwcm92aWRlck5hbWUiLCJkcmF3U2VjdGlvbnMiLCJpZHMiLCJxdWVyeSIsInNwbGl0IiwiaW50ZXJwcmV0VG9RdWVyeSIsInJlc3VsdCIsInNvcnQiLCJwMSIsInAyIiwibWVkaWFfdHlwZSIsImZldGNoSWRzIiwibWFpbiIsInNlY3Rpb25zIiwicmVuZGVyU2VjdGlvbiIsImlubmVySFRNTCIsImFkZFN1Ym1pdFNlYXJjaEZuYyJdLCJzb3VyY2VSb290IjoiIn0=